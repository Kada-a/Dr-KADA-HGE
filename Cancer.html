<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Cancer Difestif</title>
 
<style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f9f9f9;
      color: #333;
    }
    header, footer {
      padding: 15px;
      background-color: #fff;
      border-radius: 5px;
      box-shadow: 0 0 5px rgba(0,0,0,0.1);
      margin-bottom: 20px;
    }
    nav button {
      padding: 10px 15px;
      margin: 5px;
      background-color: #00539C;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    nav button:hover {
      background-color: #003f7f;
    }
    .module {
      display: none;
      padding: 15px;
      background-color: #fff;
      border: 1px solid #c3d8f0;
      border-radius: 5px;
      margin-bottom: 20px;
    }
    .module h2 {
      color: #00539C;
    }
    .result {
      margin-top: 15px;
      padding: 10px;
      background: #eef;
      border-radius: 4px;
    }
    /* Styles pour la connexion/inscription */
    #loginContainer, #registerContainer {
      max-width: 400px;
      margin: 50px auto;
      padding: 20px;
      background: #fff;
      border-radius: 5px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    form > div {
      margin-bottom: 15px;
    }
    label {
      display: block;
      margin-bottom: 5px;
    }
    input[type="email"],
    input[type="password"],
    input[type="number"],
    select,
    textarea {
      width: 100%;
      padding: 8px;
      margin-bottom: 5px;
      border: 1px solid #ccc;
      border-radius: 3px;
      box-sizing: border-box;
    }
    button {
      padding: 10px 15px;
      background: #00539C;
      color: #fff;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #003f7f;
    }
    .hidden { display: none; }
  </style>
   <style>
    .nav-link {
      display: inline-block;
      margin-right: 15px;
    }
  </style>
   <style>
    a {
      margin-right: 20px; /* Ajustez la valeur selon vos besoins */
    }
  </style>
</head>
<body>
  <!-- Splash Page d'introduction
  <div id="splash">
    <div id="splashContent">
      <h2>Disclaimer</h2>
      <p>Les informations présentées sur ce site sont fournies à titre informatif et ne remplacent en aucun cas un avis médical personnalisé.</p>
      <p>En continuant, vous acceptez que ce contenu soit utilisé uniquement à des fins d'information et que vous assumez l'entière responsabilité de son utilisation dans votre pratique.</p>
      <label>
        <input type="checkbox" id="acceptConditions"> J'accepte les conditions d'utilisation
      </label>
      <br>
      <button onclick="acceptDisclaimer()">Continuer</button>
    </div>
  </div>  -->
<script>
    // Fonction pour afficher le module sélectionné et masquer les autres
    function showModule(moduleId) {
      var modules = document.getElementsByClassName('module');
      for (var i = 0; i < modules.length; i++) {
        modules[i].style.display = 'none';
      }
      document.getElementById(moduleId).style.display = 'block';
      window.scrollTo(0, 0);
    }
    
    // Au chargement de la page, afficher par défaut le module "Symptomes"
    window.onload = function() {
      showModule('moduleConsult');
    };
  </script>

  <header>
     
    <footer>	
       <h2>Cancer Digestif</h2>
    </footer>    
 <a href="index.html">Retour à l'accueil</a>  
 <a href="Tube digestif.html">Tube digestif</a> 
 <a href="FoieVoiesBiliaires.html">Foie et Voies Biliaires</a>
 <a href="foiegrossesse.html">Foie et Grossesse</a> 
 <a href="Pancréas.html">Pancréas</a>  
 <a href="UHGE.html">Urgence en HGE</a> 

  </div>
  </header>
  <nav> 
    <button onclick="showModule('moduleGastricLesions')">Lésions Pré-néoplasiques Gastriques</button>
    <button onclick="showModule('modulePolypCharacterization')">Carectérisation des polypes</button>
    <button onclick="showModule('modulePolyp')">surveillance post-polypectomie</button>
    <button onclick="showModule('moduleChimio_Ch')">Chimiothérapie</button>
    <button onclick="showModule('moduleOesophageCarcinome')">Cancer de l'œsophage </button>	
    <button onclick="showModule('moduleEstomac')">Cancer de l'estomac</button>
    <button onclick="showModule('moduleColon')">Cancer du côlon</button>
    <button onclick="showModule('moduleRectum')">Cancer du Rectum</button>	
    <button onclick="showModule('modulePancreas')">Cancer du pancréas</button>
    <button onclick="showModule('moduleCysticPancreas')">Tumeurs kystique du pancréas</button>
    <button onclick="showModule('moduleNeuroendocrinePancreas')">TNE Pancréas</button>
    <button onclick="showModule('moduleGIST')">GIST</button>
    <button onclick="showModule('moduleCHC')">CHC</button>
    <button onclick="showModule('moduleCholangiocarcinomeIntrahep')">Cholangiocarcinome intrahépatique</button>		
    <button onclick="showModule('moduleCholangiocarcinomeExtrahep')">Cholangiocarcinome extrahépatique</button>	
    <button onclick="showModule('moduleDrainageBiliaire')">Drainage Biliaire</button>	
    <button onclick="showModule('moduleLymphomes')">Le lymphome digestif</button>
    <button onclick="showModule('moduleTNE')">TNE</button>
    <button onclick="showModule('moduleAnus')">Cancer de l'anus</button>
    <button onclick="showModule('moduleNutrition')">Nutrition</button>	
	<button onclick="showModule('moduleIMC')">IMC</button>
    <button onclick="showModule('moduleRegime')">Regime</button>
    <button onclick="showModule('moduleConsult')">Résumé clinique</button>

  </nav>
  

<!-- Module: Résumé clinique -->
<div id="moduleConsult" class="module">
  <h3>Compte‑Rendu de Consultation Gastro‑Hépatologie</h3>
  <form id="formConsult">
    
    <!-- Section 1 : Identité et Paramètres Vitaux -->
    <section class="form-section">
      <h3>Données Démographiques</h3>
      <div class="input-group">
        <label>Âge : <input type="number" id="age" min="18" max="120" required></label>
        <label>Sexe : 
          <select id="sexe" required>
            <option value="">--Sélectionner--</option>
            <option value="M">Masculin</option>
            <option value="F">Féminin</option>
          </select>
        </label>
        <label>Poids (kg) : <input type="number" id="poids" step="0.1" required></label>
        <label>Taille (cm) : <input type="number" id="taille" required></label>
      </div>
    </section>

    <!-- Section 2 : Motifs de Consultation -->
    <section class="form-section">
      <h3>Signes Fonctionnels</h3>
      <div class="input-group">
        <label><input type="checkbox" id="douleur"> Douleur abdominale</label>
        <div id="douleurDetails" style="display:none; margin-left:20px;">
          <label>Localisation :
            <select id="localisationDouleur">
              <option value="epigastre">Épigastrique</option>
              <option value="hypocondreD">Hypocondre droit</option>
              <option value="fosseIliaqueD">Fosse iliaque droite</option>
              <option value="diffuse">Diffuse</option>
            </select>
          </label>
          <label>Intensité (EVA 0-10) : <input type="number" id="eva" min="0" max="10"></label>
        </div>
        <label><input type="checkbox" id="dyspepsie"> Dyspepsie</label>
        <label><input type="checkbox" id="reflux"> Reflux gastro‑œsophagien</label>
        <label><input type="checkbox" id="diarrhee"> Diarrhée</label>
        <label><input type="checkbox" id="constipation"> Constipation</label>
        <label><input type="checkbox" id="hematemese"> Hématémèse</label>
        <label><input type="checkbox" id="melena"> Méléna</label>
        <label><input type="checkbox" id="ictere"> Ictère</label>
        <label><input type="checkbox" id="asthenie"> Asthénie</label>
        <label>Autre : <input type="text" id="autresSymptomes"></label>
      </div>
    </section>

    <!-- Section 3 : Examen Clinique -->
    <section class="form-section">
      <h3>Examen Clinique</h3>
      <div class="input-group">
        <label>État général : 
          <select id="etatGeneral">
            <option value="bon">Bon</option>
            <option value="altere">Altéré</option>
            <option value="mauvais">Mauvais</option>
          </select>
        </label>
        
        <h4>Abdomen :</h4>
		<label><input type="checkbox" id="examennormal"> Abdomen souple indolor sans masse palpable</label>
        <label><input type="checkbox" id="douleurPalpation"> Douleur à la palpation</label>
        <label><input type="checkbox" id="defense"> Défense</label>
        <label><input type="checkbox" id="hepatomegalie"> Hépatomégalie</label>
        <label><input type="checkbox" id="splenomegalie"> Splénomégalie</label>
        <label><input type="checkbox" id="ascite"> Ascite</label>
        
        <h4>Signes Cutanéo‑Muqueux :</h4>
        <label><input type="checkbox" id="ictereConj"> Ictère conjonctival</label>
        <label><input type="checkbox" id="angiomes"> Angiomes stellaires</label>
        <label><input type="checkbox" id="erythemePalmaire"> Érythème palmaire</label>
      </div>
    </section>

    <!-- Section 4 : Antécédents -->
    <section class="form-section">
      <h3>Antécédents</h3>
      <div class="input-group">
        <h4>Personnels :</h4>
        <label><input type="checkbox" id="RCH"> RCH</label>
        <label><input type="checkbox" id="MH"> Maladie de Crohn</label>
        <label><input type="checkbox" id="cirrhose"> Cirrhose</label>
        <label><input type="checkbox" id="VHB"> VHB</label>
        <label><input type="checkbox" id="VHC"> VHC</label>
        <label>Chirurgie digestive : <input type="text" id="chirurgie"></label>
        
        <h4>Familiaux :</h4>
        <label><input type="checkbox" id="cancerColoFam"> Cancer colorectal</label>
        <label><input type="checkbox" id="MHfam"> MICI familiale</label>
        <label><input type="checkbox" id="celiaqueFam"> Maladie cœliaque familiale</label>
        
        <h4>Traitements :</h4>
        <label><input type="checkbox" id="AINS"> AINS</label>
        <label><input type="checkbox" id="anticoag"> Anticoagulants</label>
        <label><input type="checkbox" id="IPP"> IPP</label>
        <label>Allergies : <input type="text" id="allergies"></label>
      </div>
    </section>

    <button type="button" onclick="genererCR()">Générer le Compte‑Rendu</button>
  </form>

  <div id="resultConsult" class="result"></div>
</div>

<script>
// Afficher/Masquer la section détaillant la douleur abdominale
document.getElementById("douleur").addEventListener("change", function() {
  document.getElementById("douleurDetails").style.display = this.checked ? "block" : "none";
});

// Fonction d'évaluation de la douleur abdominale
function evaluateDouleurAbdominale() {
  if(document.getElementById("douleur").checked) {
    return "Évaluer la nécessité d'un bilan complémentaire pour douleur persistante.";
  }
  return "Pas de douleur abdominale rapportée.";
}

// Fonction principale pour générer le compte‑rendu
function genererCR() {
  // Récupération des données démographiques
  const age = document.getElementById("age").value;
  const sexe = document.getElementById("sexe").value;
  const poids = document.getElementById("poids").value;
  const taille = document.getElementById("taille").value;
  const imc = (poids / ((taille/100) ** 2)).toFixed(1);
  
  // Signes fonctionnels
  let symptomes = [];
  if(document.getElementById("douleur").checked) {
    let details = "";
    const localisation = document.getElementById("localisationDouleur").value;
    const eva = document.getElementById("eva").value;
    if(localisation) details += "Localisation : " + localisation;
    if(eva) details += (details ? ", Intensité (EVA) : " : "Intensité (EVA) : ") + eva;
    symptomes.push("Douleur abdominale (" + details + ")");
  }
  if(document.getElementById("dyspepsie").checked) symptomes.push("Dyspepsie");
  if(document.getElementById("reflux").checked) symptomes.push("RGO");
  if(document.getElementById("diarrhee").checked) symptomes.push("Diarrhée");
  if(document.getElementById("constipation").checked) symptomes.push("Constipation");
  if(document.getElementById("hematemese").checked) symptomes.push("Hématémèse");
  if(document.getElementById("melena").checked) symptomes.push("Méléna");
  if(document.getElementById("ictere").checked) symptomes.push("Ictère");
  if(document.getElementById("asthenie").checked) symptomes.push("Asthénie");
  const autresSympt = document.getElementById("autresSymptomes").value.trim();
  if(autresSympt) symptomes.push(autresSympt);
  
  // Examen clinique
  const etatGeneral = document.getElementById("etatGeneral").value;
  let examenAbdomen = [];
  if(document.getElementById("examennormal").checked) examenAbdomen.push("souple indolor sans masse palpable");
  if(document.getElementById("douleurPalpation").checked) examenAbdomen.push("Douleur à la palpation");
  if(document.getElementById("defense").checked) examenAbdomen.push("Défense");
  if(document.getElementById("hepatomegalie").checked) examenAbdomen.push("Hépatomégalie");
  if(document.getElementById("splenomegalie").checked) examenAbdomen.push("Splénomégalie");
  if(document.getElementById("ascite").checked) examenAbdomen.push("Ascite");
  
  let examenCutan = [];
  if(document.getElementById("ictereConj").checked) examenCutan.push("Ictère conjonctival");
  if(document.getElementById("angiomes").checked) examenCutan.push("Angiomes stellaires");
  if(document.getElementById("erythemePalmaire").checked) examenCutan.push("Érythème palmaire");
  
  // Antécédents personnels et familiaux
  let antecedentsPerso = [];
  if(document.getElementById("RCH").checked) antecedentsPerso.push("RCH");
  if(document.getElementById("MH").checked) antecedentsPerso.push("Maladie de Crohn");
  if(document.getElementById("cirrhose").checked) antecedentsPerso.push("Cirrhose");
  if(document.getElementById("VHB").checked) antecedentsPerso.push("VHB");
  if(document.getElementById("VHC").checked) antecedentsPerso.push("VHC");
  const chirurgie = document.getElementById("chirurgie").value.trim();
  if(chirurgie) antecedentsPerso.push("Chirurgie digestive: " + chirurgie);
  
  let antecedentsFamiliaux = [];
  if(document.getElementById("cancerColoFam").checked) antecedentsFamiliaux.push("Cancer colorectal");
  if(document.getElementById("MHfam").checked) antecedentsFamiliaux.push("MICI familiale");
  if(document.getElementById("celiaqueFam").checked) antecedentsFamiliaux.push("Maladie cœliaque familiale");
  
  // Traitements
  let traitements = [];
  if(document.getElementById("AINS").checked) traitements.push("AINS");
  if(document.getElementById("anticoag").checked) traitements.push("Anticoagulants");
  if(document.getElementById("IPP").checked) traitements.push("IPP");
  const allergies = document.getElementById("allergies").value.trim();
  if(allergies) traitements.push("Allergies: " + allergies);
  
  // Assemblage du compte‑rendu
  let cr = `<h2>Résumé clinique</h2>`;
  cr += `<p>Patient de ${age} ans, ${sexe}. Poids : ${poids} kg, Taille : ${taille} cm, IMC : ${imc}</p>`;
  
  cr += `<h4>Motif(s) de Consultation :</h4>`;
  cr += `<ul>${symptomes.map(s => `<li>${s}</li>`).join('')}</ul>`;
  
  cr += `<h4>Examen Clinique :</h4>`;
  cr += `<p>État général : ${etatGeneral}</p>`;
  cr += `<p>Abdomen : ${examenAbdomen.length ? examenAbdomen.join(", ") : "Non précisé"}</p>`;
  cr += `<p>Signes cutanéo‑muqueux : ${examenCutan.length ? examenCutan.join(", ") : "Non précisé"}</p>`;
  
  cr += `<h4>Antécédents :</h4>`;
  cr += `<p>Personnels : ${antecedentsPerso.length ? antecedentsPerso.join(", ") : "Aucun"}</p>`;
  cr += `<p>Familiaux : ${antecedentsFamiliaux.length ? antecedentsFamiliaux.join(", ") : "Aucun"}</p>`;
  
  cr += `<h4>Traitements :</h4>`;
  cr += `<p>${traitements.length ? traitements.join(", ") : "Aucun"}</p>`;
  
  cr += `<h4>Conduite à Tenir :</h4>`;
  cr += `<ul>`;
  cr += `<li>Demander bilans complémentaires adaptés (fibroscopie, scanner, etc.)</li>`;
  cr += `<li>Suivi : Rendez‑vous dans 1 mois avec bilan complet</li>`;
  cr += `<li>${evaluateDouleurAbdominale()}</li>`;
  cr += `</ul>`;
  
  // Ordonnance type et conseils
  let ordonnance = `<h4>Ordonnance type et conseils :</h4>`;
  ordonnance += `<ul>`;
  ordonnance += `<li>Paracétamol 500 mg, 1 comprimé 3‑4 fois par jour</li>`;
  ordonnance += `<li>Mébévérine 135 mg, 1 comprimé trois fois par jour</li>`;
  ordonnance += `<li>Conseils hygiéno‑diététiques adaptés (alimentation équilibrée, hydratation, etc.)</li>`;
  ordonnance += `</ul>`;
  
  // Assemblage final du CR
  document.getElementById("resultConsult").innerHTML = cr + ordonnance;
}
</script>

<div id="modulePolypCharacterization" class="module">
  <h2>Caractérisation endoscopique des polypes coliques</h2>
  <form id="formPolyp">
    <!-- Section 1 : Informations de base -->
    <section class="form-section">
      <h3>Informations de base</h3>
      <label for="polyp_localisation">Localisation :</label>
      <select id="polyp_localisation" required>
        <option value="">--Sélectionner--</option>
        <option value="côlon">Côlon</option>
        <option value="rectum">Rectum</option>
      </select>
      <br>
      <label for="polyp_taille">Taille (mm) :</label>
      <input type="number" id="polyp_taille" placeholder="Ex. 8" min="0" required>
      <br>
      <label for="polyp_morphologie">Morphologie (selon Paris) :</label>
      <select id="polyp_morphologie" required>
        <option value="">--Sélectionner--</option>
        <option value="Ip">0-Ip - Pédiculé</option>
        <option value="Is">0-Is - Sessile</option>
        <option value="IIa">0-IIa - Plat surélevé</option>
        <option value="IIc">0-IIc - Déprimé</option>
      </select>
    </section>

    <!-- Section 2 : Classification CONECCT -->
    <section class="form-section">
      <h3>Classification CONECCT</h3>
      <label for="conecct_type">Type de lésion :</label>
      <select id="conecct_type" required>
        <option value="">--Sélectionner--</option>
        <option value="OE">CONECCT OE : Tumeurs neuroendocrines rectales</option>
        <option value="IH">CONECCT IH : Polypes hyperplasiques simples</option>
        <option value="IS">CONECCT IS : Lésions festonnées sessiles</option>
        <option value="IIA">CONECCT IIA : Adénomes simples à bas risque</option>
        <option value="IIC">CONECCT IIC : Adénomes à haut risque / carcinomes superficiels</option>
        <option value="IIC+">CONECCT IIC+ : Lésions borderline</option>
        <option value="III">CONECCT III : Adenocarcinomes profondément invasifs</option>
        <option value="autres">Autres (ex. granulomes inflammatoires…)</option>
      </select>
    </section>

    <!-- Section 3 : Caractérisation endoscopique avancée -->
    <section class="form-section">
      <h3>Caractérisation endoscopique</h3>
      <label for="endo_technique">Technique utilisée :</label>
      <select id="endo_technique" required>
        <option value="">--Sélectionner--</option>
        <option value="chromo">Chromoendoscopie</option>
        <option value="NBI">NBI (Narrow Band Imaging)</option>
        <option value="BLI">BLI (Blue Laser Imaging)</option>
        <option value="virtual">Chromoendoscopie virtuelle</option>
      </select>
      <br>
      <label for="pattern_description">Description du pattern (ex. NICE, Kudo, Sano)
        <p>
          <span style="font-size: 12px;">
            <strong>NICE</strong>: Type I : Lésions hyperplasiques ou non néoplasiques, avec une surface lisse, une couleur similaire à la muqueuse normale et des vaisseaux peu ou pas visibles. Type II : Adénomes ou lésions néoplasiques précoces, présentant une couleur brunâtre ou jaunâtre, des vaisseaux réguliers et un léger changement dans le motif de surface. Type III : Lésions fortement suspectées d’invasion carcinomateuse, avec des modifications vasculaires marquées et une surface irrégulière, traduisant un risque élevé de malignité.
            <strong>Kudo</strong> (Pit pattern classification) : Type I : Pits normaux, arrondis, caractéristiques de la muqueuse saine. Type II : Pits stellés ou papillaires, souvent observés dans les hyperplasies. Type III (a et b) : Pits tubulaires ou en forme d’ellipse, typiques des adénomes. Type IV : Pits complexes ou branchés, associés aux adénomes présentant une hétérogénéité morphologique. Type V : Pits irréguliers ou absents, fortement évocateurs d’un cancer invasif.
            <strong>Sano</strong> : Type I : Réseau capillaire normal, associé aux lésions hyperplasiques. Type II : Réseau capillaire modérément altéré, typique des adénomes, avec des vaisseaux fins et réguliers. Type III : Réseau capillaire irrégulier et dilaté, observé dans les lésions carcinomateuses, notamment celles avec invasion submucosale.
          </span>
        </p>
      </label>
      <input type="text" id="pattern_description" placeholder="Décrivez le pattern observé ">
      <br>
      <!-- Critères de risque -->
      <h4>Critères de risque (à cocher si présents)</h4>
      <label><input type="checkbox" id="crit_nodule"> Présence de nodule mural</label><br>
      <label><input type="checkbox" id="crit_ulceration"> Ulcération ou zone déprimée</label><br>
      <label><input type="checkbox" id="crit_irregular"> Pattern vasculaire ou muqueux irrégulier</label><br>
      <label><input type="checkbox" id="crit_mucus"> Sécrétion abondante de mucus</label><br>
    </section>

    <!-- Section 4 : Stratégie thérapeutique -->
    <section class="form-section">
      <h3>Stratégie thérapeutique</h3>
      <label for="therapeutic_option">Option thérapeutique :</label>
      <select id="therapeutic_option" required>
        <option value="">--Sélectionner--</option>
        <!-- Pour les polypes hyperplasiques simples -->
        <option value="non_reséquer">Ne pas réséquer (si typiquement hyperplasique et < 5 mm)</option>
        <!-- Pour adénomes simples -->
        <option value="resection_froide">Résection à l’anse froide</option>
        <!-- Pour lésions festonnées ou dysplasiques -->
        <option value="mucosectomie_en_bloc">Mucosectomie en bloc</option>
        <option value="mucosectomie_fragmentée">Mucosectomie fragmentée</option>
        <!-- Pour les lésions à haut risque -->
        <option value="dissection_sousmuqueuse">Dissection sous-muqueuse</option>
        <option value="FTRD">Résection avec FTRD</option>
        <option value="dissection_intermusculaire">Dissection intermusculaire (rectum)</option>
        <!-- Option de discussion en réunion multidisciplinaire -->
        <option value="RCP">Discussion en RCP</option>
      </select>
    </section>

    <!-- Section 5 : Observations complémentaires -->
    <section class="form-section">
      <h3>Observations complémentaires</h3>
      <label for="additional_notes">Commentaires :</label><br>
      <textarea id="additional_notes" rows="3" placeholder="Rédigez ici toute information supplémentaire"></textarea>
    </section>

    <button type="button" onclick="generatePolypReport()">Générer le rapport</button>
  </form>

  <div id="resultPolyp" class="result"></div>
</div>

<script>
function generatePolypReport() {
  // Validation des champs requis
  const localisation = document.getElementById("polyp_localisation").value;
  const taille = document.getElementById("polyp_taille").value;
  const morpho = document.getElementById("polyp_morphologie").value;
  const conecctType = document.getElementById("conecct_type").value;
  const endoTechnique = document.getElementById("endo_technique").value;
  const therapeuticOption = document.getElementById("therapeutic_option").value;
  
  if (!localisation || !taille || !morpho || !conecctType || !endoTechnique || !therapeuticOption) {
    alert("Veuillez remplir les champs obligatoires dans toutes les sections.");
    return;
  }

  // Conversion de la taille en nombre
  const polypTaille = parseFloat(taille);

  // Vérification : si la taille est supérieure à 10 mm, la résection à l’anse froide est inadaptée
  if (polypTaille > 10 && therapeuticOption === "resection_froide") {
    alert("Erreur : La stratégie thérapeutique 'résection à l’anse froide' n’est pas adaptée pour une lésion de plus de 10 mm. Veuillez sélectionner une option appropriée (ex. dissection sous-muqueuse ou discussion en RCP).");
    return;
  }
  
  // Définition d'un indicateur pour la présence d'au moins un critère de risque
  const hasRiskCriteria = document.getElementById("crit_nodule").checked ||
                          document.getElementById("crit_ulceration").checked ||
                          document.getElementById("crit_irregular").checked ||
                          document.getElementById("crit_mucus").checked;
  
  // Vérification : si la lésion présente un ou plusieurs critères de risque et/ou une classification CONECCT IIC (ou plus),
  // la seule option thérapeutique acceptable est 'RCP'
  if (((conecctType === "IIC" || conecctType === "IIC+" || conecctType === "III") || hasRiskCriteria) &&
      therapeuticOption !== "RCP") {
    alert("Erreur : Pour une lésion présentant des critères de risque et/ou une classification CONECCT IIC et plus, la stratégie thérapeutique recommandée est la discussion en RCP ou une prise en charge dans un centre expert. Veuillez sélectionner 'RCP'.");
    return;
  }

  // Récupération des informations de base
  let report = "<strong>Rapport de caractérisation endoscopique des polypes coliques</strong><br>";
  report += "<u>Informations de base :</u><br>";
  report += "Localisation : " + localisation + "<br>";
  report += "Taille : " + taille + " mm<br>";
  report += "Morphologie (Paris) : " + morpho + "<br><br>";

  // Classification CONECCT
  report += "<u>Classification CONECCT :</u><br>";
  report += "Type de lésion : " + conecctType + "<br><br>";

  // Caractérisation endoscopique
  report += "<u>Caractérisation endoscopique :</u><br>";
  report += "Technique utilisée : " + endoTechnique + "<br>";
  const pattern = document.getElementById("pattern_description").value;
  if (pattern) {
    report += "Pattern observé : " + pattern + "<br>";
  }
  
  // Critères de risque
  const crits = [];
  if (document.getElementById("crit_nodule").checked) crits.push("Nodule mural");
  if (document.getElementById("crit_ulceration").checked) crits.push("Ulcération / zone déprimée");
  if (document.getElementById("crit_irregular").checked) crits.push("Pattern irrégulier");
  if (document.getElementById("crit_mucus").checked) crits.push("Sécrétion abondante de mucus");
  report += "Critères de risque : " + (crits.length ? crits.join(", ") : "Aucun") + "<br><br>";

  // Stratégie thérapeutique
  report += "<u>Stratégie thérapeutique :</u><br>";
  report += "Option thérapeutique choisie : " + therapeuticOption + "<br><br>";

  // Observations complémentaires
  const notes = document.getElementById("additional_notes").value.trim();
  if (notes) {
    report += "<u>Observations complémentaires :</u><br>" + notes + "<br><br>";
  }

  // Marqueurs et analyses complémentaires
  report += "<u>Marqueurs et analyses complémentaires :</u><br>";
  report += "A utiliser en complément de l'expertise : NBI, BLI, et éventuelle analyse par intelligence artificielle (CONECCT).<br>";

  // Conclusion
  report += "<br><strong>Conclusion :</strong> La lésion est caractérisée selon la classification CONECCT. ";
  report += "La stratégie thérapeutique retenue est adaptée aux critères endoscopiques observés et aux facteurs de risque identifiés.";
  
  document.getElementById("resultPolyp").innerHTML = report;
}

document.addEventListener('DOMContentLoaded', () => {
  // Code pour charger l'état sauvegardé si besoin...
});
</script>



 <!-- Module: Prise en charge des douleurs abdominales chroniques -->
<div id="moduleAbdominalPain" class="module">
  <h2>Prise en charge des douleurs abdominales chroniques</h2>
  <form id="formAbdominalPain">
    
    <!-- Section 1 : Informations du patient -->
    <section class="form-section">
      <h3>Informations du patient</h3>
      <label for="ap_age">Âge :</label>
      <input type="number" id="ap_age" placeholder="Entrez l'âge" min="0" required>
      
      <label for="ap_sexe">Sexe :</label>
      <select id="ap_sexe" required>
        <option value="">--Sélectionner--</option>
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
      </select>
      <div class="error-message" data-error-for="ap_sexe" style="display:none; color:red;">
        Veuillez sélectionner un sexe.
      </div>
    </section>
    
    <!-- Section 2 : Description de la douleur -->
    <section class="form-section">
      <h3>Description de la douleur</h3>
      <label for="ap_duration">Durée de la douleur (en mois) :</label>
      <input type="number" id="ap_duration" placeholder="Ex. 6" min="0">
      <br>
      <label for="ap_nature">Nature et localisation :</label><br>
      <textarea id="ap_nature" rows="3" placeholder="Décrivez la nature, la localisation, l'intensité, l'irradiation, etc."></textarea>
      <br>
      <label for="ap_triggers">Facteurs déclenchants ou soulageants :</label><br>
      <textarea id="ap_triggers" rows="2" placeholder="Lien avec l'alimentation, transit, etc."></textarea>
      <br>
      <label><input type="checkbox" id="ap_weightLoss"> Amaigrissement</label>
      <br>
      <label><input type="checkbox" id="ap_dietChange"> Régimes restrictifs pratiqués</label>
    </section>
    
    <!-- Section 3 : Antécédents chirurgicaux -->
    <section class="form-section">
      <h3>Antécédents chirurgicaux</h3>
      <label><input type="checkbox" id="ap_prevSurgery"> Antécédents de chirurgie abdominale</label><br>
      <label for="ap_surgeryDetails">Détails (type, nombre, impact) :</label><br>
      <textarea id="ap_surgeryDetails" rows="2" placeholder="Décrivez les interventions chirurgicales"></textarea>
    </section>
    
    <!-- Section 4 : Explorations déjà réalisées -->
    <section class="form-section">
      <h3>Explorations déjà réalisées</h3>
      <label for="ap_endoscopy">Endoscopie (gastroscopie/coloscopie) :</label>
      <input type="text" id="ap_endoscopy" placeholder="Résultats, dates, etc.">
      <br>
      <label for="ap_imaging">Imagerie (TDM, IRM) :</label>
      <input type="text" id="ap_imaging" placeholder="Résultats, dates, etc.">
    </section>
    
    <!-- Section 5 : Indices cliniques et facteurs associés -->
    <section class="form-section">
      <h3>Indices cliniques et facteurs associés</h3>
      <label><input type="checkbox" id="ap_postprandial"> Douleur postprandiale (suggérant ischémie mésentérique)</label><br>
      <label><input type="checkbox" id="ap_biliary"> Douleur biliaire/pancréatique récurrente</label><br>
      <label><input type="checkbox" id="ap_allergy"> Douleur associée à une réaction allergique (mastocytose, gastroentérite à éosinophiles)</label><br>
      <label><input type="checkbox" id="ap_dysautonomia"> Signes de dysautonomie (tachycardie posturale, etc.)</label><br>
      <label><input type="checkbox" id="ap_neuropsychiatric"> Symptômes neuro-psychiatriques (anxiété, confusion, hallucinations)</label><br>
      <label><input type="checkbox" id="ap_ascites"> Présence d'ascite ou d'œdèmes</label><br>
      <label><input type="checkbox" id="ap_endometriosis"> Pour les femmes : Suspicion d'endométriose</label><br>
      <label><input type="checkbox" id="ap_narcotic"> Utilisation chronique d'opiacés (Narcotic Bowel Syndrome)</label><br>
      <label><input type="checkbox" id="ap_hyperlaxity"> Antécédents d'hyperlaxité (suspicion de SED/DSH)</label><br>
    </section>
    
    <!-- Section 6 : Examens complémentaires préliminaires -->
    <section class="form-section">
      <h3>Examens complémentaires</h3>
      <label for="ap_cortisol">Cortisol à 8h (µg/dL) :</label>
      <input type="number" id="ap_cortisol" placeholder="Ex. 15" step="any">
      <br>
      <label for="ap_otherExams">Autres examens spécifiques :</label><br>
      <textarea id="ap_otherExams" rows="2" placeholder="Ex. Tests allergiques, sérologie, etc."></textarea>
    </section>
    
    <button type="button" onclick="generatePainPlan()">Générer la conduite à tenir</button>
  </form>
  
  <div id="resultAbPain" class="result"></div>
</div>

<script>
function validateRequiredFieldsPain() {
  let valid = true;
  const ageField = document.getElementById("ap_age");
  const sexeField = document.getElementById("ap_sexe");
  const errorSexe = document.querySelector('[data-error-for="ap_sexe"]');

  if (!ageField.value) {
    ageField.classList.add("invalid");
    valid = false;
  } else {
    ageField.classList.remove("invalid");
  }
  if (!sexeField.value) {
    if (errorSexe) errorSexe.style.display = "block";
    sexeField.classList.add("invalid");
    valid = false;
  } else {
    if (errorSexe) errorSexe.style.display = "none";
    sexeField.classList.remove("invalid");
  }
  return valid;
}

function generatePainPlan() {
  if (!validateRequiredFieldsPain()) {
    return;
  }
  
  // Informations patient
  const age = document.getElementById("ap_age").value;
  const sexe = document.getElementById("ap_sexe").value;
  
  // Description de la douleur
  const duration = document.getElementById("ap_duration").value || "Non renseignée";
  const nature = document.getElementById("ap_nature").value.trim() || "Non renseignée";
  const triggers = document.getElementById("ap_triggers").value.trim() || "Non renseigné";
  const weightLoss = document.getElementById("ap_weightLoss").checked ? "Amaigrissement présent" : "";
  const dietChange = document.getElementById("ap_dietChange").checked ? "Régimes restrictifs pratiqués" : "";
  
  // Antécédents chirurgicaux
  const prevSurgery = document.getElementById("ap_prevSurgery").checked ? "Antécédents de chirurgie abdominale" : "Aucun antécédent chirurgical";
  const surgeryDetails = document.getElementById("ap_surgeryDetails").value.trim();
  
  // Explorations déjà réalisées
  const endoscopy = document.getElementById("ap_endoscopy").value.trim() || "Non renseigné";
  const imaging = document.getElementById("ap_imaging").value.trim() || "Non renseigné";
  
  // Facteurs cliniques
  const clinicalFactors = [];
  if(document.getElementById("ap_postprandial").checked) clinicalFactors.push("Douleur postprandiale (ischémie mésentérique)");
  if(document.getElementById("ap_biliary").checked) clinicalFactors.push("Douleur biliaire/pancréatique");
  if(document.getElementById("ap_allergy").checked) clinicalFactors.push("Symptômes allergiques/mastocytose");
  if(document.getElementById("ap_dysautonomia").checked) clinicalFactors.push("Dysautonomie (STOP/POTS)");
  if(document.getElementById("ap_neuropsychiatric").checked) clinicalFactors.push("Symptômes neuro-psychiatriques");
  if(document.getElementById("ap_ascites").checked) clinicalFactors.push("Ascite/œdèmes");
  if(document.getElementById("ap_endometriosis").checked) clinicalFactors.push("Suspicion d'endométriose");
  if(document.getElementById("ap_narcotic").checked) clinicalFactors.push("Utilisation chronique d'opiacés (Narcotic Bowel Syndrome)");
  if(document.getElementById("ap_hyperlaxity").checked) clinicalFactors.push("Antécédents d'hyperlaxité (SED/DSH)");
  
  // Examens complémentaires préliminaires
  const cortisol = document.getElementById("ap_cortisol").value || "Non renseigné";
  const otherExams = document.getElementById("ap_otherExams").value.trim() || "Aucun";
  
  // Construction du rapport
  let report = "<strong>Résumé des douleurs abdominales chroniques</strong><br>";
  report += "Patient de " + age + " ans, " + sexe + ".<br>";
  report += "Durée de la douleur : " + duration + " mois<br>";
  report += "Description : " + nature + "<br>";
  report += "Facteurs déclenchants/soulageants : " + triggers + "<br>";
  if(weightLoss || dietChange) {
    report += "Observations : " + [weightLoss, dietChange].filter(Boolean).join(" ; ") + "<br>";
  }
  report += "Antécédents chirurgicaux : " + prevSurgery;
  if(surgeryDetails) report += " (" + surgeryDetails + ")";
  report += "<br>";
  report += "Explorations déjà réalisées : Endoscopie – " + endoscopy + " ; Imagerie – " + imaging + "<br><br>";
  
  report += "<strong>Indices cliniques :</strong> " + (clinicalFactors.length ? clinicalFactors.join(", ") : "Aucun") + "<br><br>";
  
  report += "<strong>Examens complémentaires :</strong><br>";
  report += "Dosage du cortisol à 8h : " + cortisol + " µg/dL<br>";
  report += "Autres examens spécifiques : " + otherExams + "<br><br>";
  
  // Proposition de prise en charge
  let planText = "<strong>Proposition de prise en charge :</strong><br>";
  if(document.getElementById("ap_postprandial").checked) {
    planText += "• Indication de bilan vasculaire pour suspicion d'ischémie mésentérique (TDM/angiographie).<br>";
  }
  if(document.getElementById("ap_biliary").checked) {
    planText += "• Indication de bilan imagerie du pancréas et du système biliaire (TDM/IRM).<br>";
  }
  if(document.getElementById("ap_allergy").checked) {
    planText += "• Indication de bilan allergique et biopsies ciblées pour recherche de gastroentérite à éosinophiles ou mastocytose.<br>";
  }
  if(document.getElementById("ap_dysautonomia").checked) {
    planText += "• Indication d'évaluation orthostatique et bilan de dysautonomie.<br>";
  }
  if(document.getElementById("ap_neuropsychiatric").checked) {
    planText += "• Indication d'un bilan neurologique pour explorer une éventuelle porphyrie aiguë intermittente.<br>";
  }
  if(document.getElementById("ap_ascites").checked) {
    planText += "• Indication d'une échographie abdominale pour évaluation de l'ascite et recherche d'un œdème angioneurotique.<br>";
  }
  if(document.getElementById("ap_endometriosis").checked) {
    planText += "• Indication d'un bilan gynécologique et IRM pelvienne pour suspicion d'endométriose.<br>";
  }
  if(document.getElementById("ap_narcotic").checked) {
    planText += "• Indication d'une évaluation du narcotic bowel syndrome (révision de la prise d'opiacés).<br>";
  }
  if(document.getElementById("ap_hyperlaxity").checked) {
    planText += "• Indication d'un bilan spécialisé en syndrome d'Ehlers-Danlos/Désordre du spectre de l'hypermobilité.<br>";
  }
  if(cortisol === "Non renseigné" || cortisol === "") {
    planText += "• Indication de dosage du cortisol à 8h pour exclure une insuffisance surrénalienne.<br>";
  }
  if(planText === "<strong>Proposition de prise en charge :</strong><br>") {
    planText += "• Indication de bilan complémentaire standard (réévaluation clinique et surveillance).<br>";
  }
  
  report += planText;
  
  document.getElementById("resultAbPain").innerHTML = report;
}
</script>
</div>
<!-- Module: Reconnaissance et Suivi des Lésions Pré-néoplasiques Gastriques -->
<div id="moduleGastricLesions" class="module">
  <h3>Reconnaissance et Suivi des Lésions Pré-néoplasiques Gastriques</h3>
  <form id="formGastricLesions">
    
    <!-- Section 1 : Caractéristiques Endoscopiques -->
    <section class="form-section">
      <h3>Caractéristiques Endoscopiques</h3>
      <label for="lesion_type">Type de Lésion :</label>
      <select id="lesion_type"> 
        <option value="">--Sélectionner--</option>	
         <option value="atrophie">Atrophie glandulaire</option>
         <option value="metaplasie">Métaplasie intestinale</option>
         <option value="dysplasie">Dysplasie</option>
         <option value="autre">Autre</option>
      </select>
      
      <label for="lesion_location">Localisation :</label>
      <select id="lesion_location">
        <option value="">--Sélectionner--</option>
         <option value="antre">Antre</option>
         <option value="angulus">Angulus</option>
         <option value="corps">Corps</option>
         <option value="fundus">Fundus</option>
      </select>
      
      <label for="imaging">Technique d'Imagerie :</label>
      <select id="imaging">
        <option value="">--Sélectionner--</option>	
         <option value="blanche">Lumière blanche</option>
         <option value="NBI">NBI (Narrow Band Imaging)</option>
         <option value="BLI">BLI (Blue Light Imaging)</option>
      </select>
    </section>
    
    <!-- Section 2 : Évaluation Histologique -->
    <section class="form-section">
      <h3>Évaluation Histologique</h3>
      <label for="olga">Classification OLGA (Atrophie) :</label>
      <select id="olga">
        <option value="">--Sélectionner--</option>
         <option value="0">OLGA 0: Aucune atrophie ou atrophie très légère.</option>
         <option value="I">OLGA I: Atrophie légère, localisée dans une partie de l'estomac.</option>
         <option value="II">OLGA II: Atrophie modérée, avec une atteinte plus étendue.</option>
         <option value="III">OLGA III : Atrophie sévère dans plusieurs zones de l'estomac.</option>
         <option value="IV">OLGA IV: Atrophie sévère, généralisée sur tout l'estomac.</option>
      </select>
      
      <label for="olgim">Classification OLGIM(Oesophagogastric Intestinal Metaplasia) :</label>
      <select id="olgim">
        <option value="">--Sélectionner--</option>
         <option value="0">OLGIM 0: Pas de métaplasie intestinale.</option>
         <option value="I">OLGIM I: Métaplasie intestinale de bas grade, localisée.</option>
         <option value="II">OLGIM II: Métaplasie intestinale de haut grade, localisée.</option>
         <option value="III">OLGIM III: Métaplasie intestinale de haut grade, étendue à plusieurs zones de l'estomac.</option>
         <option value="IV">OLGIM IV : Métaplasie intestinale étendue et sévère affectant l'ensemble de l'estomac.</option>
      </select>
    </section>
    
    <!-- Section 3 : Statut H. pylori -->
    <section class="form-section">
      <h3>H. pylori</h3>
      <label for="hpylori">Test H. pylori :</label>
      <select id="hpylori">
        <option value="">--Sélectionner--</option>
         <option value="positif">Positif</option>
         <option value="negatif">Négatif</option>
      </select>
      <label>
        <input type="checkbox" id="hpylori_eradicated">
        H. pylori éradiqué
      </label>
    </section>
    
    <!-- Section 4 : Protocole de Biopsie -->
    <section class="form-section">
      <h3>Protocole de Biopsie</h3>
      <label for="biopsies">Nombre de biopsies réalisées :</label>
      <input type="number" id="biopsies" placeholder="Ex: 7" min="1">
      <label>
        <input type="checkbox" id="systematic_mapping">
        Cartographie biopsique systématique réalisée
      </label>
    </section>
    
    <button type="button" onclick="calculateGastricLesions()">Générer la Conduite à Tenir</button>
  </form>
  
  <div id="resultGastricLesions" class="result"></div>
  
  <script>
    function calculateGastricLesions() {
      // Récupération des valeurs du formulaire
      var lesionType = document.getElementById("lesion_type").value;
      var lesionLocation = document.getElementById("lesion_location").value;
      var imaging = document.getElementById("imaging").value;
      var olga = document.getElementById("olga").value;
      var olgim = document.getElementById("olgim").value;
      var hpylori = document.getElementById("hpylori").value;
      var hpEradicated = document.getElementById("hpylori_eradicated").checked;
      var biopsies = parseInt(document.getElementById("biopsies").value) || 0;
      var systematicMapping = document.getElementById("systematic_mapping").checked;
      
      // Construction du résumé de l'évaluation
      var summary = "<strong>Résumé de l'évaluation :</strong><br>";
      summary += "Type de lésion : " + lesionType + "<br>";
      summary += "Localisation : " + lesionLocation + "<br>";
      summary += "Technique d'imagerie utilisée : " + imaging + "<br>";
      summary += "Classification OLGA : " + olga + "<br>";
      summary += "Classification OLGIM : " + olgim + "<br>";
      summary += "H. pylori : " + hpylori + (hpylori === "positif" && !hpEradicated ? " (non éradiqué)" : (hpylori === "positif" && hpEradicated ? " (éradiqué)" : "")) + "<br>";
      summary += "Nombre de biopsies réalisées : " + biopsies + "<br>";
      summary += "Cartographie biopsique : " + (systematicMapping ? "Oui" : "Non") + "<br><br>";
      
      // Élaboration de la conduite à tenir
      var plan = "<strong>Recommandations :</strong><br>";
      
      // Gestion de H. pylori
      if (hpylori === "positif" && !hpEradicated) {
        plan += "• Éradication impérative de H. pylori, suivie d'un contrôle endoscopique à 6-12 mois.<br>";
      } else if (hpylori === "positif" && hpEradicated) {
        plan += "• H. pylori éradiqué : poursuivre la surveillance.<br>";
      } else {
        plan += "• H. pylori négatif.<br>";
      }
      
      // Gestion selon le type de lésion
      if (lesionType === "atrophie") {
        plan += "• Atrophie glandulaire détectée. Utiliser la classification OLGA pour évaluer le risque.<br>";
        if (olga === "III" || olga === "IV") {
          plan += "  - Risque élevé : surveillance endoscopique rapprochée (annuelle ou semi-annuelle).<br>";
        } else {
          plan += "  - Risque faible à modéré : surveillance moins fréquente (tous les 3-5 ans).<br>";
        }
      } else if (lesionType === "metaplasie") {
        plan += "• Métaplasie intestinale identifiée. Utiliser la classification OLGIM pour stratifier le risque.<br>";
        if (olgim === "III" || olgim === "IV") {
          plan += "  - Risque élevé : surveillance endoscopique rapprochée (par exemple tous les 3 ans).<br>";
        } else {
          plan += "  - Risque faible à modéré : surveillance moins fréquente (tous les 5 ans).<br>";
        }
      } else if (lesionType === "dysplasie") {
        plan += "• Dysplasie détectée : prise en charge immédiate (résection endoscopique et suivi multidisciplinaire).<br>";
      } else {
        plan += "• Lésion pré-néoplasique non classifiée : adapter la prise en charge au contexte clinique.<br>";
      }
      
      // Remarques sur la technique d'imagerie
      if (imaging === "blanche") {
        plan += "• La lumière blanche conventionnelle présente une sensibilité limitée pour détecter ces lésions.<br>";
      } else {
        plan += "• La technologie " + imaging + " améliore la détection et la caractérisation des lésions.<br>";
      }
      
      // Évaluation du protocole de biopsie
      if (biopsies < 7) {
        plan += "• Nombre de biopsies insuffisant pour une stadification fiable. Un protocole d'au moins 7 biopsies est recommandé.<br>";
      } else if (!systematicMapping) {
        plan += "• L'absence de cartographie biopsique systématique peut limiter la détection des lésions multifocales. Sa réalisation est souhaitable.<br>";
      } else {
        plan += "• Protocole de biopsie satisfaisant.<br>";
      }
      
      plan += "• Une surveillance endoscopique et histologique régulière est essentielle pour interrompre la progression vers un cancer gastrique.<br>";
      
      document.getElementById("resultGastricLesions").innerHTML = summary + plan;
    }
  </script>
</div>

<!-- Module: Calculateur d'intervalles de surveillance post-polypectomie -->
<div id="modulePolyp" class="module">
  <h1>Calculateur d'intervalles de surveillance post-polypectomie</h1>

  <!-- Section Qualité de la coloscopie initiale -->
  <div class="section">
    <h2>Qualité de la coloscopie initiale</h2>
    <select id="polypQualite">
      <option value="adequate">Préparation adéquate et examen complet</option>
      <option value="inadequate">Préparation inadéquate ou examen incomplet</option>
    </select>
  </div>

  <!-- Section Facteurs de risque -->
  <div class="section">
    <h2>Facteurs de risque</h2>
    <div>
      <h3>Risque élevé</h3>
      <label>
        <input type="checkbox" class="polyp-high-risk" value="5adenomes">
        ≥5 adénomes
      </label>
      <label>
        <input type="checkbox" class="polyp-high-risk" value="adenome10mm">
        Adénome ≥10 mm
      </label>
      <label>
        <input type="checkbox" class="polyp-high-risk" value="dysplasieHaut">
        Dysplasie de haut grade
      </label>
      <label>
        <input type="checkbox" class="polyp-high-risk" value="polypeFestonne10mm">
        Polype festonné ≥10 mm
      </label>
    </div>
    <div>
      <h3>Risque faible</h3>
      <label>
        <input type="checkbox" class="polyp-low-risk" value="moins5adenomes">
        <5 adénomes <10 mm (DBG)
      </label>
      <label>
        <input type="checkbox" class="polyp-low-risk" value="polypeFestonneMoins10">
        Polype festonné <10 mm sans dysplasie
      </label>
    </div>
  </div>

  <!-- Section Situations particulières -->
  <div class="section">
    <h2>Situations particulières</h2>
    <label>
      <input type="checkbox" id="polypFragmente">
      Exérèse fragmentée (≥20 mm)
    </label>
    <label>
      <input type="checkbox" id="polypCancer">
      Cancer colorectal traité
    </label>
    <label>
      <input type="checkbox" id="polypAge">
      Sujet âgé
    </label>
    <label>
      <input type="checkbox" id="polypFamille">
      Antécédents familiaux
    </label>
  </div>

  <!-- Bouton de calcul -->
  <button type="button" onclick="calculatePolypInterval()">Calculer l'intervalle</button>

  <!-- Résultats -->
  <div class="result" id="polypResult">
    <h3>Recommandation de surveillance :</h3>
    <p id="polypInterval"></p>
    <p id="polypNotes"></p>
  </div>

  <script>
    function calculatePolypInterval() {
      // Initialisation des variables de résultat
      let interval = "";
      let notes = [];

      // Vérification de la qualité de la coloscopie initiale
      var qualite = document.getElementById('polypQualite').value;
      if (qualite === 'inadequate') {
        interval = "1 an";
        notes.push("Coloscopie initiale inadéquate - Répéter la coloscopie");
      } else {
        // Vérification des situations particulières
        if (document.getElementById('polypFragmente').checked) {
          interval = "3-6 mois";
          notes.push("Surveillance rapprochée pour exérèse fragmentée");
        }
        else if (document.getElementById('polypCancer').checked) {
          interval = "1 an";
          notes.push("Surveillance post-cancer : puis à 3 ans et 5 ans");
        }
        // Calcul en fonction du risque (élevé ou faible)
        else {
          const highRiskCount = document.querySelectorAll('.polyp-high-risk:checked').length;
          const lowRiskCount = document.querySelectorAll('.polyp-low-risk:checked').length;

          if (highRiskCount > 0) {
            interval = "3 ans";
            notes.push("Surveillance rapprochée (puis 5 ans si contrôle normal)");
          }
          else if (lowRiskCount > 0) {
            interval = "5 ans";
            notes.push("Possibilité d'espacer ultérieurement (7-10 ans) ou utiliser un test FIT bisannuel");
          }
        }
      }

      // Gestion des cas particuliers (âge, antécédents familiaux)
      if (document.getElementById('polypAge').checked) {
        notes.push("Arrêt possible de la surveillance selon espérance de vie");
      }
      if (document.getElementById('polypFamille').checked) {
        notes.push("Antécédents familiaux à prendre en compte dans la décision");
      }

      // Affichage des résultats
      document.getElementById('polypInterval').textContent = interval || "Aucune surveillance spécifique nécessaire";
      document.getElementById('polypNotes').textContent = notes.join(" • ");
    }
  </script>
</div>

<div id="moduleChimio_Ch" class="module">
  <h3>Protocoles de Chimiothérapie en Oncologie Digestive</h3>

  <!-- Sélections -->
  <div class="selection-grid">
    <div class="input-group">
      <label for="cancerType_Ch">Type de cancer :</label>
      <select id="cancerType_Ch" required>
        <option value="">-- Choisir --</option>
        <option value="oesophage">Œsophage</option>
        <option value="estomac">Estomac</option>
        <option value="foie">Foie (CHC)</option>
        <option value="pancreas">Pancréas</option>
        <option value="colon">Colorectal</option>
        <option value="lymphome">Lymphome digestif</option>
        <option value="gist">GIST</option>
      </select>
    </div>

    <div class="input-group">
      <label for="situation_Ch">Situation :</label>
      <select id="situation_Ch" required>
        <option value="localise">Localisé</option>
        <option value="avance">Localement avancé</option>
        <option value="metastatique">Métastatique</option>
      </select>
    </div>
  </div>

  <!-- Bouton de génération -->
  <button type="button" class="recommend-btn" onclick="generateProtocol_Ch()">Générer les protocoles</button>

  <!-- Zone d'affichage des résultats -->
  <div id="resultats_Ch" class="protocols-container"></div>

  <script>
    // Définition des protocoles complets
    const protocols_Ch = {
      oesophage: {
        localise: [{
          nom: "CROSS",
          indication: "Néoadjuvant",
          medicaments: [
            { nom: "Carboplatine", dose: "AUC 2", voie: "IV", jour: "J1,8,15,22,29" },
            { nom: "Paclitaxel", dose: "50 mg/m²", voie: "IV", jour: "J1,8,15,22,29" }
          ],
          cycle: "Semaine x5 avec radiothérapie",
          effets_secondaires: ["Neutropénie", "Neuropathie"]
        }],
        avance: [{
          nom: "DCF",
          indication: "1ère ligne",
          medicaments: [
            { nom: "Docétaxel", dose: "75 mg/m²", voie: "IV", jour: "J1" },
            { nom: "Cisplatine", dose: "75 mg/m²", voie: "IV", jour: "J1" },
            { nom: "5-FU", dose: "750 mg/m²/j", voie: "IVSE", jour: "J1-5" }
          ],
          cycle: "21 jours",
          premédication: "Hydratation + antiémétiques"
        }],
        metastatique: [{
          nom: "Pembrolizumab",
          indication: "PD-L1 CPS ≥10",
          dose: "200 mg",
          cycle: "Toutes les 3 semaines",
          surveillance: "Évaluation immunologique"
        }]
      },
      estomac: {
        localise: [],
        avance: [],
        metastatique: [{
          nom: "FLOT",
          indication: "1ère ligne adénocarcinome",
          medicaments: [
            { nom: "Docétaxel", dose: "50 mg/m²", voie: "IV", jour: "J1" },
            { nom: "Oxaliplatine", dose: "85 mg/m²", voie: "IV", jour: "J1" },
            { nom: "Leucovorine", dose: "200 mg/m²", voie: "IV", jour: "J1" },
            { nom: "5-FU", dose: "2600 mg/m²", voie: "Perf. continue", jour: "J1-48h" }
          ],
          cycle: "14 jours",
          premédication: "Dexaméthasone 8mg 12h et 1h avant",
          effets_secondaires: [
            "Neutropénie grade 3-4 (35%)",
            "Neuropathie périphérique",
            "Syndrome main-pied"
          ]
        }]
      },
      foie: {
        localise: [{
          nom: "TACE",
          indication: "CHC non résécable",
          medicaments: [
            { nom: "Doxorubicine", dose: "50 mg", voie: "Intra-artérielle", jour: "J1" }
          ],
          cycle: "À répéter selon réponse"
        }],
        avance: [],
        metastatique: [{
          nom: "Sorafenib",
          indication: "1ère ligne CHC avancé",
          dose: "400 mg x2/j",
          surveillance: "Surveillance tensionnelle"
        }]
      },
      pancreas: {
        localise: [],
        avance: [{
          nom: "FOLFIRINOX",
          indication: "Résécable limite",
          medicaments: [
            { nom: "Irinotécan", dose: "180 mg/m²", voie: "IV", jour: "J1" },
            { nom: "Oxaliplatine", dose: "85 mg/m²", voie: "IV", jour: "J1" },
            { nom: "5-FU", dose: "400 mg/m² bolus", voie: "IV", jour: "J1" },
            { nom: "5-FU", dose: "2400 mg/m²", voie: "Perf. continue", jour: "J1-46h" }
          ],
          cycle: "14 jours",
          premédication: "Atropine si syndrome cholinergique"
        }],
        metastatique: [{
          nom: "Gemcitabine + Nab-paclitaxel",
          medicaments: [
            { nom: "Gemcitabine", dose: "1000 mg/m²", voie: "IV", jour: "J1,8,15" },
            { nom: "Nab-paclitaxel", dose: "125 mg/m²", voie: "IV", jour: "J1,8,15" }
          ],
          cycle: "28 jours"
        }]
      },
      colon: {
        localise: [{
          nom: "FOLFOX4",
          indication: "Adjuvant stade III",
          medicaments: [
            { nom: "Oxaliplatine", dose: "85 mg/m²", voie: "IV", jour: "J1" },
            { nom: "5-FU", dose: "2400 mg/m²", voie: "Perf. continue", jour: "J1-46h" }
          ],
          cycle: "14 jours x 12 cycles",
          surveillance: "NFS hebdomadaire"
        }],
        avance: [],
        metastatique: [{
          nom: "FOLFIRI + Bévasizumab",
          medicaments: [
            { nom: "Irinotécan", dose: "180 mg/m²", voie: "IV", jour: "J1" },
            { nom: "5-FU", dose: "2400 mg/m²", voie: "Perf. continue", jour: "J1-46h" },
            { nom: "Bévasizumab", dose: "5 mg/kg", voie: "IV", jour: "J1" }
          ],
          cycle: "14 jours"
        }]
      },
      lymphome: {
        localise: [{
          nom: "R-CHOP",
          indication: "Lymphome B diffus",
          medicaments: [
            { nom: "Rituximab", dose: "375 mg/m²", voie: "IV", jour: "J1" },
            { nom: "Cyclophosphamide", dose: "750 mg/m²", voie: "IV", jour: "J1" },
            { nom: "Doxorubicine", dose: "50 mg/m²", voie: "IV", jour: "J1" },
            { nom: "Vincristine", dose: "1.4 mg/m²", voie: "IV", jour: "J1" },
            { nom: "Prednisone", dose: "100 mg/j", voie: "PO", jour: "J1-5" }
          ],
          cycle: "21 jours"
        }],
        avance: [],
        metastatique: []
      },
      gist: {
        localise: [],
        avance: [],
        metastatique: [{
          nom: "Imatinib",
          indication: "1ère ligne",
          dose: "400 mg/j",
          surveillance: [
            "NFS hebdomadaire puis mensuelle",
            "ECG initial",
            "Bilan hépatique régulier"
          ]
        }]
      }
    };

    // Fonction génération protocoles
    function generateProtocol_Ch() {
      const cancer = document.getElementById('cancerType_Ch').value;
      const situation = document.getElementById('situation_Ch').value;
      const container = document.getElementById('resultats_Ch');
      
      if (!cancer) {
        alert("Veuillez sélectionner un type de cancer");
        return;
      }
      
      const protocoles = protocols_Ch[cancer]?.[situation] || [];
      let html = `<h3>Protocoles pour ${document.getElementById('cancerType_Ch').options[document.getElementById('cancerType_Ch').selectedIndex].text} (${document.getElementById('situation_Ch').options[document.getElementById('situation_Ch').selectedIndex].text})</h3>`;
      
      if (protocoles.length === 0) {
        container.innerHTML = html + "<p>Aucun protocole standard pour cette situation clinique.</p>";
        return;
      }
      
      html += protocoles.map(p => `
        <div class="protocol-card">
          <h4>${p.nom}</h4>
          <div class="indication">${p.indication}</div>
          ${p.medicaments?.length ? `
            <table>
              <tr><th>Médicament</th><th>Dose</th><th>Voie</th><th>Jour</th></tr>
              ${p.medicaments.map(m => `
                <tr>
                  <td>${m.nom}</td>
                  <td>${m.dose}</td>
                  <td>${m.voie}</td>
                  <td>${m.jour}</td>
                </tr>
              `).join('')}
            </table>` : ''}
          ${p.dose ? `<div class="dose">Dose : ${p.dose}</div>` : ''}
          ${p.cycle ? `<div class="cycle">Cycle : ${p.cycle}</div>` : ''}
          ${p.premédication ? `<div class="premed">Prémédication : ${p.premédication}</div>` : ''}
          ${p.effets_secondaires?.length ? `
            <div class="effets">
              <h5>Effets secondaires fréquents :</h5>
              <ul>${p.effets_secondaires.map(e => `<li>${e}</li>`).join('')}</ul>
            </div>` : ''}
          ${p.surveillance ? `
            <div class="surveillance">
              <h5>Surveillance :</h5>
              ${Array.isArray(p.surveillance) ? `
                <ul>${p.surveillance.map(s => `<li>${s}</li>`).join('')}</ul>
              ` : `<p>${p.surveillance}</p>`}
            </div>` : ''}
        </div>
      `).join('');
      
      container.innerHTML = html;
    }
  </script>
  
  <style>
    .module {
      font-family: 'Segoe UI', sans-serif;
      max-width: 1000px;
      margin: 20px auto;
      padding: 25px;
      background: #f8f9fa;
      border-radius: 12px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    .selection-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
      margin-bottom: 25px;
    }
    .input-group select {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      margin-top: 5px;
    }
    .recommend-btn {
      background: #2c3e50;
      color: white;
      padding: 12px 30px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
      margin: 15px 0;
    }
    .recommend-btn:hover {
      background: #34495e;
    }
    .protocol-card {
      background: white;
      border: 1px solid #e0e0e0;
      padding: 20px;
      margin-bottom: 20px;
      border-radius: 8px;
    }
    .protocol-card h4 {
      color: #2980b9;
      margin: 0 0 10px 0;
      font-size: 1.4em;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
    }
    th, td {
      padding: 12px;
      border: 1px solid #ddd;
      text-align: left;
    }
    th {
      background-color: #f4f6f6;
    }
    .effets {
      background: #fdebd0;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
    }
    .surveillance {
      background: #d5f5e3;
      padding: 15px;
      border-radius: 6px;
      margin: 15px 0;
    }
    .premed {
      color: #16a085;
      padding: 10px;
      background-color: #e8f6f3;
      border-radius: 4px;
      margin: 10px 0;
    }
  </style>
</div>

<!-- Module: Cancer colon – Mise à jour -->
<div id="moduleColon" class="module">
  <h3>Cancer du côlon</h3>
  <form id="formColon">
    <!-- Section 1 : Caractéristiques tumorales -->
    <section class="form-section">
      <h2>Caractéristiques Tumorales</h2>
      <div class="input-group">
        <label for="localisation">Localisation :</label>
        <select id="localisation" required>
          <option value="">--Sélectionner--</option>
          <option value="caecum">Caecum</option>
          <option value="ascendant">Côlon ascendant</option>
          <option value="transverse">Côlon transverse</option>
          <option value="descendant">Côlon descendant</option>
          <option value="sigmoide">Sigmoïde</option>
          <option value="rectosigmoide">Rectosigmoïde</option>
        </select>
      </div>

      <div class="input-group">
        <label>Type histologique (WHO 2022) :</label>
        <select id="histo_type" required>
          <option value="">--Sélectionner--</option>
          <option value="adeno">Adénocarcinome</option>
          <option value="mucineux">Adénocarcinome mucineux</option>
          <option value="annulaire">Tumeur annulaire</option>
          <option value="neuroendocrine">Tumeur neuroendocrine</option>
        </select>
      </div>

      <div class="input-group">
        <label>Différenciation :</label>
        <select id="differentiation" required>
          <option value="">--Sélectionner--</option>
          <option value="bien">Bien différencié</option>
          <option value="modere">Modérément différencié</option>
          <option value="peu">Peu différencié</option>
        </select>
      </div>
    </section>

    <!-- Section 2 : Stadification -->
    <section class="form-section">
      <h2>Stadification (TNM AJCC 8<sup>ème</sup> édition)</h2>
      <div class="input-group">
        <label for="T_colon">T :</label>
        <select id="T_colon" required>
          <option value="">--Sélectionner--</option>
          <option value="Tis">Tis</option>
          <option value="T1">T1</option>
          <option value="T2">T2</option>
          <option value="T3">T3</option>
          <option value="T4a">T4a</option>
          <option value="T4b">T4b</option>
        </select>
      </div>

      <div class="input-group">
        <label for="N_colon">N :</label>
        <select id="N_colon" required>
          <option value="">--Sélectionner--</option>
          <option value="N0">N0</option>
          <option value="N1a">N1a</option>
          <option value="N1b">N1b</option>
          <option value="N2a">N2a</option>
          <option value="N2b">N2b</option>
        </select>
      </div>

      <div class="input-group">
        <label for="M_colon">M :</label>
        <select id="M_colon" required>
          <option value="">--Sélectionner--</option>
          <option value="M0">M0</option>
          <option value="M1a">M1a</option>
          <option value="M1b">M1b</option>
          <option value="M1c">M1c</option>
        </select>
      </div>

      <div class="input-group">
        <label>Facteurs pronostiques :</label>
        <div class="checkbox-group">
          <label><input type="checkbox" name="pronostic_colon" value="emboles"> Emboles vasculaires</label>
          <label><input type="checkbox" name="pronostic_colon" value="perineural"> Envahissement périnerveux</label>
          <label><input type="checkbox" name="pronostic_colon" value="mm"> Marges mésocoliques</label>
        </div>
      </div>
    </section>

    <!-- Section 3 : Biologie moléculaire -->
    <section class="form-section">
      <h2>Biologie Moléculaire</h2>
      <div class="input-group">
        <label>Statut MSI/MMR :</label>
        <select id="MSI">
          <option value="">--Sélectionner--</option>
          <option value="MSS">MSS/pMMR</option>
          <option value="MSI-L">MSI-L</option>
          <option value="MSI-H">MSI-H/dMMR</option>
        </select>
      </div>

      <div class="input-group">
        <label>Mutations :</label>
        <div class="checkbox-group">
          <label><input type="checkbox" name="mutation" value="KRAS"> KRAS</label>
          <label><input type="checkbox" name="mutation" value="NRAS"> NRAS</label>
          <label><input type="checkbox" name="mutation" value="BRAF"> BRAF V600E</label>
          <label><input type="checkbox" name="mutation" value="HER2"> Amplification HER2</label>
        </div>
      </div>

      <div class="input-group">
        <label>PD-L1 CPS :</label>
        <input type="number" id="CPS_colon" min="0" placeholder="Score CPS">
      </div>
    </section>

    <button type="button" onclick="calculateColon()">Générer les recommandations</button>
  </form>

  <div id="resultColon" class="recommendation-box">
    <!-- Résultats générés ici -->
  </div>

  <script>
    function calculateColon() {
      const T = document.getElementById('T_colon').value;
      const N = document.getElementById('N_colon').value;
      const M = document.getElementById('M_colon').value;
      const MSI = document.getElementById('MSI').value;
      const BRAF = document.querySelector('input[name="mutation"][value="BRAF"]').checked;
      const KRAS = document.querySelector('input[name="mutation"][value="KRAS"]').checked;
      const CPS = document.getElementById('CPS_colon').value;
      
      let recommendation = '<h3>Stratégie thérapeutique</h3>';
      
      // Mise à jour des recommandations d'adjuvant 
      if (M === 'M0') {
        recommendation += '<p><strong>Maladie localisée :</strong><br>';
        // Pour les cancers de bas stade (T1, N0), résection endoscopique si critères de bas risque.
        if (T.startsWith('T1') && N === 'N0') {
          recommendation += '- Résection endoscopique peut être envisagée si critères de bas risque.<br>';
        } else {
          // Sinon, une colectomie segmentaire avec curage ganglionnaire est indiquée.
          recommendation += '- Colectomie segmentaire avec curage ganglionnaire est recommandée.<br>';
          if (N !== 'N0' || T === 'T4') {
            // Mise à jour des traitements adjuvants selon le document de Pr Ducreux
            recommendation += '- Chimiothérapie adjuvante pendant 6 mois est recommandée, avec les schémas suivants :<br>';
            recommendation += '<ul>';
            recommendation += '<li><strong>FOLFOX :</strong> Oxaliplatine 85 mg/m² (jour 1), Leucovorine 400 mg/m², 5-FU bolus 400 mg/m² suivi de 5-FU en perfusion continue à 2400 mg/m² sur 46 heures, tous les 14 jours.</li>';
            recommendation += '<li><strong>CAPOX (XELOX) :</strong> Oxaliplatine 130 mg/m² (jour 1) et Capécitabine 1000 mg/m² deux fois par jour pendant 14 jours, toutes les 3 semaines.</li>';
            recommendation += '</ul>';
          }
        }
        recommendation += '</p>';
      } 
      // Recommandations pour la maladie métastatique
      else if (M.startsWith('M1')) {
        recommendation += '<p><strong>Maladie métastatique :</strong><br>';
        recommendation += '- Chimiothérapie de première ligne est recommandée :<br>';
        recommendation += '<ul>';
        recommendation += '<li><strong>FOLFOXIRI/Bevacizumab :</strong> Irinotécan 165 mg/m², Oxaliplatine 85 mg/m², Leucovorine 200 mg/m² (jour 1), puis 5-FU 3200 mg/m² en perfusion continue sur 48 heures, tous les 14 jours; Bevacizumab 5 mg/kg (jour 1, tous les 14 jours)</li>';
        recommendation += '<li><strong>FOLFOX/Cetuximab (si RAS sauvage) :</strong> FOLFOX associé à Cetuximab (dose initiale 400 mg/m², puis 250 mg/m² par semaine)</li>';
        recommendation += '</ul>';
        
        if (MSI === 'MSI-H') {
          recommendation += '- Immunothérapie en première ligne :<br>';
          recommendation += '<ul>';
          recommendation += '<li><strong>Pembrolizumab :</strong> 200 mg IV tous les 3 semaines</li>';
          recommendation += '<li><strong>Nivolumab + Ipilimumab :</strong> Nivolumab 240 mg IV tous les 2 semaines + Ipilimumab 1 mg/kg toutes les 6 semaines</li>';
          recommendation += '</ul>';
        }
        if (BRAF) {
          recommendation += '- Protocole spécifique BRAF :<br>';
          recommendation += '<ul>';
          recommendation += '<li><strong>Encorafénib + Cetuximab :</strong> Encorafénib 300 mg par voie orale une fois par jour, associé à Cetuximab</li>';
          recommendation += '</ul>';
        }
      }
      
      // Points clés et recommandations complémentaires
      recommendation += '<div class="alert">';
      recommendation += '<h4>Points clés :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Évaluation approfondie du statut MSI/MMR et des mutations (RAS, BRAF) pour orienter la thérapie.</li>';
      recommendation += '<li>Les recommandations adjuvantes sont basées sur les protocoles validés.</li>';
      recommendation += '<li>La discussion multidisciplinaire est indispensable pour adapter le traitement en fonction du profil du patient.</li>';
      recommendation += '</ul></div>';
      
      recommendation += '<div class="clinical-trials">';
      recommendation += '<h4>Essais cliniques pertinents :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Essai IDEA pour la durée du traitement adjuvant (FOLFOX/CAPOX)</li>';
      recommendation += '<li>Études évaluant les traitements adjuvants dans le cancer du côlon.</li>';
      recommendation += '</ul></div>';
      
      recommendation += '<div class="follow-up">';
      recommendation += '<h4>Suivi post‑traitement :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Consultation clinique et dosage du CEA tous les 3 mois pendant 2 ans</li>';
      recommendation += '<li>Scanner thoraco-abdomino-pelvien tous les 6 mois pendant 3 ans</li>';
      recommendation += '<li>Coloscopie de contrôle 1 an après la chirurgie, puis tous les 3 à 5 ans</li>';
      recommendation += '</ul></div>';
      
      recommendation += '<div class="references">';
      recommendation += '<h4>Références :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>NCCN Colon Cancer v.3.2024</li>';
      recommendation += '<li>ESMO Guidelines 2023</li>';
      recommendation += '<li></li>';
      recommendation += '</ul></div>';
      
      document.getElementById('resultColon').innerHTML = recommendation;
    }
  </script>
</div>


<!-- Module: Cancer du rectum -->
<div id="moduleRectum" class="module">
  <h2>Cancer du rectum</h2>
  <form id="formRectum">
    <section class="form-section">
      <h2>Caractéristiques tumorales</h2>
      <div class="input-group">
        <label for="localisation_rectum">Localisation :</label>
        <select id="localisation_rectum" required>
          <option value="">--Sélectionner--</option>
          <option value="superieur">Rectum supérieur (10-15 cm de l'anus)</option>
          <option value="moyen">Rectum moyen (5-10 cm de l'anus)</option>
          <option value="inferieur">Rectum inférieur (< 5 cm de l'anus)</option>
        </select>
      </div>
      <div class="input-group">
        <label for="histo_rectum">Type histologique (WHO 2022) :</label>
        <select id="histo_rectum" required>
          <option value="">--Sélectionner--</option>
          <option value="adeno">Adénocarcinome</option>
        </select>
      </div>
      <div class="input-group">
        <label for="differentiation_rectum">Différenciation :</label>
        <select id="differentiation_rectum" required>
          <option value="">--Sélectionner--</option>
          <option value="bien">Bien différencié</option>
          <option value="modere">Modérément différencié</option>
          <option value="peu">Peu différencié</option>
        </select>
      </div>
    </section>
    
    <section class="form-section">
      <h2>Stadification (TNM AJCC 8<sup>ème</sup> édition)</h2>
      <div class="input-group">
        <label for="T_rectum">T :</label>
        <select id="T_rectum" required>
          <option value="">--Sélectionner--</option>
          <option value="Tis">Tis</option>
          <option value="T1">T1</option>
          <option value="T2">T2</option>
          <option value="T3">T3</option>
          <option value="T4a">T4a</option>
          <option value="T4b">T4b</option>
        </select>
      </div>
      <div class="input-group">
        <label for="N_rectum">N :</label>
        <select id="N_rectum" required>
          <option value="">--Sélectionner--</option>
          <option value="N0">N0</option>
          <option value="N1">N1</option>
          <option value="N2">N2</option>
          <option value="N3">N3</option>
        </select>
      </div>
      <div class="input-group">
        <label for="M_rectum">M :</label>
        <select id="M_rectum" required>
          <option value="">--Sélectionner--</option>
          <option value="M0">M0</option>
          <option value="M1">M1</option>
        </select>
      </div>
    </section>
    
    <section class="form-section">
      <h2>Biologie moléculaire et facteurs pronostiques</h2>
      <div class="input-group">
        <label for="MSI_rectum">Statut MSI/MMR :</label>
        <select id="MSI_rectum">
          <option value="">--Sélectionner--</option>
          <option value="MSS">MSS/pMMR</option>
          <option value="MSI-H">MSI-H/dMMR</option>
        </select>
      </div>
      <div class="input-group">
        <label>Facteurs pronostiques :</label>
        <div class="checkbox-group">
          <label><input type="checkbox" name="pronostic_rectum" value="perinerveux"> Envahissement périnerveux</label>
          <label><input type="checkbox" name="pronostic_rectum" value="vasculaire"> Emboles vasculaires</label>
          <label><input type="checkbox" name="pronostic_rectum" value="marges"> Marges circonférentielles étroites</label>
        </div>
      </div>
    </section>
    
    <button type="button" onclick="calculateRectum()">Générer les recommandations</button>
  </form>
  
  <div id="resultRectum" class="recommendation-box">
    <!-- Les recommandations générées apparaîtront ici -->
  </div>
  
  <script>
    function calculateRectum() {
      // Récupération des valeurs
      const localisation = document.getElementById('localisation_rectum').value;
      const histo = document.getElementById('histo_rectum').value;
      const differentiation = document.getElementById('differentiation_rectum').value;
      const T = document.getElementById('T_rectum').value;
      const N = document.getElementById('N_rectum').value;
      const M = document.getElementById('M_rectum').value;
      const MSI = document.getElementById('MSI_rectum').value;
      
      const pronostics = document.querySelectorAll('input[name="pronostic_rectum"]:checked');
      let pronosticList = [];
      pronostics.forEach(item => {
        pronosticList.push(item.value);
      });
      
      let recommendation = '<h3>Stratégie thérapeutique</h3>';
      
      // Maladie localisée (M0)
      if (M === 'M0') {
        recommendation += '<p><strong>Maladie localisée :</strong><br>';
        // Si tumeur précoce et sans facteurs de risque, traitement local possible
        if (T === 'T1' && N === 'N0' && pronosticList.length === 0) {
          recommendation += '- Exérèse locale (résection endoscopique ou transanale, TEM/TAMIS) si critères de bas risque<br>';
        } else {
          // Pour les stades localement avancés
          recommendation += '- Traitement néoadjuvant recommandé :<br>';
          recommendation += '<ul>';
          recommendation += '<li><strong>Chimioradiothérapie (CRT) :</strong> 5-FU en perfusion continue à 225 mg/m²/j pendant la radiothérapie OU Capécitabine 825 mg/m² deux fois par jour, associée à une radiothérapie de 50.4 Gy en 28 fractions</li>';
          recommendation += '</ul>';
          recommendation += '- Suivi d\'une chirurgie radicale (proctectomie avec curage mésorectal)<br>';
          recommendation += '- Chimiothérapie adjuvante (FOLFOX ou CAPOX) peut être envisagée en fonction du bilan pathologique<br>';
          recommendation += '<ul>';
          recommendation += '<li><strong>FOLFOX :</strong> Oxaliplatine 85 mg/m² (jour 1), Leucovorine 400 mg/m², 5-FU bolus 400 mg/m² suivi de 2400 mg/m² en perfusion sur 46 heures, tous les 14 jours</li>';
          recommendation += '<li><strong>CAPOX :</strong> Oxaliplatine 130 mg/m² (jour 1) et Capécitabine 1000 mg/m² deux fois par jour pendant 14 jours, toutes les 3 semaines</li>';
          recommendation += '</ul>';
        }
        recommendation += '</p>';
      } 
      // Maladie métastatique (M1)
      else if (M === 'M1') {
        recommendation += '<p><strong>Maladie métastatique :</strong><br>';
        recommendation += '- Traitement systémique de première ligne :<br>';
        recommendation += '<ul>';
        recommendation += '<li><strong>FOLFOX :</strong> Oxaliplatine 85 mg/m² (jour 1), Leucovorine 400 mg/m², 5-FU bolus 400 mg/m² suivi de 2400 mg/m² en perfusion sur 46 heures, répété tous les 14 jours</li>';
        recommendation += '<li><strong>FOLFIRI :</strong> Irinotécan 180 mg/m² (jour 1), Leucovorine 400 mg/m², 5-FU bolus 400 mg/m² suivi de 2400 mg/m² en perfusion sur 46 heures, répété tous les 14 jours</li>';
        recommendation += '</ul>';
        recommendation += '- Option thérapie ciblée (anti-EGFR) en cas de mutation RAS sauvage peut être envisagée<br>';
        recommendation += '</p>';
      }
      
      // Points clés
      recommendation += '<div class="alert">';
      recommendation += '<h4>Points clés :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Évaluation complète du stade TNM et des facteurs pronostiques (envahissement périnerveux, emboles vasculaires, marges circonférentielles)</li>';
      recommendation += '<li>Le traitement néoadjuvant est essentiel dans les stades localement avancés pour améliorer la résectabilité et réduire le risque de récidive</li>';
      recommendation += '<li>La discussion multidisciplinaire (chirurgie, oncologie, radiothérapie) est indispensable pour adapter la prise en charge</li>';
      recommendation += '</ul></div>';
      
      // Essais cliniques
      recommendation += '<div class="clinical-trials">';
      recommendation += '<h4>Essais cliniques pertinents :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>PROSPECT Trial pour évaluer les stratégies néoadjuvantes</li>';
      recommendation += '<li>OPRA Study pour le suivi de la réponse au traitement conservateur</li>';
      recommendation += '</ul></div>';
      
      // Suivi
      recommendation += '<div class="follow-up">';
      recommendation += '<h4>Suivi et calendrier de surveillance :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Consultations cliniques et dosage du CEA tous les 3 mois pendant les 2 premières années</li>';
      recommendation += '<li>IRM pelvienne ou scanner tous les 6 mois pendant 3 ans</li>';
      recommendation += '<li>Coloscopie de contrôle 1 an après la chirurgie, puis selon le contexte clinique</li>';
      recommendation += '</ul></div>';
      
      // Références
      recommendation += '<div class="references">';
      recommendation += '<h4>Références :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>NCCN Guidelines Rectal Cancer 2024</li>';
      recommendation += '<li>ESMO Guidelines 2023</li>';
      recommendation += '</ul></div>';
      
      document.getElementById('resultRectum').innerHTML = recommendation;
    }
  </script>
</div>

<!-- Module: Cancer de l'œsophage – Prise en charge thérapeutique -->
<div id="moduleOesophageCarcinome" class="module">
  <h3>Cancer de l'œsophage</h3>
  
  <!-- Paramètres du patient -->
  <section class="form-section">
    <h2>Paramètres du Patient</h2>
    <div class="input-group">
      <label for="poids_oe">Poids (kg) :</label>
      <input type="number" id="poids_oe" min="30" step="0.5" placeholder="kg">
    </div>
    <div class="input-group">
      <label for="taille_oe">Taille (cm) :</label>
      <input type="number" id="taille_oe" min="100" step="1" placeholder="cm">
    </div>
    <div id="bsaResult_oe" class="bsa-result"></div>
  </section>
  
  <!-- Caractéristiques tumorales -->
  <section class="form-section">
    <h2>Caractéristiques Tumorales</h2>
    <div class="input-grid">
      <div class="input-group">
        <label for="localisation_oe">Localisation :</label>
        <select id="localisation_oe" required>
          <option value="">--Sélectionner--</option>
          <option value="cervical">Œsophage cervical (15-20 cm)</option>
          <option value="thoracique_sup">Thoracique supérieur (20-25 cm)</option>
          <option value="thoracique_moy">Thoracique moyen (25-30 cm)</option>
          <option value="thoracique_inf">Thoracique inférieur (30-40 cm)</option>
          <option value="abdominal">Segment abdominal (>40 cm)</option>
        </select>
      </div>
      <div class="input-group">
        <label for="macroscopic_oe">Classification Macroscopique :</label>
        <select id="macroscopic_oe">
          <option value="">--Sélectionner--</option>
          <option value="ulcere">Type ulcéré</option>
          <option value="stenosant">Type sténosant</option>
          <option value="vegetant">Type végétant</option>
          <option value="superficiel">Type superficiel</option>
        </select>
      </div>
      <div class="input-group">
        <label for="histo_type_oe">Type Histologique :</label>
        <select id="histo_type_oe" required>
          <option value="">--Sélectionner--</option>
          <option value="squameux">Carcinome épidermoïde</option>
          <option value="adenocarcinome">Adénocarcinome</option>
        </select>
      </div>
    </div>
  </section>
  
  <!-- Stadification -->
  <section class="form-section">
    <h2>Stadification (TNM AJCC 8<sup>ème</sup> édition)</h2>
    <div class="input-grid">
      <div class="input-group">
        <label for="T_oe">T :</label>
        <select id="T_oe" required>
          <option value="">--Sélectionner--</option>
          <option value="Tis">Tis</option>
          <option value="T1a">T1a</option>
          <option value="T1">T1</option>
          <option value="T2">T2</option>
          <option value="T3">T3</option>
          <option value="T4">T4</option>
        </select>
      </div>
      <div class="input-group">
        <label for="N_oes">N :</label>
        <select id="N_oes" required>
          <option value="">--Sélectionner--</option>
          <option value="N0">N0</option>
          <option value="N1">N1 (1-2 ganglions)</option>
          <option value="N2">N2 (3-6 ganglions)</option>
          <option value="N3">N3 (≥7 ganglions)</option>
        </select>
      </div>
      <div class="input-group">
        <label for="M_oes">M :</label>
        <select id="M_oes" required>
          <option value="">--Sélectionner--</option>
          <option value="M0">M0</option>
          <option value="M1">M1</option>
        </select>
      </div>
    </div>
    <div class="input-group">
      <label>Facteurs pronostiques :</label>
      <div class="checkbox-group">
        <label><input type="checkbox" name="pronostic_oe" value="emboles"> Emboles vasculaires</label>
        <label><input type="checkbox" name="pronostic_oe" value="perineural"> Envahissement périnerveux</label>
        <label><input type="checkbox" name="pronostic_oe" value="R1"> Résection R1</label>
      </div>
    </div>
  </section>
  
  <!-- Biomarqueurs -->
  <section class="form-section">
    <h2>Biomarqueurs</h2>
    <div class="input-grid">
      <div class="input-group">
        <label for="CPS_oe">PD-L1 CPS :</label>
        <input type="number" id="CPS_oe" min="0" placeholder="Score CPS">
      </div>
      <div class="input-group">
        <label for="HPV_oe">Statut HPV :</label>
        <select id="HPV_oe">
          <option value="">--Sélectionner--</option>
          <option value="positif">Positif</option>
          <option value="negatif">Négatif</option>
        </select>
      </div>
      <div class="input-group">
        <label for="HER2_oe">Statut HER2 :</label>
        <select id="HER2_oe" required>
          <option value="">--Sélectionner--</option>
          <option value="negatif">Négatif</option>
          <option value="positif">Positif</option>
        </select>
      </div>
    </div>
  </section>
  
  <!-- Bouton de génération -->
  <button type="button" class="recommend-btn" onclick="generateOesophageRecommendations()">Générer les recommandations</button>
  
  <!-- Zone d'affichage -->
  <div id="resultOesophageUnified" class="recommendation-box"></div>
  
  <script>
    let SC_oe = 0; // Surface corporelle calculée via la formule de Mosteller
    
    function calculerSC_oe() {
      const poids = parseFloat(document.getElementById('poids_oe').value);
      const taille = parseFloat(document.getElementById('taille_oe').value);
      if (poids && taille) {
        SC_oe = Math.sqrt((poids * taille) / 3600).toFixed(2);
        document.getElementById('bsaResult_oe').innerHTML = `Surface corporelle : ${SC_oe} m²`;
      }
    }
    
    // Protocoles thérapeutiques de base (exemple simplifié)
    const protocols_oe = {
      localized: {
        adenocarcinome: {
          T1: "Résection endoscopique ou chirurgie minimale invasive (si tumeur <2 cm et bas risque)",
          T2_T3: "Chimiothérapie néoadjuvante (ex. CROSS) suivie d'une résection chirurgicale standard",
          T4: "Radiochimiothérapie néoadjuvante ou traitement palliatif selon l'état général"
        },
        squameux: {
          T1: "Résection endoscopique ou radiothérapie exclusive pour petites lésions",
          T2_T3: "Chirurgie avec ou sans chimiothérapie adjuvante",
          T4: "Radiochimiothérapie (approche multimodale)"
        }
      },
      metastatic: {
        adenocarcinome: "Chimiothérapie (FOLFOX/FOLFIRI) ± Trastuzumab en cas de HER2 positif",
        squameux: "Chimiothérapie doublet (FOLFOX/CF) ou immunothérapie (si PD‑L1 CPS ≥10)"
      }
    };
    
    // Sélection du protocole en fonction des données saisies
    function getTreatmentProtocol_oe(data) {
      let protocol = "";
      if (data.M === 'M0') { // Maladie localisée
        if (data.histo_type === 'adenocarcinome') {
          if (data.T === 'T1') protocol = protocols_oe.localized.adenocarcinome.T1;
          else if (data.T === 'T2' || data.T === 'T3') protocol = protocols_oe.localized.adenocarcinome.T2_T3;
          else if (data.T === 'T4') protocol = protocols_oe.localized.adenocarcinome.T4;
          if (data.HER2 === 'positif') {
            protocol += " + inscription dans un essai ciblé anti‑HER2";
          }
        } else { // Carcinome épidermoïde
          if (data.T === 'T1') protocol = protocols_oe.localized.squameux.T1;
          else if (data.T === 'T2' || data.T === 'T3') protocol = protocols_oe.localized.squameux.T2_T3;
          else protocol = protocols_oe.localized.squameux.T4;
        }
      } else { // Maladie métastatique
        if (data.histo_type === 'adenocarcinome') {
          protocol = data.HER2 === 'positif' ? "Chimiothérapie + Trastuzumab" : protocols_oe.metastatic.adenocarcinome;
        } else {
          protocol = data.CPS >= 10 ? "Immunothérapie + Chimiothérapie" : protocols_oe.metastatic.squameux;
        }
      }
      return protocol;
    }
    
    // Construction de la conduite à tenir
    function generateOesophageRecommendations() {
      calculerSC_oe();
      
      const formData = {
        poids: document.getElementById('poids_oe').value,
        taille: document.getElementById('taille_oe').value,
        localisation: document.getElementById('localisation_oe').value,
        macroscopic: document.getElementById('macroscopic_oe').value,
        histo_type: document.getElementById('histo_type_oe').value,
        T: document.getElementById('T_oe').value,
        N: document.getElementById('N_oes').value,
        M: document.getElementById('M_oes').value,
        CPS: parseInt(document.getElementById('CPS_oe').value) || 0,
        HPV: document.getElementById('HPV_oe').value,
        HER2: document.getElementById('HER2_oe').value,
        // Vous pouvez ajouter d'autres variables si besoin
      };
      
      if (!formData.histo_type || !formData.T || !formData.N || !formData.M || !formData.localisation) {
        alert("Veuillez remplir tous les champs obligatoires");
        return;
      }
      
      const protocol = getTreatmentProtocol_oe(formData);
      
      let recommendation = '<h3>Recommandations thérapeutiques</h3>';
      
      // Protocole de chimiothérapie
      if (formData.M === 'M0') {
        recommendation += '<p><strong>Tumeur résécable :</strong><br>';
        recommendation += 'Le traitement multimodal est de mise. En cas de maladie localisée, une chimiothérapie néoadjuvante (ex. protocole CROSS) suivie d’une résection chirurgicale est recommandée.<br></p>';
        recommendation += '<h4>Protocole de chimiothérapie :</h4>';
        recommendation += '<ul>';
        recommendation += '<li><strong>Exemple CROSS :</strong> 41,4 Gy de radiothérapie associée à une chimiothérapie (5‑FU et platine), suivie d’une résection chirurgicale</li>';
        recommendation += '</ul>';
      } else if (formData.M === 'M1') {
        recommendation += '<p><strong>Maladie métastatique :</strong><br>';
        recommendation += 'Une chimiothérapie systémique (FOLFOX ou FOLFIRI) est recommandée, avec possibilité d’ajouter un traitement ciblé (par exemple, Trastuzumab en cas de HER2 positif).<br></p>';
        recommendation += '<h4>Protocole de chimiothérapie :</h4>';
        recommendation += '<ul>';
        recommendation += '<li>Chimiothérapie de première ligne (FOLFOX ou FOLFIRI)</li>';
        if (formData.HER2 === 'positif') {
          recommendation += '<li>Ajout de Trastuzumab</li>';
        }
        recommendation += '</ul>';
      }
      
      // Essais cliniques pertinents
      recommendation += '<h4>Essais cliniques pertinents :</h4>';
      recommendation += '<ul>';
      if (formData.M === 'M0') {
        recommendation += '<li>Essai CROSS – Étude de la chimiothérapie néoadjuvante en cancer de l\'œsophage</li>';
        recommendation += '<li>Essai NeoSCOPE – Approche multimodale en cancer de l\'œsophage localisé</li>';
      } else {
        recommendation += '<li>Essai KEYNOTE‑590 – Immunothérapie dans le cancer de l\'œsophage avancé</li>';
        recommendation += '<li>Essai ESOPEC – Comparaison des stratégies chirurgicales et de chimiothérapie</li>';
      }
      recommendation += '</ul>';
      
      // Suivi post‑traitement
      recommendation += '<h4>Suivi post‑traitement :</h4>';
      recommendation += '<ul>';
      if (formData.M === 'M0') {
        recommendation += '<li>Surveillance clinique et endoscopique tous les 6-12 mois durant les 2 premières années</li>';
        recommendation += '<li>Imagerie (scanner thoraco-abdominal) annuelle</li>';
      } else {
        recommendation += '<li>Suivi clinique rapproché avec imagerie (CT scan) tous les 3-4 mois</li>';
        recommendation += '<li>Contrôle des marqueurs tumoraux (ex. CEA, CYFRA 21-1) selon le protocole</li>';
      }
      recommendation += '</ul>';
      
      // Remarque
      recommendation += '<h4>Remarque :</h4>';
      recommendation += '<p>La prise en charge doit être adaptée au profil du patient (âge, comorbidités, performance status). La décision thérapeutique doit être prise en réunion pluridisciplinaire, compte tenu de la complexité des options chirurgicales et de l\'approche multimodale requise dans le cancer de l\'œsophage.</p>';
      
      document.getElementById('resultOesophageUnified').innerHTML = recommendation;
    }
  </script>
  
  <style>
    .module {
      font-family: 'Segoe UI', sans-serif;
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
    }
    .form-section {
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .input-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }
    .input-group, .checkbox-group {
      margin-bottom: 1rem;
    }
    .recommend-btn {
      background: #2196F3;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      width: 100%;
      font-size: 16px;
    }
    .recommendation-box {
      margin-top: 20px;
      padding: 20px;
      background: #fff;
      border-radius: 8px;
    }
    .followup ul {
      list-style: disc;
      padding-left: 20px;
    }
    .bsa-result {
      margin-top: 0.5rem;
      font-style: italic;
      color: #555;
    }
  </style>
</div>


<!-- Module: Cancer de l'estomac – Prise en charge thérapeutique -->
<div id="moduleEstomac" class="module">
  <h3>Cancer de l'estomac</h3>
  <form id="formEstomac">
    <!-- Section 1 : Caractéristiques Tumorales -->
    <section class="form-section">
      <h2>Caractéristiques Tumorales</h2>
      <div class="input-group">
        <label for="location_est">Localisation anatomique :</label>
        <select id="location_est" required>
          <option value="">--Sélectionner--</option>
          <option value="cardia">Cardia (Siewert I-III)</option>
          <option value="fundus">Fundus</option>
          <option value="corps">Corps gastrique</option>
          <option value="antrum">Antre</option>
          <option value="pylore">Pylore</option>
          <option value="small_curve">Petite courbure</option>
          <option value="great_curve">Grande courbure</option>
        </select>
      </div>
      <div class="input-group">
        <label for="classification">Classification macroscopique :</label>
        <select id="classification" required>
          <option value="">--Sélectionner--</option>
          <option value="borrmann">Type Borrmann</option>
          <option value="early_gastric">Cancer précoce (EGC)</option>
        </select>
      </div>
      <!-- Affichage conditionnel de la classification Borrmann -->
      <div class="input-group" id="borrmann_group" style="display:none;">
        <label for="borrmann_classification">Type de classification Borrmann :</label>
        <select id="borrmann_classification">
          <option value="">--Sélectionner--</option>
          <option value="type1">Type 1 : Carcinome polypoïde</option>
          <option value="type2">Type 2 : Carcinome ulcéreux avec bords surélevés</option>
          <option value="type3">Type 3 : Carcinome ulcéreux infiltrant</option>
          <option value="type4">Type 4 : Carcinome diffus infiltrant (linitis plastica)</option>
        </select>
      </div>
      <div class="input-group">
        <label>Type histologique (WHO 2019) :</label>
        <select id="histology_est" required>
          <option value="">--Sélectionner--</option>
          <option value="adeno_tub">Adénocarcinome tubuleux</option>
          <option value="adeno_pap">Adénocarcinome papillaire</option>
          <option value="mucineux">Adénocarcinome mucineux</option>
          <option value="signet">Carcinome à cellules en bague à chaton</option>
          <option value="indifferencie">Carcinome peu différencié</option>
        </select>
      </div>
      <div class="input-group">
        <label>Classification de Lauren :</label>
        <select id="lauren_class">
          <option value="">--Sélectionner--</option>
          <option value="intestinal">Type intestinal</option>
          <option value="diffus">Type diffus</option>
          <option value="mixte">Type mixte</option>
        </select>
      </div>
    </section>

    <!-- Section 2 : Stadification -->
    <section class="form-section">
      <h2>Stadification (TNM AJCC 8<sup>ème</sup> édition)</h2>
      <div class="input-group">
        <label for="T_stage">T :</label>
        <select id="T_stage" required>
          <option value="">--Sélectionner--</option>
          <option value="Tis">Tis</option>
          <option value="T1">T1</option>
          <option value="T2">T2</option>
          <option value="T3">T3</option>
          <option value="T4">T4</option>
        </select>
      </div>
      <div class="input-group">
        <label for="N_stage">N :</label>
        <select id="N_stage" required>
          <option value="">--Sélectionner--</option>
          <option value="N0">N0</option>
          <option value="N1">N1</option>
          <option value="N2">N2</option>
          <option value="N3">N3</option>
        </select>
      </div>
      <div class="input-group">
        <label for="M_stage">M :</label>
        <select id="M_stage" required>
          <option value="">--Sélectionner--</option>
          <option value="M0">M0</option>
          <option value="M1">M1</option>
        </select>
      </div>
      <div class="input-group">
        <label>Facteurs pronostiques :</label>
        <div class="checkbox-group">
          <label><input type="checkbox" name="prognostic" value="emboles"> Emboles vasculaires</label>
          <label><input type="checkbox" name="prognostic" value="perineural"> Envahissement périnerveux</label>
          <label><input type="checkbox" name="prognostic" value="limits"> Atteinte des limites de résection</label>
        </div>
      </div>
    </section>

    <!-- Section 3 : Biologie Moléculaire -->
    <section class="form-section">
      <h2>Biologie Moléculaire</h2>
      <div class="input-group">
        <label>Statut HER2 :</label>
        <select id="HER2_status">
          <option value="">--Sélectionner--</option>
          <option value="neg">Négatif</option>
          <option value="pos">Positif (IHC 3+ ou IHC 2+ avec HIS+)</option>
        </select>
      </div>
      <div class="input-group">
        <label>Statut MSI :</label>
        <select id="MSI_status">
          <option value="">--Sélectionner--</option>
          <option value="MSS">MSS</option>
          <option value="MSI-L">MSI-L</option>
          <option value="MSI-H">MSI-H</option>
        </select>
      </div>
      <div class="input-group">
        <label>PD-L1 CPS :</label>
        <input type="number" id="CPS" min="0" placeholder="Score CPS">
      </div>
    </section>

    <button type="button" onclick="calculateManagementEst()">Générer la conduite à tenir</button>
  </form>

  <div id="resultEst" class="recommendation-box"></div>

  <script>
    // Affichage conditionnel de la section Borrmann
    document.getElementById('classification').addEventListener('change', function() {
      var borrmannGroup = document.getElementById('borrmann_group');
      if (this.value === 'borrmann') {
        borrmannGroup.style.display = 'block';
      } else {
        borrmannGroup.style.display = 'none';
      }
    });

    function calculateManagementEst() {
      const T = document.getElementById('T_stage').value;
      const N = document.getElementById('N_stage').value;
      const M = document.getElementById('M_stage').value;
      const HER2 = document.getElementById('HER2_status').value;
      const MSI = document.getElementById('MSI_status').value;
      const CPS = document.getElementById('CPS').value;
      const classification = document.getElementById('classification').value;
      
      let recommendation = '<h3>Recommandations thérapeutiques</h3>';
      
      // Cas des tumeurs résécables (M0)
      if (M === 'M0') {
        recommendation += '<p><strong>Tumeur résécable :</strong><br>';
        recommendation += 'Le protocole périopératoire FLOT est recommandé pour les tumeurs localisées ou localement avancées.<br>';
        recommendation += 'Une gastrectomie D2 avec curage ganglionnaire complet est indiquée.<br></p>';
        recommendation += '<h4>Protocole FLOT :</h4>';
        recommendation += '<ul>';
        recommendation += '<li><strong>Docetaxel :</strong> 50 mg/m² le jour 1</li>';
        recommendation += '<li><strong>Oxaliplatine :</strong> 85 mg/m² le jour 1</li>';
        recommendation += '<li><strong>Fluorouracile :</strong> 2600 mg/m² en perfusion continue sur 24 heures le jour 1</li>';
        recommendation += '<li><strong>Leucovorine :</strong> 200 mg/m² le jour 1</li>';
        recommendation += '<li>Cycle répété toutes les 2 semaines (4 à 6 cycles préopératoires)</li>';
        recommendation += '</ul>';
        if (T === 'T3' || T === 'T4' || N !== 'N0') {
          recommendation += '<p>Après chirurgie, une chimiothérapie adjuvante (basée sur le protocole FLOT ou équivalent) est recommandée en fonction du bilan pathologique.</p>';
        }
      } 
      // Cas des maladies métastatiques (M1)
      else if (M === 'M1') {
        recommendation += '<p><strong>Maladie métastatique :</strong><br>';
        recommendation += 'Une chimiothérapie de première ligne (FOLFOX ou FOLFIRI) est recommandée.<br>';
        if (HER2 === 'pos') {
          recommendation += 'L’ajout de trastuzumab est indiqué.<br>';
        }
        if (MSI === 'MSI-H' || (CPS && Number(CPS) >= 10)) {
          recommendation += 'Une immunothérapie par pembrolizumab peut être envisagée.<br>';
        }
        recommendation += 'Une discussion multidisciplinaire est impérative pour adapter le traitement aux caractéristiques du patient.</p>';
      } 
      else {
        recommendation += '<p>Informations insuffisantes pour établir une conduite à tenir précise.</p>';
      }
      
      // Implications spécifiques si la classification macroscopique est de type Borrmann
      if (classification === 'borrmann') {
        const bType = document.getElementById('borrmann_classification').value;
        if (bType === 'type1') {
          recommendation += '<p><strong>Borrmann Type 1 :</strong> Carcinome polypoïde, souvent associé à une résection complète et un meilleur pronostic.</p>';
        } else if (bType === 'type2') {
          recommendation += '<p><strong>Borrmann Type 2 :</strong> Carcinome ulcéreux avec bords surélevés, facilitant la délimitation tumorale malgré une ulcération.</p>';
        } else if (bType === 'type3') {
          recommendation += '<p><strong>Borrmann Type 3 :</strong> Carcinome ulcéreux infiltrant, présentant un risque accru de récidive.</p>';
        } else if (bType === 'type4') {
          recommendation += '<p><strong>Borrmann Type 4 :</strong> Infiltration diffuse (linitis plastica), associée à un pronostic défavorable et une résection difficile.</p>';
        }
      }
      
      // Essais cliniques pertinents
      recommendation += '<h4>Essais cliniques pertinents :</h4>';
      recommendation += '<ul>';
      recommendation += '<li><strong>FLOT4-AIO Trial</strong> – Périopératoire dans le cancer gastrique (Al‑Batran et al., Lancet, 2019)</li>';
      recommendation += '<li><strong>NORDIC VII Trial</strong> – Approche adjuvante dans le cancer gastrique</li>';
      recommendation += '<li><strong>KEYNOTE‑062</strong> – Immunothérapie par pembrolizumab en cas de MSI‑H ou CPS élevé</li>';
      recommendation += '</ul>';
      
      // Suivi post‑traitement
      recommendation += '<h4>Suivi post‑traitement :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Endoscopie annuelle pendant les 2 premières années, puis tous les 18 à 24 mois</li>';
      recommendation += '<li>Dosage des marqueurs tumoraux (CEA, CA 19‑9) tous les 3 à 6 mois la première année, puis tous les 6 à 12 mois</li>';
      recommendation += '<li>Imagerie (TDM thoraco‑abdominale) tous les 6 mois la première année, puis annuellement</li>';
      recommendation += '</ul>';
      
      recommendation += '<p><strong>Remarque :</strong> La prise en charge doit être discutée en réunion de concertation pluridisciplinaire (RCP) afin d’adapter le traitement aux caractéristiques individuelles du patient (âge, comorbidités, performance status, etc.).</p>';
      
      document.getElementById('resultEst').innerHTML = recommendation;
    }
  </script>
  
  <style>
    .module {
      font-family: 'Segoe UI', sans-serif;
      max-width: 800px;
      margin: 20px auto;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
    }
    .form-section {
      margin-bottom: 1.5rem;
      padding: 1rem;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .input-group, .checkbox-group {
      margin-bottom: 1rem;
    }
    .recommendation-box {
      margin-top: 20px;
      padding: 20px;
      background: #fff;
      border-radius: 8px;
    }
    .alert-success { color: #155724; background-color: #d4edda; padding: 10px; margin-bottom: 10px; }
    .alert-warning { color: #856404; background-color: #fff3cd; padding: 10px; margin-bottom: 10px; }
    .alert-danger { color: #721c24; background-color: #f8d7da; padding: 10px; margin-bottom: 10px; }
    .therapy-options { border-left: 4px solid #004085; padding-left: 1rem; margin-top: 10px; }
  </style>
</div>





 <!-- Module: Tumeurs exocrines du pancréas -->
<div id="modulePancreas" class="module">
  <h3>Tumeurs exocrines du pancréas</h3>
  <form id="formPancreas">
    <!-- Section 1 : Caractéristiques tumorales -->
    <section class="form-section">
      <h2>Caractéristiques Tumorales</h2>
      <div class="input-group">
        <label for="localisation_pancreas">Localisation :</label>
        <select id="localisation_pancreas" required>
          <option value="">--Sélectionner--</option>
          <option value="tete">Tête</option>
          <option value="corps">Corps</option>
          <option value="queue">Queue</option>
        </select>
      </div>
      <div class="input-group">
        <label for="taille_pancreas">Taille de la tumeur (cm) :</label>
        <input type="number" id="taille_pancreas" min="0" step="0.1" placeholder="Ex: 3.5" required>
      </div>
      <div class="input-group">
        <label>Envahissement vasculaire :</label>
        <div class="checkbox-group">
          <label><input type="checkbox" id="envahissement_vasculaire_pancreas" value="oui"> Présent</label>
        </div>
      </div>
    </section>
    
    <!-- Section 2 : Stadification -->
    <section class="form-section">
      <h2>Stadification (TNM AJCC 8<sup>ème</sup> édition)</h2>
      <div class="input-group">
        <label for="T_pancreas">T :</label>
        <select id="T_pancreas" required>
          <option value="">--Sélectionner--</option>
          <option value="T1">T1</option>
          <option value="T2">T2</option>
          <option value="T3">T3</option>
          <option value="T4">T4</option>
        </select>
      </div>
      <div class="input-group">
        <label for="N_pancreas">N :</label>
        <select id="N_pancreas" required>
          <option value="">--Sélectionner--</option>
          <option value="N0">N0</option>
          <option value="N1">N1</option>
          <option value="N2">N2</option>
        </select>
      </div>
      <div class="input-group">
        <label for="M_pancreas">M :</label>
        <select id="M_pancreas" required>
          <option value="">--Sélectionner--</option>
          <option value="M0">M0</option>
          <option value="M1">M1</option>
        </select>
      </div>
    </section>
    
    <!-- Section 3 : Évaluation biologique -->
    <section class="form-section">
      <h2>Évaluation biologique</h2>
      <div class="input-group">
        <label for="CA19_9">Taux de CA 19-9 (U/mL) :</label>
        <input type="number" id="CA19_9" min="0" placeholder="Ex: 37">
      </div>
    </section>
    
    <button type="button" onclick="calculatePancreas()">Générer les recommandations</button>
  </form>
  
  <div id="resultPancreas" class="recommendation-box">
    <!-- Les recommandations générées apparaîtront ici -->
  </div>
  
  <script>
    /*
      Module mis à jour
      (Voir document : 
      https://dokeos-prod.s3.eu-west-1.amazonaws.com/upload/gustaveroussy/training_resources/3335/02bis_Pancr%C3%A9as_-_Dr_Alice_Boileve.pdf)
    */
    function calculatePancreas() {
      const localisation = document.getElementById('localisation_pancreas').value;
      const taille = parseFloat(document.getElementById('taille_pancreas').value);
      const envahissement = document.getElementById('envahissement_vasculaire_pancreas').checked;
      const T = document.getElementById('T_pancreas').value;
      const N = document.getElementById('N_pancreas').value;
      const M = document.getElementById('M_pancreas').value;
      const CA19_9 = document.getElementById('CA19_9').value;
      
      let recommendation = '<h3>Stratégie thérapeutique</h3>';
      
      // Pour la maladie localisée (M0)
      if (M === 'M0') {
        recommendation += '<p><strong>Maladie localisée :</strong><br>';
        // Critères de résectabilité  :
        // Pour T1/T2 sans envahissement vasculaire et N0, la résection est indiquée.
        if ((T === 'T1' || T === 'T2') && N === 'N0' && !envahissement) {
          recommendation += '- Tumeur resectable :<br>';
          recommendation += '<ul>';
          if (localisation === 'tete') {
            recommendation += '<li><strong>Pancréaticoduodénectomie (Whipple) :</strong> indiquée pour les tumeurs de la tête du pancréas.</li>';
          } else {
            recommendation += '<li><strong>Pancréatectomie distale :</strong> indiquée pour les tumeurs du corps ou de la queue.</li>';
          }
          recommendation += '</ul>';
          recommendation += '- Une chimiothérapie adjuvante post-opératoire est recommandée afin de réduire le risque de récidive.<br>';
          recommendation += '<ul>';
          recommendation += '<li><strong>mFOLFIRINOX :</strong> protocoles actualisés – Oxaliplatine 85 mg/m², Irinotécan 150 mg/m², Leucovorine 400 mg/m² (jour 1), puis 5-FU 2400 mg/m² en perfusion continue sur 46 heures, répété toutes les 14 jours.</li>';
          recommendation += '<li><strong>Alternativement :</strong> Gemcitabine 1000 mg/m² administrée les jours 1, 8 et 15, toutes les 28 jours.</li>';
          recommendation += '</ul>';
        } else {
          // Tumeurs borderline ou localement avancées
          recommendation += '- Tumeur borderline ou localement avancée :<br>';
          recommendation += '<ul>';
          recommendation += '<li><strong>Chimiothérapie néoadjuvante :</strong> mFOLFIRINOX est recommandée pour réduire la masse tumorale et optimiser la résection.</li>';
          recommendation += '<li>Dans certains cas, l\'association d\'une radiothérapie peut être envisagée.</li>';
          recommendation += '</ul>';
          recommendation += '- Réévaluation par imagerie après traitement néoadjuvant pour déterminer l\'opportunité de chirurgie.';
        }
        recommendation += '</p>';
      } 
      // Pour la maladie métastatique (M1)
      else if (M === 'M1') {
        recommendation += '<p><strong>Maladie métastatique :</strong><br>';
        recommendation += '- Traitement systémique palliative est recommandé :<br>';
        recommendation += '<ul>';
        recommendation += '<li><strong>Gemcitabine + Nab-paclitaxel :</strong> schéma standard pour les patients avec bonne performance.</li>';
        recommendation += '<li><strong>Option FOLFIRINOX :</strong> envisageable pour les patients sélectionnés, en fonction de leur état général.</li>';
        recommendation += '</ul>';
        recommendation += '</p>';
      }
      
      // Points clés et recommandations complémentaires (mis à jour)
      recommendation += '<div class="alert">';
      recommendation += '<h4>Points clés :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Une évaluation multidisciplinaire est essentielle pour déterminer la resectabilité et choisir le traitement optimal.</li>';
      recommendation += '<li>L\'élévation du CA 19‑9 peut indiquer une maladie plus agressive et doit être prise en compte dans la stratégie thérapeutique.</li>';
      recommendation += '<li>Les protocoles néoadjuvants, notamment le mFOLFIRINOX, améliorent les chances de résection curative dans les cas borderline.</li>';
      recommendation += '</ul></div>';
      
      // Essais cliniques pertinents
      recommendation += '<div class="clinical-trials">';
      recommendation += '<h4>Essais cliniques pertinents :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>ESPAC-4 : Comparaison entre gemcitabine seule et gemcitabine + capécitabine en adjuvant.</li>';
      recommendation += '<li>PREOPANC Trial : Étude sur la chimiothérapie néoadjuvante avant chirurgie.</li>';
      recommendation += '</ul></div>';
      
      // Suivi et surveillance
      recommendation += '<div class="follow-up">';
      recommendation += '<h4>Suivi et calendrier de surveillance :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Consultations cliniques et dosage du CA 19‑9 tous les 3 mois pendant les 2 premières années.</li>';
      recommendation += '<li>Scanner thoraco-abdominal tous les 6 mois pendant les 3 premières années.</li>';
      recommendation += '<li>Réévaluation par imagerie en cas de suspicion de récidive.</li>';
      recommendation += '</ul></div>';
      
      // Références mises à jour
      recommendation += '<div class="references">';
      recommendation += '<h4>Références :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>NCCN Guidelines Pancreatic Adenocarcinoma 2024</li>';
      recommendation += '<li>ESMO Guidelines 2023</li>';
      recommendation += '<li></li>';
      recommendation += '</ul></div>';
      
      document.getElementById('resultPancreas').innerHTML = recommendation;
    }
  </script>
</div>

  <!-- Module: Tumeurs kystiques du pancréas -->
<div id="moduleCysticPancreas" class="module">
  <h3>Tumeurs kystiques du pancréas</h3>
  <form id="formCysticPancreas">
    <section class="form-section">
      <h2>Caractéristiques tumorales</h2>
      <div class="input-group">
        <label for="localisation_cystic">Localisation :</label>
        <select id="localisation_cystic" required>
          <option value="">--Sélectionner--</option>
          <option value="tete">Tête</option>
          <option value="corps">Corps</option>
          <option value="queue">Queue</option>
        </select>
      </div>
      <div class="input-group">
        <label for="type_cystic">Type de tumeur kystique :</label>
        <select id="type_cystic" required>
          <option value="">--Sélectionner--</option>
          <option value="cystadene_sereux">Cystadénome séreux</option>
          <option value="neoplasme_mucineux">Néoplasme mucineux</option>
          <option value="ipmn">IPMN (Intraductal Papillary Mucinous Neoplasm)</option>
          <option value="tps">Tumeur pseudopapillaire solide</option>
        </select>
      </div>
      <div class="input-group">
        <label for="taille_cystic">Taille de la lésion (cm) :</label>
        <input type="number" id="taille_cystic" min="0" step="0.1" placeholder="Ex: 3.0" required>
      </div>
      <div class="input-group">
        <label>Communication avec le canal pancréatique :</label>
        <select id="communication">
          <option value="">--Sélectionner--</option>
          <option value="oui">Oui</option>
          <option value="non">Non</option>
        </select>
      </div>
      <div class="input-group">
        <label>Présence de nodules intracystiques :</label>
        <div class="checkbox-group">
          <label><input type="checkbox" id="nodules" value="oui"> Présents</label>
        </div>
      </div>
    </section>
    
    <section class="form-section">
      <h2>Évaluation biologique</h2>
      <div class="input-group">
        <label for="CA19_9_cystic">Taux de CA 19-9 (U/mL) :</label>
        <input type="number" id="CA19_9_cystic" min="0" placeholder="Ex: 37">
      </div>
    </section>
    
    <button type="button" onclick="calculateCysticPancreas()">Générer les recommandations</button>
  </form>
  
  <div id="resultCysticPancreas" class="recommendation-box">
    <!-- Les recommandations générées apparaîtront ici -->
  </div>
  
  <script>
    function calculateCysticPancreas() {
      const localisation = document.getElementById('localisation_cystic').value;
      const typeTumeur = document.getElementById('type_cystic').value;
      const taille = parseFloat(document.getElementById('taille_cystic').value);
      const communication = document.getElementById('communication').value;
      const nodules = document.getElementById('nodules').checked;
      const CA19_9 = document.getElementById('CA19_9_cystic').value;
      
      let recommendation = '<h3>Stratégie thérapeutique</h3>';
      
      // Determine risk features: size > 3 cm, presence of nodules, communication (especially in IPMN) or elevated CA 19-9
      let highRisk = false;
      if(taille > 3 || nodules || communication === 'oui' || (CA19_9 && parseFloat(CA19_9) > 37)) {
        highRisk = true;
      }
      if(typeTumeur === 'ipmn' && communication === 'oui') {
        highRisk = true;
      }
      
      if(highRisk) {
        recommendation += '<p><strong>Recommandation :</strong><br>';
        recommendation += '- Critères de risque de malignité détectés (taille importante, nodules, communication avec le canal pancréatique ou CA 19-9 élevé).<br>';
        recommendation += '- Chirurgie recommandée après évaluation multidisciplinaire.<br>';
        recommendation += '<ul>';
        if(localisation === 'tete') {
          recommendation += '<li><strong>Pancréaticoduodénectomie (Whipple) :</strong> pour les lésions de la tête du pancréas</li>';
        } else {
          recommendation += '<li><strong>Pancréatectomie distale :</strong> pour les lésions du corps ou de la queue</li>';
        }
        recommendation += '</ul>';
        recommendation += '</p>';
      } else {
        recommendation += '<p><strong>Recommandation :</strong><br>';
        recommendation += '- Absence ou faiblesse des critères de risque de malignité.<br>';
        recommendation += '- Surveillance régulière par imagerie recommandée.<br>';
        recommendation += '</p>';
      }
      
      // Points clés
      recommendation += '<div class="alert">';
      recommendation += '<h4>Points clés :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Une évaluation détaillée des caractéristiques cliniques et radiologiques est essentielle pour estimer le risque de malignité.</li>';
      recommendation += '<li>La présence de nodules intracystiques et la communication avec le canal pancréatique, notamment pour les IPMN, sont des facteurs de risque importants.</li>';
      recommendation += '<li>La surveillance par IRM ou scanner doit être adaptée en fonction du risque identifié.</li>';
      recommendation += '</ul></div>';
      
      // Essais cliniques et recommandations complémentaires
      recommendation += '<div class="clinical-trials">';
      recommendation += '<h4>Essais cliniques et recommandations complémentaires :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>International Consensus Guidelines pour la prise en charge des IPMN.</li>';
      recommendation += '<li>Recommandations de l’ACR pour la surveillance des tumeurs kystiques du pancréas.</li>';
      recommendation += '</ul></div>';
      
      // Suivi et calendrier de surveillance
      recommendation += '<div class="follow-up">';
      recommendation += '<h4>Suivi et calendrier de surveillance :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Imagerie (IRM ou scanner) tous les 6 à 12 mois en fonction du risque.</li>';
      recommendation += '<li>Dosage du CA 19-9 et évaluation clinique lors de chaque consultation.</li>';
      recommendation += '</ul></div>';
      
      // Références
      recommendation += '<div class="references">';
      recommendation += '<h4>Références :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>NCCN Guidelines Pancreatic Cystic Tumors 2024</li>';
      recommendation += '<li>ESMO Guidelines 2023</li>';
      recommendation += '</ul></div>';
      
      document.getElementById('resultCysticPancreas').innerHTML = recommendation;
    }
  </script>
</div>

  <!-- Module: Tumeurs stromales gastro-intestinales (GIST) -->
<div id="moduleGIST" class="module">
  <h3>Tumeurs stromales gastro-intestinales (GIST)</h3>
  <form id="formGIST">
    <section class="form-section">
      <h2>Caractéristiques tumorales</h2>
      <div class="input-group">
        <label for="localisation_gist">Localisation :</label>
        <select id="localisation_gist" required>
          <option value="">--Sélectionner--</option>
          <option value="estomac">Estomac</option>
          <option value="intestin_grêle">Intestin grêle</option>
          <option value="colon">Colon</option>
          <option value="autre">Autre</option>
        </select>
      </div>
      <div class="input-group">
        <label for="taille_gist">Taille de la tumeur (cm) :</label>
        <input type="number" id="taille_gist" min="0" step="0.1" placeholder="Ex: 4.5" required>
      </div>
      <div class="input-group">
        <label for="mitoses">Nombre de mitoses (/50 HPF) :</label>
        <input type="number" id="mitoses" min="0" step="1" placeholder="Ex: 3" required>
      </div>
      <div class="input-group">
        <label for="mutation_gist">Statut mutationnel :</label>
        <select id="mutation_gist" required>
          <option value="">--Sélectionner--</option>
          <option value="kit">Mutation KIT</option>
          <option value="pdgfra">Mutation PDGFRA</option>
          <option value="wild_type">Wild-type</option>
        </select>
      </div>
    </section>
    
    <section class="form-section">
      <h2>Stadification (TNM AJCC 8<sup>ème</sup> édition)</h2>
      <div class="input-group">
        <label for="T_gist">T :</label>
        <select id="T_gist" required>
          <option value="">--Sélectionner--</option>
          <option value="T1">T1</option>
          <option value="T2">T2</option>
          <option value="T3">T3</option>
          <option value="T4">T4</option>
        </select>
      </div>
      <div class="input-group">
        <label for="N_gist">N :</label>
        <select id="N_gist" required>
          <option value="">--Sélectionner--</option>
          <!-- Les GIST présentent rarement des métastases ganglionnaires -->
          <option value="N0">N0</option>
          <option value="N1">N1</option>
        </select>
      </div>
      <div class="input-group">
        <label for="M_gist">M :</label>
        <select id="M_gist" required>
          <option value="">--Sélectionner--</option>
          <option value="M0">M0 (localisée)</option>
          <option value="M1">M1 (métastatique)</option>
        </select>
      </div>
    </section>
    
    <button type="button" onclick="calculateGIST()">Générer les recommandations</button>
  </form>
  
  <div id="resultGIST" class="recommendation-box">
    <!-- Les recommandations générées apparaîtront ici -->
  </div>
  
  <script>
    function calculateGIST() {
      const localisation = document.getElementById('localisation_gist').value;
      const taille = parseFloat(document.getElementById('taille_gist').value);
      const mitoses = parseInt(document.getElementById('mitoses').value);
      const mutation = document.getElementById('mutation_gist').value;
      const T = document.getElementById('T_gist').value;
      const N = document.getElementById('N_gist').value;
      const M = document.getElementById('M_gist').value;
      
      let recommendation = '<h3>Stratégie thérapeutique</h3>';
      
      // Évaluation du risque
      // Les critères de risque sont principalement basés sur la taille, le nombre de mitoses et la localisation
      let highRisk = false;
      if(taille > 5 || mitoses > 5) {
        highRisk = true;
      }
      
      // Pour les GIST localisées (M0)
      if (M === 'M0') {
        recommendation += '<p><strong>Maladie localisée :</strong><br>';
        recommendation += '- Traitement chirurgical : résection complète avec marges négatives.<br>';
        if(highRisk) {
          recommendation += '- <em>Adjuvant :</em> Imatinib 400 mg/jour pendant 3 ans recommandé pour les GIST à haut risque.<br>';
        }
        recommendation += '</p>';
      } 
      // Pour les GIST métastatiques (M1)
      else if (M === 'M1') {
        recommendation += '<p><strong>Maladie métastatique :</strong><br>';
        recommendation += '- Traitement systémique de première ligne : Imatinib 400 mg/jour par voie orale.<br>';
        recommendation += '- En cas de progression, envisager une augmentation à 800 mg/jour ou passer à un traitement de deuxième ligne (Sunitinib ou Regorafenib).<br>';
        recommendation += '</p>';
      }
      
      // Points clés et recommandations complémentaires
      recommendation += '<div class="alert">';
      recommendation += '<h4>Points clés :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>La résection complète est la pierre angulaire du traitement des GIST localisées.</li>';
      recommendation += '<li>Le risque de récidive est évalué sur la taille tumorale, le nombre de mitoses et la localisation.</li>';
      recommendation += '<li>La thérapie adjuvante par Imatinib est indiquée en cas de risque élevé.</li>';
      recommendation += '<li>Les GIST métastatiques sont traitées principalement par une thérapie ciblée (Imatinib), avec possibilité d\'escalade ou de changement en cas de résistance.</li>';
      recommendation += '<li>La discussion multidisciplinaire est essentielle pour personnaliser la prise en charge.</li>';
      recommendation += '</ul></div>';
      
      // Essais cliniques
      recommendation += '<div class="clinical-trials">';
      recommendation += '<h4>Essais cliniques pertinents :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Évaluation de nouveaux inhibiteurs de KIT/PDGFRA</li>';
      recommendation += '<li>Études sur la durée optimale de la thérapie adjuvante</li>';
      recommendation += '</ul></div>';
      
      // Suivi et calendrier de surveillance
      recommendation += '<div class="follow-up">';
      recommendation += '<h4>Suivi et calendrier de surveillance :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Consultations cliniques et scans (CT ou IRM) tous les 6 à 12 mois pendant au moins 5 ans</li>';
      recommendation += '<li>Dosage périodique des marqueurs spécifiques si indiqués</li>';
      recommendation += '</ul></div>';
      
      // Références
      recommendation += '<div class="references">';
      recommendation += '<h4>Références :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>NCCN Guidelines GIST 2024</li>';
      recommendation += '<li>ESMO Guidelines 2023</li>';
      recommendation += '</ul></div>';
      
      document.getElementById('resultGIST').innerHTML = recommendation;
    }
  </script>
</div>

<!-- Module: Carcinome Hépatocellulaire (CHC) - Mise à jour -->

<div id="moduleCHC" class="module">
  <h3>Carcinome Hépatocellulaire (CHC)</h3>
  <form id="formCHC">
    <section class="form-section">
      <h2>Caractéristiques tumorales et hépatiques</h2>
      <div class="input-group">
        <label for="bclc_stage">Stade BCLC :</label>
        <select id="bclc_stage" required>
          <option value="">--Sélectionner--</option>
          <option value="0">0 (Très précoce)</option>
          <option value="A">A (Précoce)</option>
          <option value="B">B (Intermédiaire)</option>
          <option value="C">C (Avancé)</option>
          <option value="D">D (Terminal)</option>
        </select>
      </div>
      <div class="input-group">
        <label for="child_pugh">Classe Child-Pugh :</label>
        <select id="child_pugh" required>
          <option value="">--Sélectionner--</option>
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
      <div class="input-group">
        <label for="ecog">ECOG PS :</label>
        <select id="ecog" required>
          <option value="">--Sélectionner--</option>
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
        </select>
      </div>
    </section>

    <section class="form-section">
      <h2>Critères tumoraux</h2>
      <div class="input-group">
        <label for="nb_lesions">Nombre de lésions :</label>
        <input type="number" id="nb_lesions" min="1" required>
      </div>
      <div class="input-group">
        <label for="taille_max">Taille max (cm) :</label>
        <input type="number" id="taille_max" min="0" step="0.1" required>
      </div>
      <div class="checkbox-group">
        <label><input type="checkbox" id="macrovascular_invasion"> Envahissement macrovascularire</label>
        <label><input type="checkbox" id="portal_hypertension"> Hypertension portale</label>
        <label><input type="checkbox" id="extrahepatic"> Extension extrahépatique</label>
      </div>
    </section>

    <button type="button" onclick="calculateCHC()">Générer les recommandations</button>
  </form>

  <div id="resultCHC" class="recommendation-box"></div>

  <script>
    function calculateCHC() {
      // Récupération des valeurs
      const bclc = document.getElementById('bclc_stage').value;
      const childPugh = document.getElementById('child_pugh').value;
      const ecog = parseInt(document.getElementById('ecog').value);
      const nbLesions = parseInt(document.getElementById('nb_lesions').value);
      const tailleMax = parseFloat(document.getElementById('taille_max').value);
      const macrovascular = document.getElementById('macrovascular_invasion').checked;
      const portalHypertension = document.getElementById('portal_hypertension').checked;
      
      let recommendation = '<h3>Stratégie thérapeutique</h3>';

      // Algorithme décisionnel basé sur BCLC
      switch(bclc) {
        case '0':
        case 'A':
          recommendation += '<p><strong>Stade précoce (BCLC 0-A) :</strong><br>';
          if(childPugh === 'A' && ecog === 0) {
            if((nbLesions === 1 && tailleMax <= 5) || (nbLesions <= 3 && tailleMax <= 3)) {
              recommendation += '- <em>Options curatives :</em><br>';
              recommendation += '• Résection hépatique (si pas d\'hypertension portale)<br>';
              recommendation += '• Transplantation hépatique (critères de Milan)<br>';
              recommendation += '• Ablation percutanée (radiofréquence/MW) pour lésions ≤3 cm<br>';
            }
          } else {
            recommendation += '- Adaptation nécessaire selon réserve fonctionnelle hépatique';
          }
          break;

        case 'B':
          recommendation += '<p><strong>Stade intermédiaire (BCLC B) :</strong><br>';
          recommendation += '- Traitements locorégionaux :<br>';
          recommendation += '• TACE conventionnel ou DEB-TACE (doxorubicine 50-75 mg/m²)<br>';
          recommendation += '• Radioembolisation (TARE) avec Yttrium-90<br>';
          recommendation += '• Thérapie systémique si progression sous TACE<br>';
          break;

        case 'C':
          recommendation += '<p><strong>Stade avancé (BCLC C) :</strong><br>';
          if(childPugh === 'A' && ecog <= 1) {
            recommendation += '- 1<sup>ère</sup> ligne :<br>';
            recommendation += '• Atezolizumab 1200 mg + Bevacizumab 15 mg/kg/3 sem (gold standard)<br>';
            recommendation += '• Alternatives : Sorafénib 400 mg x2/j ou Lenvatinib (8-12 mg/j)<br>';
            recommendation += '- 2<sup>ème</sup> ligne :<br>';
            recommendation += '• Régorafénib 160 mg/j (j1-21/28)<br>';
            recommendation += '• Cabozantinib 60 mg/j<br>';
            recommendation += '• Ramucirumab 8 mg/kg/2 sem (si AFP ≥400 ng/mL)<br>';
          } else {
            recommendation += '- Soins de support + traitement symptomatique';
          }
          break;

        case 'D':
          recommendation += '<p><strong>Stade terminal (BCLC D) :</strong><br>';
          recommendation += '- Prise en charge palliative<br>';
          recommendation += '- Traitement des complications (ascite, encéphalopathie)<br>';
          break;
      }

      // Ajout des mises en garde importantes
      recommendation += '<div class="alert"><h4>Points critiques :</h4><ul>';
      recommendation += '<li>Contre-indication formelle au Bevacizumab en cas :</li>';
      recommendation += '<ul><li>Varices œsophagiennes non contrôlées</li>';
      recommendation += '<li>Antécédent de saignement digestif récent</li></ul>';
      recommendation += '<li>Surveillance rapprochée de la fonction hépatique sous immunothérapie</li>';
      recommendation += '<li>Évaluation multidisciplinaire systématique</li></ul></div>';

      // Calendrier de suivi
      recommendation += '<div class="follow-up"><h4>Surveillance :</h4><ul>';
      recommendation += '<li>Imagerie (TDM/MRI) + AFP tous les 3 mois</li>';
      recommendation += '<li>Évaluation de la réponse selon mRECIST</li>';
      recommendation += '<li>Dépistage des effets secondaires des traitements systémiques</li></ul></div>';

      document.getElementById('resultCHC').innerHTML = recommendation;
    }
  </script>
</div>
<!-- Module: Cholangiocarcinome intrahepatique -->
<div id="moduleCholangiocarcinomeIntrahep" class="module">
  <h3>Cholangiocarcinome intrahepatique</h3>
  <form id="formCholangiocarcinomeIntrahep">
    <section class="form-section">
      <h2>Caractéristiques tumorales</h2>
      <div class="input-group">
        <label for="nombre_nodules">Nombre de nodules :</label>
        <input type="number" id="nombre_nodules" min="1" placeholder="Ex: 1" required>
      </div>
      <div class="input-group">
        <label for="taille_tumeur_intrahep">Taille de la tumeur (cm) :</label>
        <input type="number" id="taille_tumeur_intrahep" min="0" step="0.1" placeholder="Ex: 5.0" required>
      </div>
      <div class="input-group">
        <label for="envahissement_vasculaire_intrahep">Envahissement vasculaire :</label>
        <div class="checkbox-group">
          <label><input type="checkbox" id="envahissement_vasculaire_intrahep" value="oui"> Présent</label>
        </div>
      </div>
      <div class="input-group">
        <label for="differentiation_intrahep">Différenciation :</label>
        <select id="differentiation_intrahep" required>
          <option value="">--Sélectionner--</option>
          <option value="bien">Bien différencié</option>
          <option value="modere">Modérément différencié</option>
          <option value="peu">Peu différencié</option>
        </select>
      </div>
    </section>
    
    <section class="form-section">
      <h2>Stadification (TNM AJCC 8<sup>ème</sup> édition)</h2>
      <div class="input-group">
        <label for="T_intrahep">T :</label>
        <select id="T_intrahep" required>
          <option value="">--Sélectionner--</option>
          <option value="T1">T1</option>
          <option value="T2">T2</option>
          <option value="T3">T3</option>
          <option value="T4">T4</option>
        </select>
      </div>
      <div class="input-group">
        <label for="N_intrahep">N :</label>
        <select id="N_intrahep" required>
          <option value="">--Sélectionner--</option>
          <option value="N0">N0</option>
          <option value="N1">N1</option>
        </select>
      </div>
      <div class="input-group">
        <label for="M_intrahep">M :</label>
        <select id="M_intrahep" required>
          <option value="">--Sélectionner--</option>
          <option value="M0">M0 (non métastatique)</option>
          <option value="M1">M1 (métastatique)</option>
        </select>
      </div>
    </section>
    
    <section class="form-section">
      <h2>Évaluation biologique</h2>
      <div class="input-group">
        <label for="CA19_9_intrahep">Taux de CA 19-9 (U/mL) :</label>
        <input type="number" id="CA19_9_intrahep" min="0" placeholder="Ex: 37">
      </div>
    </section>
    
    <button type="button" onclick="calculateCholangiocarcinomeIntrahep()">Générer les recommandations</button>
  </form>
  
  <div id="resultCholangiocarcinomeIntrahep" class="recommendation-box">
    <!-- Les recommandations générées apparaîtront ici -->
  </div>
  
  <script>
    function calculateCholangiocarcinomeIntrahep() {
      // Récupération des valeurs du formulaire
      const nombreNodules = parseInt(document.getElementById('nombre_nodules').value);
      const taille = parseFloat(document.getElementById('taille_tumeur_intrahep').value);
      const envahissement = document.getElementById('envahissement_vasculaire_intrahep').checked;
      const differentiation = document.getElementById('differentiation_intrahep').value;
      const T = document.getElementById('T_intrahep').value;
      const N = document.getElementById('N_intrahep').value;
      const M = document.getElementById('M_intrahep').value;
      const CA19_9 = document.getElementById('CA19_9_intrahep').value;
      
      let recommendation = '<h3>Stratégie thérapeutique</h3>';
      
      // Traitement en fonction du statut métastatique
      if (M === 'M0') {
        recommendation += '<p><strong>Maladie localisée :</strong><br>';
        // Critères de résectabilité
        if (nombreNodules === 1 && taille <= 5 && !envahissement) {
          recommendation += '- Résection hépatique (résection segmentaire ou hémi-hépatique) avec marges négatives est recommandée.<br>';
        } else {
          recommendation += '- En cas de tumeur multifocale ou de tumeur volumineuse/envahissante, envisager une approche multimodale :<br>';
          recommendation += '<ul>';
          recommendation += '<li><strong>Chimiothérapie néoadjuvante :</strong> pour réduire la masse tumorale et faciliter la résection.</li>';
          recommendation += '<li>Réévaluation post-traitement pour envisager la chirurgie.</li>';
          recommendation += '</ul>';
        }
        // Facteurs de risque supplémentaires
        if (N !== 'N0' || T === 'T3' || T === 'T4' || (CA19_9 && parseFloat(CA19_9) > 37) || differentiation === 'peu') {
          recommendation += '- Une chimiothérapie adjuvante peut être envisagée en fonction du bilan pathologique.<br>';
        }
        recommendation += '</p>';
      } else if (M === 'M1') {
        recommendation += '<p><strong>Maladie métastatique :</strong><br>';
        recommendation += '- Traitement systémique palliative recommandé :<br>';
        recommendation += '<ul>';
        recommendation += '<li><strong>Gemcitabine + Cisplatine :</strong> Gemcitabine 1000 mg/m² (jours 1, 8 et 15) + Cisplatine 25 mg/m² (jours 1 et 8) toutes les 28 jours.</li>';
        recommendation += '<li>Options de deuxième ligne à adapter selon la réponse et l’état du patient.</li>';
        recommendation += '</ul>';
        recommendation += '</p>';
      }
      
      // Points clés et recommandations complémentaires
      recommendation += '<div class="alert">';
      recommendation += '<h4>Points clés :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>La résection complète reste le seul traitement potentiellement curatif pour le cholangiocarcinome intrahepatique.</li>';
      recommendation += '<li>Les critères de resectabilité incluent le nombre de nodules, la taille tumorale et l’absence d’envahissement vasculaire.</li>';
      recommendation += '<li>Le taux de CA 19-9 et la différenciation tumorale fournissent des indications pronostiques importantes.</li>';
      recommendation += '<li>Une approche multidisciplinaire est essentielle pour optimiser le traitement.</li>';
      recommendation += '</ul></div>';
      
      // Essais cliniques et recommandations complémentaires
      recommendation += '<div class="clinical-trials">';
      recommendation += '<h4>Essais cliniques pertinents :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Études évaluant la chimiothérapie néoadjuvante pour améliorer la résectabilité</li>';
      recommendation += '<li>Recherche sur les agents ciblés et immunothérapies dans le cholangiocarcinome intrahepatique</li>';
      recommendation += '</ul></div>';
      
      // Suivi et calendrier de surveillance
      recommendation += '<div class="follow-up">';
      recommendation += '<h4>Suivi et calendrier de surveillance :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Consultations cliniques et dosage du CA 19-9 tous les 3 à 6 mois pendant les 2 premières années</li>';
      recommendation += '<li>Imagerie (scanner ou IRM) tous les 6 mois pendant les 3 à 5 premières années</li>';
      recommendation += '<li>Adaptation du suivi en fonction de la réponse thérapeutique et de l\'éventuelle récidive</li>';
      recommendation += '</ul></div>';
      
      // Références
      recommendation += '<div class="references">';
      recommendation += '<h4>Références :</h4>';
      recommendation += '<ul>';
      recommendation += '<li></a></li>';
      recommendation += '<li>NCCN Guidelines Cholangiocarcinoma 2024</li>';
      recommendation += '<li>ESMO Guidelines 2023</li>';
      recommendation += '</ul></div>';
      
      document.getElementById('resultCholangiocarcinomeIntrahep').innerHTML = recommendation;
    }
  </script>
</div>


<!-- Module: Cholangiocarcinome extrahépatique (Mise à jour IGR) -->
<div id="moduleCholangiocarcinomeExtrahep" class="module">
  <h3>Cholangiocarcinome extrahépatique</h3>
  <form id="formCholangiocarcinome">
    <!-- Section 1 : Caractéristiques tumorales -->
    <section class="form-section">
      <h2>Caractéristiques tumorales</h2>
      <div class="input-group">
        <label for="localisation_cc">Localisation :</label>
        <select id="localisation_cc" required>
          <option value="">--Sélectionner--</option>
          <option value="hilaire">Cholangiocarcinome hilaire (Klatskin)</option>
          <option value="distal">Cholangiocarcinome distal</option>
        </select>
      </div>
      <div class="input-group">
        <label for="histo_cc">Type histologique :</label>
        <select id="histo_cc" required>
          <option value="">--Sélectionner--</option>
          <option value="adeno">Adénocarcinome</option>
        </select>
      </div>
      <div class="input-group">
        <label for="differentiation_cc">Différenciation :</label>
        <select id="differentiation_cc" required>
          <option value="">--Sélectionner--</option>
          <option value="bien">Bien différencié</option>
          <option value="modere">Modérément différencié</option>
          <option value="peu">Peu différencié</option>
        </select>
      </div>
    </section>
    
    <!-- Section 2 : Stadification -->
    <section class="form-section">
      <h2>Stadification (TNM AJCC 8<sup>ème</sup> édition)</h2>
      <div class="input-group">
        <label for="T_cc">T :</label>
        <select id="T_cc" required>
          <option value="">--Sélectionner--</option>
          <option value="T1">T1</option>
          <option value="T2">T2</option>
          <option value="T3">T3</option>
          <option value="T4">T4</option>
        </select>
      </div>
      <div class="input-group">
        <label for="N_cc">N :</label>
        <select id="N_cc" required>
          <option value="">--Sélectionner--</option>
          <option value="N0">N0</option>
          <option value="N1">N1</option>
          <option value="N2">N2</option>
        </select>
      </div>
      <div class="input-group">
        <label for="M_cc">M :</label>
        <select id="M_cc" required>
          <option value="">--Sélectionner--</option>
          <option value="M0">M0 (non métastatique)</option>
          <option value="M1">M1 (métastatique)</option>
        </select>
      </div>
    </section>
    
    <!-- Section 3 : Évaluation biologique -->
    <section class="form-section">
      <h2>Évaluation biologique</h2>
      <div class="input-group">
        <label for="CA19_9_cc">Taux de CA 19-9 (U/mL) :</label>
        <input type="number" id="CA19_9_cc" min="0" placeholder="Ex: 37">
      </div>
    </section>
    
    <button type="button" onclick="calculateCholangiocarcinome()">Générer les recommandations</button>
  </form>
  
  <div id="resultCholangiocarcinome" class="recommendation-box">
    <!-- Les recommandations générées apparaîtront ici -->
  </div>
  
  <script>
    function calculateCholangiocarcinome() {
      const localisation = document.getElementById('localisation_cc').value;
      const histo = document.getElementById('histo_cc').value;
      const differentiation = document.getElementById('differentiation_cc').value;
      const T = document.getElementById('T_cc').value;
      const N = document.getElementById('N_cc').value;
      const M = document.getElementById('M_cc').value;
      const CA19_9 = document.getElementById('CA19_9_cc').value;
      
      let recommendation = '<h3>Stratégie thérapeutique</h3>';
      
      // Pour les maladies localisées (M0)
      if (M === 'M0') {
        recommendation += '<p><strong>Maladie localisée :</strong><br>';
        recommendation += '- La résection chirurgicale radicale avec curage lymphatique est le traitement de choix.<br>';
        if (localisation === 'hilaire') {
          recommendation += '- Pour un cholangiocarcinome hilaire, une résection hépatobiliaire avec reconstruction biliaire (ex. anastomose bilio-digestive) est recommandée.<br>';
        } else if (localisation === 'distal') {
          recommendation += '- Pour un cholangiocarcinome distal, la résection peut être réalisée par pancreatoduodénale (Whipple) ou par résection segmentaire de la voie biliaire, selon l’extension tumorale.<br>';
        }
        // Recommandation d’adjuvant en présence de facteurs de risque
        if (N !== 'N0' || T === 'T3' || T === 'T4' || (CA19_9 && parseFloat(CA19_9) > 37)) {
          recommendation += '- En présence de facteurs de risque (stade élevé, marges incertaines, CA 19-9 élevé), une chimiothérapie adjuvante est recommandée.<br>';
          recommendation += '<ul>';
          recommendation += '<li><strong>Capécitabine :</strong> 1250 mg/m² deux fois par jour pendant 8 cycles (ou selon protocole institutionnel).</li>';
          recommendation += '<li>Possibilité d\'associer une radiothérapie adjuvante dans certains cas, notamment pour les tumeurs hilaires.</li>';
          recommendation += '</ul>';
        }
        recommendation += '</p>';
      } 
      // Pour les maladies métastatiques (M1)
      else if (M === 'M1') {
        recommendation += '<p><strong>Maladie métastatique :</strong><br>';
        recommendation += '- Le traitement systémique palliative est recommandé.<br>';
        recommendation += '- Chimiothérapie de première ligne :<br>';
        recommendation += '<ul>';
        recommendation += '<li><strong>Gemcitabine + Cisplatine :</strong> Gemcitabine 1000 mg/m² (jours 1, 8 et 15) + Cisplatine 25 mg/m² (jours 1 et 8) toutes les 28 jours.</li>';
        recommendation += '</ul>';
        recommendation += '- En cas de progression, envisager une option de deuxième ligne (ex. FOLFOX, Capécitabine ou essais cliniques).<br>';
        recommendation += '</p>';
      }
      
      // Points clés et recommandations complémentaires
      recommendation += '<div class="alert">';
      recommendation += '<h4>Points clés :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>La résection complète avec marges négatives est cruciale pour une prise en charge curative.</li>';
      recommendation += '<li>La stadification TNM, le statut ganglionnaire et le taux de CA 19-9 constituent des indicateurs pronostiques majeurs.</li>';
      recommendation += '<li>La chimiothérapie adjuvante, éventuellement associée à la radiothérapie, peut améliorer la survie en cas de facteurs de risque élevés.</li>';
      recommendation += '<li>La prise en charge doit être validée en réunion multidisciplinaire (RCP).</li>';
      recommendation += '</ul></div>';
      
      // Essais cliniques et informations complémentaires
      recommendation += '<div class="clinical-trials">';
      recommendation += '<h4>Essais cliniques pertinents :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>BILCAP Trial pour l\'adjuvant dans les cancers biliaires.</li>';
      recommendation += '<li>Études récentes sur les agents ciblés et l\'immunothérapie en cholangiocarcinome.</li>';
      recommendation += '</ul></div>';
      
      // Suivi et calendrier de surveillance
      recommendation += '<div class="follow-up">';
      recommendation += '<h4>Suivi et calendrier de surveillance :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Consultations cliniques et dosage du CA 19-9 tous les 3 à 6 mois pendant les 2 premières années.</li>';
      recommendation += '<li>Imagerie (scanner ou IRM) tous les 6 mois pendant les 3 à 5 premières années.</li>';
      recommendation += '<li>Adaptation du suivi en fonction de la réponse thérapeutique et de l\'éventuelle récidive.</li>';
      recommendation += '</ul></div>';
      
      // Références
      recommendation += '<div class="references">';
      recommendation += '<h4>Références :</h4>';
      recommendation += '<ul>';
      recommendation += '<li></li>';
      recommendation += '<li>NCCN Guidelines Cholangiocarcinoma 2024</li>';
      recommendation += '<li>ESMO Guidelines 2023</li>';
      recommendation += '</ul></div>';
      
      document.getElementById('resultCholangiocarcinome').innerHTML = recommendation;
    }
  </script>
</div>


<!-- Module: Conduite à tenir interactive pour le lymphome digestif -->
  <div id="moduleLymphomes" class="module">
    <h3>Le lymphome digestif</h3>
	
  <form id="managementForm">
    <!-- Section Endoscopie -->
    <section class="form-section">
      <h2>Informations Endoscopiques</h2>
      <label for="location">Localisation de la lésion :</label>
      <select id="location">
        <option value="estomac">Estomac</option>
        <option value="intestin">Intestin grêle</option>
        <option value="colon">Colon</option>
      </select>
      
      <label for="lesionAppearance">Aspect de la lésion :</label>
      <select id="lesionAppearance">
        <option value="ulcereuse">Ulcéreuse</option>
        <option value="polypoide">Polypoïde</option>
        <option value="nodulaire">Nodulaire</option>
      </select>
    </section>
    
    <!-- Section Histologie -->
    <section class="form-section">
      <h2>Informations Histologiques</h2>
      <label for="lymphomaType">Type de lymphome :</label>
      <select id="lymphomaType">
        <option value="MALT">Lymphome MALT</option>
        <option value="DLBCL">Lymphome diffus à grandes cellules B (DLBCL)</option>
        <option value="folliculaire">Lymphome folliculaire</option>
        <option value="entero">Lymphome entéroplasmoide</option>
      </select>
      
      <label for="ki67">Index Ki-67 :</label>
      <select id="ki67">
        <option value="faible">Faible (&lt;20%)</option>
        <option value="modere">Modéré (20-50%)</option>
        <option value="eleve">Élevé (&gt;50%)</option>
      </select>
      
      <!-- Pour les lymphomes gastriques, la positivité à H. pylori est essentielle -->
      <label><input type="checkbox" id="hpylori" value="positive"> H. pylori positif</label>
    </section>
    
    <!-- Section Bilan d'extension -->
    <section class="form-section">
      <h3>Bilan d'Extension</h3>
      <label for="stage">Stade de la maladie (classification d'Ann Arbor) :</label>
      <select id="stage">
        <option value="localise">Localisé (stade IE)</option>
        <option value="avance">Localement avancé (stade IIE/IIIE)</option>
        <option value="metastatique">Systémique / Métastatique (stade IV)</option>
      </select>
      
      <label>B symptoms :</label>
      <label><input type="checkbox" id="bsymptoms" value="present"> Présents</label>
    </section>
    
    <button type="button" onclick="calculateManagement()">Générer la conduite à tenir</button>
  </form>
  
  <div id="result"></div>
  
  <footer>
    <p><em>Disclaimer : Ce document est fourni à titre informatif.</em></p>
  </footer>
  
  <script>
    function calculateManagement() {
      // Récupération des valeurs du formulaire
      var location = document.getElementById("location").value;
      var lesionAppearance = document.getElementById("lesionAppearance").value;
      var lymphomaType = document.getElementById("lymphomaType").value;
      var ki67 = document.getElementById("ki67").value;
      var stage = document.getElementById("stage").value;
      var hpylori = document.getElementById("hpylori").checked;
      var bsymptoms = document.getElementById("bsymptoms").checked;
      
      var plan = "";
      
      // Conduite à tenir en fonction du type de lymphome
      if (lymphomaType === "MALT") {
        if (location === "estomac") {
          if (hpylori) {
            plan = "Traitement d'éradication de H. pylori (antibiothérapie) est recommandé. ";
            plan += "Une surveillance endoscopique doit être effectuée pour vérifier la rémission.";
          } else {
            plan = "En l'absence de H. pylori ou en cas d'échec du traitement d'éradication, une radiothérapie locale peut être envisagée pour un lymphome MALT localisé.";
          }
        } else {
          plan = "Pour un lymphome MALT extra-gastrique, le traitement de première intention est généralement une radiothérapie localisée, avec ou sans immunothérapie en fonction de l'extension.";
        }
      } else if (lymphomaType === "DLBCL") {
        plan = "Le traitement de référence pour le DLBCL est l'immunochimiothérapie R-CHOP. ";
        if (stage === "localise") {
          plan += "En cas de DLBCL localisé, R-CHOP suivi d'une radiothérapie consolidatrice peut être envisagé.";
        } else {
          plan += "Pour un DLBCL avancé ou systémique, 6 à 8 cycles de R-CHOP sont recommandés, avec une évaluation intermédiaire de la réponse.";
        }
      } else if (lymphomaType === "folliculaire") {
        plan = "Dans le lymphome folliculaire, en l'absence de symptômes et avec une faible charge tumorale, une stratégie de « watch and wait » peut être envisagée. ";
        if (bsymptoms || stage !== "localise") {
          plan += "En cas d'évolution ou de présence de symptômes, une chimiothérapie associée à l'immunothérapie (ex. R-CHOP ou R-Bendamustine) est indiquée.";
        }
      } else if (lymphomaType === "entero") {
        plan = "Pour le lymphome entéroplasmoide, le traitement repose généralement sur une chimiothérapie de type CHOP. ";
        if (stage !== "localise") {
          plan += "En cas d'extension, un protocole intensifié peut être envisagé, et une prise en charge chirurgicale sera discutée en cas de complications (perforation, hémorragie).";
        }
      } else {
        plan = "Informations insuffisantes pour définir une conduite à tenir.";
      }
      
      // Ajout d'informations complémentaires en fonction du stade
      if (stage === "avance") {
        plan += " Le stade localement avancé nécessite une approche multimodale avec association de chimiothérapie et, si nécessaire, de radiothérapie.";
      } else if (stage === "metastatique") {
        plan += " En cas de maladie systémique ou métastatique, une stratégie de chimiothérapie systémique est préconisée, avec prise en charge des symptômes B (si présents).";
      }
      
      // Compléments en fonction de l'aspect endoscopique
      if (lesionAppearance === "ulcereuse") {
        plan += " La présence d'une lésion ulcéreuse peut être associée à un risque de complications (saignement, perforation) nécessitant une prise en charge rapide.";
      }
      
      // Commentaire sur la prolifération tumorale en fonction de l'index Ki-67
      if (ki67 === "eleve") {
        plan += " Un index Ki-67 élevé traduit une forte activité proliférative, impliquant un suivi rapproché et une réponse thérapeutique évaluée précocement.";
      }
      
      document.getElementById("result").innerText = plan;
    }
  </script>
  </div>


<!-- Module: Hépatite Auto-immune -->
<div id="moduleAutoimmuneHepatitis" class="module">
  <h3>Hépatite Auto‑immune & Cholangite Biliaire Primitive (CBP)</h3>
  <form id="formAutoimmuneHepatitis">
    
    <!-- Section Données Cliniques -->
    <section class="form-section">
      <h2>Données Cliniques</h2>
      <label>
        Âge : 
        <input type="number" id="hai_age" min="18" required title="Âge du patient (années)">
      </label>
      <label>
        Sexe : 
        <select id="hai_sexe" required title="Sexe du patient">
          <option value="F">Femme</option>
          <option value="H">Homme</option>
        </select>
      </label>
      <label>
        Prurit : 
        <input type="checkbox" id="hai_prurit" title="Présence de prurit">
      </label>
    </section>

    <!-- Section Hépatite Auto-immune (AIH) -->
    <section class="form-section">
      <h3>Critères AIH (IAIHG 2023)</h3>
      <label>
        ALAT (SGPT) (N < 40 UI/L) : 
        <input type="number" id="hai_alt" title="Niveau d'ALT (UI/L)">
      </label>
      <label>
        IgG (N < 16 g/L) : 
        <input type="number" id="hai_igg" title="Niveau d'IgG (g/L)">
      </label>
      <fieldset>
        <legend>Auto-anticorps :</legend>
        <label>
          <input type="checkbox" id="hai_ANA" title="Anticorps antinucléaires (ANA) ≥1/40"> ANA ≥1/40 (Anticorps antinucléaires)
        </label>
        <label>
          <input type="checkbox" id="hai_SMA" title="Anticorps anti-muscle lisse (SMA) ≥1/40"> SMA ≥1/40 (Anticorps anti-muscle lisse)
        </label>
        <label>
          <input type="checkbox" id="hai_LKM" title="Anti-LKM1"> Anti-LKM1 (Anticorps anti-foie rein)
        </label>
      </fieldset>
      <label>
        Score histologique (HAI) : 
        <select id="hai_histo_aih" title="Score HAI">
          <option value="0">Typique (HAI ≥7)</option>
          <option value="1">Compatible (HAI 5-6)</option>
          <option value="2">Non concluant</option>
        </select>
      </label>
    </section>

    <!-- Section Cholangite Biliaire Primitive (CBP) -->
    <section class="form-section">
      <h3>Critères CBP (EASL 2022)</h3>
      <label>
        PAL (N < 120 UI/L) : (Phosphatase alcaline)
        <input type="number" id="hai_alp" title="Niveau d'ALP (UI/L)">
      </label>
      <label>
        AMA : Antimitochondriaux
        <select id="hai_ama" title="Anticorps antimitochondriaux (AMA)">
          <option value="0">Négatif</option>
          <option value="1">≥1/40</option>
          <option value="2">≥1/80</option>
        </select>
      </label>
      <fieldset>
        <legend>Anticorps spécifiques :</legend>
        <label>
          <input type="checkbox" id="hai_anti_sp100" title="Anti-SP100"> Anti-SP100
        </label>
        <label>
          <input type="checkbox" id="hai_anti_gp210" title="Anti-GP210"> Anti-GP210
        </label>
      </fieldset>
      <label>
        Histologie CBP : 
        <select id="hai_histo_cbp" title="Stade histologique pour la CBP">
          <option value="0">Stade 1-2 (lésion ductale floride)</option>
          <option value="1">Stade 3-4 (fibrose avancée)</option>
        </select>
      </label>
    </section>

    <!-- Section Syndrome de chevauchement -->
    <section class="form-section">
      <h3>Critères Paris pour Overlap AIH-CBP</h3>
      <label>
        <input type="checkbox" id="hai_overlap" title="Critères des deux maladies présents">
        Présence de critères des deux maladies
      </label>
    </section>

    <button type="button" onclick="calculateHAI()">Générer la conduite</button>
  </form>

  <div id="hai_result" class="result"></div>

  <script>
    function calculateHAI() {
      // Récupération et conversion des valeurs avec les IDs spécifiques
      const age = parseFloat(document.getElementById('hai_age').value) || 0;
      const sexe = document.getElementById('hai_sexe').value;
      const alt = parseFloat(document.getElementById('hai_alt').value) || 0;
      const igg = parseFloat(document.getElementById('hai_igg').value) || 0;
      const alp = parseFloat(document.getElementById('hai_alp').value) || 0;
      const ama = parseInt(document.getElementById('hai_ama').value, 10) || 0;
      const overlap = document.getElementById('hai_overlap').checked;

      let result = "<h3>Conduite à tenir :</h3>";

      // Gestion CBP : Si AMA positif (≥1) et ALP > 1.5x la normale (1.5x120 = 180 UI/L)
      if (ama >= 1 && alp > 1.5 * 120) {
        result += "<h4>Diagnostic CBP probable</h4>";
        result += "<ul>";
        result += "<li>Traitement de 1ère ligne : UDCA 13-15 mg/kg/j</li>";
        if (alp > 2 * 120) {
          result += "<li>Ajouter des fibrates en 2ème intention si réponse inadéquate</li>";
        }
        result += "<li>Surveillance : PAL/GGT tous les 3 mois</li>";
        result += "</ul>";
      }

      // Gestion AIH : Si ALT ou IgG élevés ET présence de ANA ou SMA
      if ((alt > 40 || igg > 16) && (document.getElementById('hai_ANA').checked || document.getElementById('hai_SMA').checked)) {
        result += "<h4>Diagnostic AIH probable</h4>";
        result += "<ul>";
        result += "<li>Traitement initial : Prednisone 0.5-1 mg/kg/j + Azathioprine 1-2 mg/kg/j</li>";
        result += "<li>Objectif : Normalisation de l'ALT et de l'IgG sous 3 mois</li>";
        result += "</ul>";
      }

      // Gestion Overlap
      if (overlap) {
        result += "<h4>Syndrome de chevauchement AIH-CBP</h4>";
        result += "<ul>";
        result += "<li>Thérapie combinée : UDCA + immunosuppresseurs</li>";
        result += "<li>Surveillance rapprochée des transaminases et de l'ALP</li>";
        result += "</ul>";
      }

      // Pronostic
      result += "<h3>Pronostic :</h3>";
      result += "<p>Risque de cirrhose : ";
      if (alp > 300 || alt > 100) result += "Élevé (surveillance semestrielle recommandée)";
      else result += "Modéré";
      result += "</p>";

      document.getElementById('hai_result').innerHTML = result;
    }
  </script>

  <style>
    .form-section {
      border: 1px solid #ddd;
      padding: 15px;
      margin: 10px 0;
    }
    .result {
      background: #f8f9fa;
      padding: 20px;
      margin-top: 20px;
    }
  </style>
</div>


<div id="moduleOeE" class="module">
  <div class="container">
    <h1>Conduite à tenir – OeSophagite à Éosinophiles (OeE)</h1>
    <p>Veuillez renseigner les données cliniques, endoscopiques, histologiques et du bilan d’extension afin de générer une proposition de prise en charge.</p>
    
    <form id="formOee">
      <!-- Section Signes Cliniques -->
      <div class="section">
        <h2>Signes cliniques</h2>
        <label>
          <input type="checkbox" name="oeeClinical" value="dysphagie">
          Dysphagie
        </label>
        <label>
          <input type="checkbox" name="oeeClinical" value="odynophagie">
          Odynophagie
        </label>
        <label>
          <input type="checkbox" name="oeeClinical" value="reflux_non_controle">
          Reflux non contrôlé
        </label>
        <label>
          <input type="checkbox" name="oeeClinical" value="douleurs_thoraciques">
          Douleurs thoraciques
        </label>
      </div>

      <!-- Section Endoscopie -->
      <div class="section">
        <h2>Résultats endoscopiques</h2>
        <label for="oeeEndoscopy">Trouvailles endoscopiques :</label>
        <select name="oeeEndoscopy" id="oeeEndoscopy">
          <option value="">-- Sélectionnez --</option>
          <option value="anneaux">Anneaux œsophagiens</option>
          <option value="exsudats">Exsudats</option>
          <option value="fissures">Fissures linéaires</option>
          <option value="strictures">Sténose</option>
          <option value="aspect_normale">Aspect normal</option>
        </select>
      </div>

      <!-- Section Histologie -->
      <div class="section">
        <h2>Résultats histologiques</h2>
        <label for="oeeHistology">Nombre d'éosinophiles par champ HPF :</label>
        <select name="oeeHistology" id="oeeHistology">
          <option value="">-- Sélectionnez --</option>
          <option value=">=15">≥15 éosinophiles</option>
          <option value="<15">&lt;15 éosinophiles</option>
        </select>
      </div>

      <!-- Section Bilan d'extension -->
      <div class="section">
        <h2>Bilan d'extension</h2>
        <label>
          <input type="checkbox" name="oeeExtension" value="atopie">
          Antécédents d'atopie (asthme, rhinite, eczéma)
        </label>
        <label>
          <input type="checkbox" name="oeeExtension" value="allergies_alimentaires">
          Allergies alimentaires connues
        </label>
        <label>
          <input type="checkbox" name="oeeExtension" value="autres_manifestations">
          Autres manifestations extra-œsophagiennes
        </label>
      </div>

      <button type="button" onclick="generateOeePlan()">Générer la conduite à tenir</button>
    </form>

    <div id="oeeResult" class="result" style="display:none;">
      <h2>Conduite à tenir suggérée :</h2>
      <div id="oeePlanText"></div>
    </div>
  </div>

  <script>
    function generateOeePlan() {
      // Récupération des valeurs sélectionnées dans le formulaire OeE
      var clinicalSigns = [];
      document.querySelectorAll('input[name="oeeClinical"]:checked').forEach(function(el) {
        clinicalSigns.push(el.value);
      });
      
      var endo = document.getElementById('oeeEndoscopy').value;
      var histo = document.getElementById('oeeHistology').value;
      
      var extension = [];
      document.querySelectorAll('input[name="oeeExtension"]:checked').forEach(function(el) {
        extension.push(el.value);
      });
      
      // Construction de la synthèse des informations
      var plan = "";
      
      // Synthèse des signes cliniques
      if(clinicalSigns.length > 0) {
        plan += "<p><strong>Signes cliniques :</strong> " + clinicalSigns.join(", ") + ".</p>";
      } else {
        plan += "<p><strong>Signes cliniques :</strong> non renseignés.</p>";
      }
      
      // Synthèse des données endoscopiques
      if(endo) {
        plan += "<p><strong>Endoscopie :</strong> " + endo.replace('_', ' ') + ".</p>";
      } else {
        plan += "<p><strong>Endoscopie :</strong> non renseignée.</p>";
      }
      
      // Synthèse des résultats histologiques
      if(histo) {
        if(histo === ">=15") {
          plan += "<p><strong>Histologie :</strong> Infiltration éosinophile significative (≥15/HPF).</p>";
        } else {
          plan += "<p><strong>Histologie :</strong> Infiltration éosinophile non significative (<15/HPF).</p>";
        }
      } else {
        plan += "<p><strong>Histologie :</strong> non renseignée.</p>";
      }
      
      // Synthèse du bilan d'extension
      if(extension.length > 0) {
        plan += "<p><strong>Bilan d'extension :</strong> Positif pour " + extension.join(", ").replace(/_/g, ' ') + ".</p>";
      } else {
        plan += "<p><strong>Bilan d'extension :</strong> négatif ou non renseigné.</p>";
      }
      
      // Algorithme décisionnel selon les recommandations SNFGE Mars 2024
      plan += "<hr>";
      
      if(histo === ">=15") {
        // Cas d'une histologie positive (diagnostic confirmé)
        if(endo === "strictures") {
          plan += "<p><strong>Recommandation :</strong> En présence de sténose associées à une infiltration éosinophile significative, la dilatation endoscopique est indiquée en association avec un traitement par corticoïdes topiques : budésonide 1 mg comprimés orodispersibles, un comprimé le matin et un comprimé le soir pendant 6 semaines. Un suivi endoscopique rapproché est recommandé.</p>";
        }
        else if(endo === "anneaux" || endo === "exsudats" || endo === "fissures") {
          if(clinicalSigns.includes("reflux_non_controle")) {
            plan += "<p><strong>Recommandation :</strong> Face à un aspect endoscopique typique (anneaux, exsudats, fissures) et en présence de reflux non contrôlé, il est suggéré d'effectuer un essai thérapeutique par PPIs pendant 8 semaines avant d'initier les corticoïdes topiques, ou de les associer si nécessaire.</p>";
          } else {
            plan += "<p><strong>Recommandation :</strong> La prise en charge de première intention repose sur un traitement par corticoïdes topiques : budésonide 1 mg comprimés orodispersibles, un comprimé le matin et un comprimé le soir pendant 6 semaines. En cas de non réponse, un essai par IPP (8 semaines) peut être envisagé.</p>";
            plan += "<p><strong>Remarque :</strong> En cas d’œsophagite à éosinophiles, il est important de souligner que, bien qu'une réduction de l’infiltration éosinophile puisse être obtenue grâce à des biothérapies ciblant l’IL‑5 (comme le mépolizumab), cela n’entraîne pas systématiquement une amélioration clinique significative, notamment concernant la dysphagie. Des traitements ciblant d'autres voies inflammatoires, tels que le dupilumab (inhibiteur des voies IL‑4/IL‑13), ont montré des bénéfices plus marqués tant sur le plan histologique que symptomatique. Cela suggère que la pathogenèse de l’œsophagite à éosinophiles est multifactorielle, et que la prise en charge doit être personnalisée en fonction de l'ensemble des données cliniques, endoscopiques et histologiques.</p>";
          }
        }
        else if(endo === "aspect_normale") {
          plan += "<p><strong>Recommandation :</strong> En l'absence de signes endoscopiques typiques malgré une infiltration histologique significative, un essai thérapeutique par IPP est envisageable, suivi d'un traitement par corticoïdes topiques en cas d'inefficacité.</p>";
        }
        else {
          plan += "<p><strong>Recommandation :</strong> En cas d'infiltration éosinophile significative sans donnée endoscopique précise, une prise en charge par corticoïdes topiques est envisageable, associée à une évaluation allergologique.</p>";
        }
        
        if(extension.includes("atopie") || extension.includes("allergies_alimentaires")) {
          plan += "<p><strong>Note complémentaire :</strong> Étant donné les antécédents allergiques ou atopiques, une évaluation allergologique complète ainsi qu'une prise en charge diététique peuvent être envisagées.</p>";
        }
      }
      else if(histo === "<15") {
        plan += "<p><strong>Recommandation :</strong> Les critères histologiques ne confirment pas un diagnostic d’OeE. Il est recommandé de poursuivre les investigations (essai thérapeutique par PPIs, surveillance clinique, et répétition de l’endoscopie si l’évolution clinique le justifie).</p>";
      }
      else {
        plan += "<p><strong>Recommandation :</strong> Les données étant incomplètes, une évaluation complémentaire est nécessaire pour confirmer le diagnostic et adapter la prise en charge.</p>";
      }
      
      document.getElementById('oeePlanText').innerHTML = plan;
      document.getElementById('oeeResult').style.display = 'block';
    }
  </script>
</div>

<!-- Module: Nutrition -->
<div id="moduleNutrition" class="module">
  <h3>Nutrition pour les Maladies Gastro-Entérologiques et le Diabète</h3>
  <form id="formNutrition">
    <!-- Informations du Patient -->
    <section class="form-section">
      <h2>Informations du Patient</h2>
      <label for="nom_prenom_nut">Nom et Prénom :</label>
      <input type="text" id="nom_prenom_nut" placeholder="Entrez le nom et prénom">
      <label for="age_nut">Âge :</label>
      <input type="number" id="age_nut" placeholder="Entrez l'âge" min="0">
      <label for="sexe_nut">Sexe :</label>
      <select id="sexe_nut">
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
      </select>
      <label for="poids_nut">Poids (kg) :</label>
      <input type="number" id="poids_nut" placeholder="Entrez le poids" min="0">
      <label for="taille_nut">Taille (cm) :</label>
      <input type="number" id="taille_nut" placeholder="Entrez la taille" min="0">
      <label for="activite_nut">Niveau d'activité physique :</label>
      <select id="activite_nut">
        <option value="sedentaire">Sédentaire</option>
        <option value="leger">Légèrement actif</option>
        <option value="modere">Modérément actif</option>
        <option value="intense">Très actif</option>
      </select>
    </section>

    <!-- Pathologies Gastro-Entérologiques -->
    <section class="form-section">
      <h2>Pathologies Gastro-Entérologiques</h2>
      <label><input type="checkbox" id="mici_nut"> Maladie Inflammatoire Chronique de l'Intestin (MICI)</label>
      <label><input type="checkbox" id="reflux_nut"> Reflux Gastro-Œsophagien (RGO)</label>
      <label><input type="checkbox" id="celiaque_nut"> Maladie Cœliaque</label>
      <label><input type="checkbox" id="colon_irritable_nut"> Syndrome du Côlon Irritable</label>
      <label><input type="checkbox" id="pancreatite_nut"> Pancréatite Chronique</label>
      <label><input type="checkbox" id="sigmoidite_nut"> Sigmoidite Diverticulaire</label>
      <label><input type="checkbox" id="prepa_coloscopie_nut"> Préparation de Coloscopie (Régime sans Résidu)</label>
    </section>

    <!-- Diabète -->
    <section class="form-section">
      <h2>Diabète</h2>
      <label><input type="checkbox" id="diabete_nut"> Diabète</label>
      <label for="type_diabete_nut">Type de diabète :</label>
      <select id="type_diabete_nut">
        <option value="type1">Type 1</option>
        <option value="type2">Type 2</option>
      </select>
    </section>

    <button type="button" onclick="calculateNutrition()">Générer la conduite à tenir</button>
  </form>

  <div id="resultNutrition" class="result"></div>

  <script>
    function calculateNutrition() {
      // Récupération des données saisies
      var nomPrenom = document.getElementById("nom_prenom_nut").value;
      var age = parseFloat(document.getElementById("age_nut").value) || 0;
      var sexe = document.getElementById("sexe_nut").value;
      var poids = parseFloat(document.getElementById("poids_nut").value) || 0;
      var taille = parseFloat(document.getElementById("taille_nut").value) || 0;
      var activite = document.getElementById("activite_nut").value;
      var mici = document.getElementById("mici_nut").checked;
      var reflux = document.getElementById("reflux_nut").checked;
      var celiaque = document.getElementById("celiaque_nut").checked;
      var colonIrritable = document.getElementById("colon_irritable_nut").checked;
      var pancreatite = document.getElementById("pancreatite_nut").checked;
      var sigmoidite = document.getElementById("sigmoidite_nut").checked;
      var prepaColoscopie = document.getElementById("prepa_coloscopie_nut").checked;
      var diabete = document.getElementById("diabete_nut").checked;
      var typeDiabete = document.getElementById("type_diabete_nut").value;

      // Calcul de l'IMC (taille en cm → conversion en m)
      var imc = (poids / Math.pow(taille / 100, 2)).toFixed(2);

      // Calcul des besoins caloriques selon la formule de Harris-Benedict
      var besoinsCaloriques = 0;
      if (sexe === "Homme") {
        besoinsCaloriques = 66 + (13.7 * poids) + (5 * taille) - (6.8 * age);
      } else {
        besoinsCaloriques = 655 + (9.6 * poids) + (1.8 * taille) - (4.7 * age);
      }

      // Ajustement en fonction du niveau d'activité physique
      switch (activite) {
        case "sedentaire":
          besoinsCaloriques *= 1.2;
          break;
        case "leger":
          besoinsCaloriques *= 1.375;
          break;
        case "modere":
          besoinsCaloriques *= 1.55;
          break;
        case "intense":
          besoinsCaloriques *= 1.725;
          break;
      }
      besoinsCaloriques = Math.round(besoinsCaloriques);

      // Construction du résumé et des conseils nutritionnels
      var plan = "<strong>Résumé Clinique :</strong><br>";
      plan += "Patient : " + nomPrenom + "<br>";
      plan += "Âge : " + age + " ans, Sexe : " + sexe + ".<br>";
      plan += "IMC : " + imc + " kg/m².<br>";
      plan += "Besoins caloriques estimés : " + besoinsCaloriques + " kcal/jour.<br>";

      plan += "<br><strong>Conseils Nutritionnels Généraux :</strong><br>";
      plan += "• Adopter une alimentation équilibrée, riche en fruits, légumes, céréales complètes et protéines maigres.<br>";
      plan += "• Limiter les graisses saturées, les sucres ajoutés et le sel.<br>";
      plan += "• Boire au moins 1,5 à 2 litres d'eau par jour.<br>";

      // Recommandations spécifiques en fonction des pathologies gastro-entérologiques
      if (mici) {
        plan += "<br><strong>Conseils pour la MICI :</strong><br>";
        plan += "• En phase de poussée : régime pauvre en fibres (éviter crudités et légumineuses).<br>";
        plan += "• En rémission : réintroduire progressivement les fibres.<br>";
        plan += "• Éviter les aliments irritants (épices, alcool, café).<br>";
        plan += "<br><strong>Menu Hebdomadaire pour la MICI :</strong><br>";
        plan += generateWeeklyMenuMICI();
      }
      if (reflux) {
        plan += "<br><strong>Conseils pour le RGO :</strong><br>";
        plan += "• Éviter les repas trop copieux et les aliments acides (agrumes, tomates).<br>";
        plan += "• Limiter les aliments gras, le café, l'alcool et les boissons gazeuses.<br>";
        plan += "• Manger lentement et éviter de se coucher immédiatement après le repas.<br>";
        plan += "<br><strong>Menu Hebdomadaire pour le RGO :</strong><br>";
        plan += generateWeeklyMenuRGO();
      }
      if (celiaque) {
        plan += "<br><strong>Conseils pour la Maladie Cœliaque :</strong><br>";
        plan += "• Adopter un régime strict sans gluten (éviter blé, orge, seigle).<br>";
        plan += "• Privilégier les aliments naturellement sans gluten (riz, quinoa, maïs).<br>";
        plan += "• Lire attentivement les étiquettes des produits transformés.<br>";
        plan += "<br><strong>Menu Hebdomadaire pour la Maladie Cœliaque :</strong><br>";
        plan += generateWeeklyMenuCeliaque();
      }
      if (colonIrritable) {
        plan += "<br><strong>Conseils pour le Syndrome du Côlon Irritable :</strong><br>";
        plan += "• Suivre un régime pauvre en FODMAPs (aliments fermentescibles).<br>";
        plan += "• Éviter les aliments déclencheurs (lait, légumineuses, aliments gras).<br>";
        plan += "• Fractionner les repas et manger lentement.<br>";
        plan += "<br><strong>Menu Hebdomadaire pour le Côlon Irritable :</strong><br>";
        plan += generateWeeklyMenuColonIrritable();
      }
      if (pancreatite) {
        plan += "<br><strong>Conseils pour la Pancréatite Chronique :</strong><br>";
        plan += "• Suivre un régime pauvre en graisses (moins de 50 g/jour).<br>";
        plan += "• Fractionner les repas (5 à 6 petits repas par jour).<br>";
        plan += "• Éviter l'alcool et le tabac.<br>";
        plan += "<br><strong>Menu Hebdomadaire pour la Pancréatite Chronique :</strong><br>";
        plan += generateWeeklyMenuPancreatite();
      }
      if (sigmoidite) {
        plan += "<br><strong>Conseils pour la Sigmoidite Diverticulaire :</strong><br>";
        plan += "• En phase de rémission : régime riche en fibres (fruits, légumes, céréales complètes).<br>";
        plan += "• En phase aiguë : régime pauvre en fibres et hydratation suffisante.<br>";
        plan += "• Éviter les aliments irritants (épices, alcool, café).<br>";
        plan += "<br><strong>Menu Hebdomadaire pour la Sigmoidite Diverticulaire :</strong><br>";
        plan += generateWeeklyMenuSigmoidite();
      }
      if (prepaColoscopie) {
        plan += "<br><strong>Conseils pour la Préparation de Coloscopie (Régime sans Résidu) :</strong><br>";
        plan += "• Éviter les aliments riches en fibres (fruits, légumes, céréales complètes).<br>";
        plan += "• Privilégier les aliments faciles à digérer (riz, pâtes, viandes maigres).<br>";
        plan += "• Boire beaucoup d'eau et suivre les instructions du médecin pour la préparation.<br>";
        plan += "<br><strong>Menu Hebdomadaire pour la Préparation de Coloscopie :</strong><br>";
        plan += generateWeeklyMenuPrepaColoscopie();
      }
      if (diabete) {
        plan += "<br><strong>Conseils pour le Diabète :</strong><br>";
        plan += "• Privilégier les glucides à index glycémique bas (légumineuses, céréales complètes).<br>";
        plan += "• Éviter les sucres rapides et les boissons sucrées.<br>";
        plan += "• Contrôler régulièrement la glycémie.<br>";
        if (typeDiabete === "type1") {
          plan += "• Adapter les doses d'insuline en fonction des repas.<br>";
        } else if (typeDiabete === "type2") {
          plan += "• Favoriser la perte de poids si nécessaire et pratiquer une activité physique régulière.<br>";
        }
        plan += "<br><strong>Menu Hebdomadaire pour le Diabète :</strong><br>";
        plan += generateWeeklyMenuDiabete();
      }

      // Affichage du résultat dans la zone dédiée
      document.getElementById("resultNutrition").innerHTML = plan;
    }

    // Fonctions de génération des menus hebdomadaires

    function generateWeeklyMenuMICI() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Flocons d'avoine (50 g), compote de pommes (100 g), yaourt nature (125 g).</li>
              <li><strong>Déjeuner :</strong> Purée de carottes (200 g), poulet vapeur (150 g), riz blanc (100 g).</li>
              <li><strong>Collation :</strong> Banane (1), amandes (30 g).</li>
              <li><strong>Dîner :</strong> Soupe de courgettes (300 ml), poisson blanc vapeur (150 g), pommes de terre bouillies (100 g).</li>
            </ul>
          </li>
          <li><strong>Mardi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Omelette aux épinards (2 œufs), pain complet (50 g), compote de poires (100 g).</li>
              <li><strong>Déjeuner :</strong> Velouté de potiron (300 ml), dinde rôtie (150 g), pâtes blanches (100 g).</li>
              <li><strong>Collation :</strong> Yaourt nature (125 g), fruits frais (100 g).</li>
              <li><strong>Dîner :</strong> Purée de patate douce (200 g), cabillaud au four (150 g), carottes cuites (100 g).</li>
            </ul>
          </li>
          <li><strong>Mercredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Riz au lait (150 g) avec une touche de cannelle.</li>
              <li><strong>Déjeuner :</strong> Bouillon de légumes clair (300 ml) avec quenelles de volaille (100 g).</li>
              <li><strong>Collation :</strong> Jus de pommes clarifié (200 ml), biscuits secs (2).</li>
              <li><strong>Dîner :</strong> Crème de riz (200 ml), blanc de poulet vapeur (100 g).</li>
            </ul>
          </li>
          <li><strong>Jeudi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Semoule fine au lait (150 g).</li>
              <li><strong>Déjeuner :</strong> Purée de pommes de terre (200 g), poisson maigre poché (120 g).</li>
              <li><strong>Collation :</strong> Compote de coings (100 g), pain blanc (40 g).</li>
              <li><strong>Dîner :</strong> Soupe de carottes (300 ml), galette de riz (2).</li>
            </ul>
          </li>
          <li><strong>Vendredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Tapioca au lait (150 g).</li>
              <li><strong>Déjeuner :</strong> Blanc de dinde grillé (150 g), riz blanc (100 g).</li>
              <li><strong>Collation :</strong> Pêche au sirop léger (100 g), biscotte (2).</li>
              <li><strong>Dîner :</strong> Velouté de courgettes (300 ml), œuf dur (1).</li>
            </ul>
          </li>
          <li><strong>Samedi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Crème d’avoine (150 g).</li>
              <li><strong>Déjeuner :</strong> Hachis de poulet (150 g), purée de panais (200 g).</li>
              <li><strong>Collation :</strong> Poire cuite (100 g), madeleine nature (1 petite).</li>
              <li><strong>Dîner :</strong> Soupe de potiron (300 ml), fromage frais allégé (60 g).</li>
            </ul>
          </li>
          <li><strong>Dimanche :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain de mie blanc (50 g) avec gelée de fruits (20 g).</li>
              <li><strong>Déjeuner :</strong> Veau haché maigre (150 g), purée de céleri rave (200 g).</li>
              <li><strong>Collation :</strong> Pomme cuite (100 g), boudoir (2).</li>
              <li><strong>Dîner :</strong> Consommé de volaille (300 ml), riz soufflé (30 g).</li>
            </ul>
          </li>
        </ul>
      `;
    }

    function generateWeeklyMenuRGO() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Flocons d'avoine (50 g), banane (1), yaourt nature (125 g).</li>
              <li><strong>Déjeuner :</strong> Poulet grillé (150 g), riz complet (100 g), haricots verts vapeur (100 g).</li>
              <li><strong>Collation :</strong> Compote de pommes (100 g), amandes (30 g).</li>
              <li><strong>Dîner :</strong> Saumon vapeur (150 g), quinoa (100 g), courgettes cuites (100 g).</li>
            </ul>
          </li>
          <li><strong>Mardi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Omelette aux épinards (2 œufs), pain complet (50 g), compote de poires (100 g).</li>
              <li><strong>Déjeuner :</strong> Dinde rôtie (150 g), patate douce (150 g), brocoli vapeur (100 g).</li>
              <li><strong>Collation :</strong> Yaourt nature (125 g), fruits frais (100 g).</li>
              <li><strong>Dîner :</strong> Soupe de légumes (300 ml), poisson blanc (150 g), riz basmati (100 g).</li>
            </ul>
          </li>
          <li><strong>Mercredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain complet (50 g) avec une fine couche de beurre.</li>
              <li><strong>Déjeuner :</strong> Salade de poulet grillé (150 g) avec laitue, concombre, carottes râpées et vinaigrette légère.</li>
              <li><strong>Collation :</strong> Poire (1) en morceaux.</li>
              <li><strong>Dîner :</strong> Omelette (2 œufs) aux légumes (courgettes, poivrons) cuite à la vapeur.</li>
            </ul>
          </li>
          <li><strong>Jeudi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Galettes de riz (2) avec purée d'amande et une demi-poire.</li>
              <li><strong>Déjeuner :</strong> Soupe de carottes (300 ml) avec pain au levain (50 g).</li>
              <li><strong>Collation :</strong> Clémentine (1).</li>
              <li><strong>Dîner :</strong> Crevettes sautées (120 g) avec nouilles de riz (100 g cuites) et poivrons rouges.</li>
            </ul>
          </li>
          <li><strong>Vendredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Œufs pochés (2) sur pain au levain grillé.</li>
              <li><strong>Déjeuner :</strong> Hachis de bœuf (150 g) avec patate douce (150 g) et carottes cuites.</li>
              <li><strong>Collation :</strong> Kiwi (1).</li>
              <li><strong>Dîner :</strong> Curry de poulet au lait de coco (sans ail ni oignon) avec riz basmati (100 g cuit) et courgettes.</li>
            </ul>
          </li>
          <li><strong>Samedi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pancakes à la farine de sarrasin (2) avec sirop d'érable (portion contrôlée).</li>
              <li><strong>Déjeuner :</strong> Burger végétarien (pain complet) avec salade et frites de patates douces au four.</li>
              <li><strong>Collation :</strong> Yaourt nature (150 g) avec graines de lin.</li>
              <li><strong>Dîner :</strong> Pizza maison (pâte complète) avec légumes variés et fromage.</li>
            </ul>
          </li>
          <li><strong>Dimanche :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Crêpes de riz (2) garnies de fruits rouges et yaourt sans lactose.</li>
              <li><strong>Déjeuner :</strong> Poisson maigre cuit au four (150 g) avec quinoa (100 g cuit) et fenouil braisé (FODMAP faible).</li>
              <li><strong>Collation :</strong> Fromage blanc 0% MG (150 g) avec melon (FODMAP faible).</li>
              <li><strong>Dîner :</strong> Soupe de potiron (300 ml) avec graines de courge.</li>
            </ul>
          </li>
        </ul>
      `;
    }

    function generateWeeklyMenuCeliaque() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain sans gluten (50 g) avec confiture sans sucre ajouté.</li>
              <li><strong>Déjeuner :</strong> Salade de quinoa (100 g cuit) avec poulet grillé (150 g) et légumes variés.</li>
              <li><strong>Collation :</strong> Amandes (30 g) et une pomme.</li>
              <li><strong>Dîner :</strong> Galettes de sarrasin (2) garnies de légumes et fromage sans lactose.</li>
            </ul>
          </li>
          <li><strong>Mardi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Porridge de sarrasin (50 g de flocons) préparé avec du lait végétal.</li>
              <li><strong>Déjeuner :</strong> Filet de poisson blanc (150 g) cuit au four avec riz basmati (100 g cuit) et brocolis vapeur.</li>
              <li><strong>Collation :</strong> Yaourt de soja nature (150 g) avec fruits rouges.</li>
              <li><strong>Dîner :</strong> Soupe de légumes sans gluten (300 ml) avec pain sans gluten.</li>
            </ul>
          </li>
          <li><strong>Mercredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Crêpes à la farine de riz (2) avec fruits frais.</li>
              <li><strong>Déjeuner :</strong> Dinde grillée (150 g) avec patates douces rôties (150 g) et salade verte.</li>
              <li><strong>Collation :</strong> Noix de cajou (30 g) et une poire.</li>
              <li><strong>Dîner :</strong> Pizza sans gluten avec légumes et mozzarella sans lactose.</li>
            </ul>
          </li>
          <li><strong>Jeudi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Muesli sans gluten (50 g) avec lait de riz et fruits secs.</li>
              <li><strong>Déjeuner :</strong> Bœuf haché (150 g) avec polenta (100 g) et haricots verts vapeur.</li>
              <li><strong>Collation :</strong> Compote de pommes sans sucre ajouté (150 g).</li>
              <li><strong>Dîner :</strong> Tortilla de maïs (2) garnies de poulet, légumes et sauce salsa maison.</li>
            </ul>
          </li>
          <li><strong>Vendredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Œufs brouillés (2) avec pain sans gluten grillé.</li>
              <li><strong>Déjeuner :</strong> Salade de pâtes sans gluten (100 g cuites) avec thon, olives et légumes.</li>
              <li><strong>Collation :</strong> Fruits secs (30 g) et un fruit de saison.</li>
              <li><strong>Dîner :</strong> Curry de légumes au lait de coco servi avec riz basmati (100 g cuit).</li>
            </ul>
          </li>
          <li><strong>Samedi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Smoothie sans gluten (lait végétal, fruits, graines de chia).</li>
              <li><strong>Déjeuner :</strong> Rôti de porc (150 g) avec pommes de terre au four et carottes glacées.</li>
              <li><strong>Collation :</strong> Fromage de chèvre frais sans lactose (60 g) avec pain sans gluten.</li>
              <li><strong>Dîner :</strong> Paella sans gluten (riz, fruits de mer, poulet, légumes).</li>
            </ul>
          </li>
          <li><strong>Dimanche :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Gaufres sans gluten (2) avec sirop d'agave et fruits rouges.</li>
              <li><strong>Déjeuner :</strong> Lasagnes sans gluten aux légumes et béchamel légère.</li>
              <li><strong>Collation :</strong> Crème dessert au chocolat sans gluten et sans lactose.</li>
              <li><strong>Dîner :</strong> Soupe de légumes variés sans gluten (300 ml) et galettes de maïs.</li>
            </ul>
          </li>
        </ul>
      `;
    }

    function generateWeeklyMenuColonIrritable() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Flocons d'avoine (30 g) avec lait d'amande et myrtilles (FODMAP faible).</li>
              <li><strong>Déjeuner :</strong> Salade de poulet grillé (120 g) avec roquette, carottes et concombre, assaisonnée d'huile d'olive (FODMAP faible).</li>
              <li><strong>Collation :</strong> Orange (1 petite).</li>
              <li><strong>Dîner :</strong> Saumon vapeur (150 g) avec riz blanc (100 g cuit) et haricots verts vapeur (FODMAP faible).</li>
            </ul>
          </li>
          <li><strong>Mardi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain au levain (50 g) avec beurre et jambon.</li>
              <li><strong>Déjeuner :</strong> Omelette (2 œufs) aux épinards et fromage de chèvre (FODMAP faible).</li>
              <li><strong>Collation :</strong> Raisins (portion modérée).</li>
              <li><strong>Dîner :</strong> Hachis de bœuf (150 g) avec patate douce (150 g) et carottes cuites (FODMAP faible).</li>
            </ul>
          </li>
          <li><strong>Mercredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Yaourt nature sans lactose (150 g) avec fraises (FODMAP faible).</li>
              <li><strong>Déjeuner :</strong> Salade de quinoa (100 g cuit) avec thon (120 g), tomates, olives et citron (FODMAP faible).</li>
              <li><strong>Collation :</strong> Banane pas trop mûre (1).</li>
              <li><strong>Dîner :</strong> Poulet rôti (150 g) avec pommes de terre vapeur (150 g) et brocolis (FODMAP faible).</li>
            </ul>
          </li>
          <li><strong>Jeudi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Galettes de riz (2) avec purée d'amande et une demi-poire.</li>
              <li><strong>Déjeuner :</strong> Soupe de carottes (300 ml) avec pain au levain (50 g).</li>
              <li><strong>Collation :</strong> Clémentine (1).</li>
              <li><strong>Dîner :</strong> Crevettes sautées (120 g) avec nouilles de riz (100 g cuites) et poivrons rouges (FODMAP faible).</li>
            </ul>
          </li>
          <li><strong>Vendredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Œufs pochés (2) sur pain au levain grillé.</li>
              <li><strong>Déjeuner :</strong> Salade composée avec lentilles germées (portion contrôlée), poulet grillé (120 g) et légumes verts, vinaigrette légère (FODMAP faible).</li>
              <li><strong>Collation :</strong> Kiwi (1).</li>
              <li><strong>Dîner :</strong> Curry de poulet au lait de coco (sans ail ni oignon) avec riz basmati (100 g cuit) et courgettes.</li>
            </ul>
          </li>
          <li><strong>Samedi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pancakes à la farine de sarrasin (2) avec sirop d'érable (portion modérée).</li>
              <li><strong>Déjeuner :</strong> Burger végétarien (pain complet) avec salade et frites de patates douces au four.</li>
              <li><strong>Collation :</strong> Yaourt nature avec graines de lin.</li>
              <li><strong>Dîner :</strong> Lasagnes végétariennes (sans ail, sans oignon) avec légumes variés et fromage léger.</li>
            </ul>
          </li>
          <li><strong>Dimanche :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Crêpes de riz (2) garnies de fruits rouges et yaourt sans lactose.</li>
              <li><strong>Déjeuner :</strong> Poisson maigre cuit au four (150 g) avec quinoa (100 g cuit) et fenouil braisé (FODMAP faible).</li>
              <li><strong>Collation :</strong> Fromage blanc 0% MG (150 g) avec melon (FODMAP faible).</li>
              <li><strong>Dîner :</strong> Soupe de potiron (300 ml) avec graines de courge et pain au levain (50 g).</li>
            </ul>
          </li>
        </ul>
      `;
    }

    function generateWeeklyMenuPancreatite() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Riz au lait écrémé (150 g) avec compote de pommes sans sucre ajouté.</li>
              <li><strong>Déjeuner :</strong> Blanc de poulet vapeur (120 g) avec purée de carottes (200 g) et riz blanc (100 g cuit).</li>
              <li><strong>Collation :</strong> Banane (1 petite) et biscuits secs (2).</li>
              <li><strong>Dîner :</strong> Soupe de légumes claire (300 ml) avec pain blanc (40 g).</li>
            </ul>
          </li>
          <li><strong>Mardi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Semoule fine au lait écrémé (150 g) avec une touche de cannelle.</li>
              <li><strong>Déjeuner :</strong> Poisson blanc poché (120 g) avec pommes de terre vapeur (150 g) et haricots verts.</li>
              <li><strong>Collation :</strong> Compote de poires (100 g) et galettes de riz (2).</li>
              <li><strong>Dîner :</strong> Velouté de courgettes (300 ml) avec quenelles de volaille (80 g).</li>
            </ul>
          </li>
          <li><strong>Mercredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Tapioca au lait écrémé (150 g).</li>
              <li><strong>Déjeuner :</strong> Dinde grillée (120 g) avec riz blanc (100 g cuit) et carottes cuites.</li>
              <li><strong>Collation :</strong> Pêche au sirop léger (100 g) égouttée et boudoirs (2).</li>
              <li><strong>Dîner :</strong> Crème de riz (200 ml) avec œuf dur (1).</li>
            </ul>
          </li>
          <li><strong>Jeudi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain de mie blanc (50 g) avec gelée de fruits (20 g) (sans matières grasses ajoutées).</li>
              <li><strong>Déjeuner :</strong> Veau haché maigre (120 g) cuit à la vapeur avec purée de pommes de terre (200 g) (sans beurre ni crème).</li>
              <li><strong>Collation :</strong> Pomme cuite (100 g) sans sucre ajouté et biscuits secs (2).</li>
              <li><strong>Dîner :</strong> Consommé de volaille dégraissé (300 ml) avec riz soufflé (30 g).</li>
            </ul>
          </li>
          <li><strong>Vendredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Crème d’avoine (150 g) préparée avec de l'eau et une touche de sirop d'agave (très limité).</li>
              <li><strong>Déjeuner :</strong> Filet de sole vapeur (120 g) avec purée de panais (200 g) (sans matières grasses ajoutées).</li>
              <li><strong>Collation :</strong> Poire cuite (100 g) et galettes de riz (2).</li>
              <li><strong>Dîner :</strong> Soupe de potiron (300 ml) (sans crème) avec fromage frais allégé (40 g).</li>
            </ul>
          </li>
          <li><strong>Samedi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Riz au lait écrémé (150 g) avec une pincée de cannelle.</li>
              <li><strong>Déjeuner :</strong> Blanc de poulet grillé (120 g) avec riz blanc (100 g cuit) et courgettes vapeur.</li>
              <li><strong>Collation :</strong> Compote de pommes (100 g) et pain blanc (40 g).</li>
              <li><strong>Dîner :</strong> Soupe de carottes (300 ml) avec quenelles de volaille (80 g).</li>
            </ul>
          </li>
          <li><strong>Dimanche :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Semoule fine au lait écrémé (150 g) avec une cuillère de miel (très limité).</li>
              <li><strong>Déjeuner :</strong> Poisson maigre poché (120 g) avec purée de pommes de terre (200 g) (sans matières grasses ajoutées) et haricots verts.</li>
              <li><strong>Collation :</strong> Poire cuite (100 g) et biscuits secs (2).</li>
              <li><strong>Dîner :</strong> Velouté de légumes (300 ml) (carottes, courgettes, pommes de terre) avec fromage frais allégé (40 g).</li>
            </ul>
          </li>
        </ul>
      `;
    }

    function generateWeeklyMenuSigmoidite() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain complet (50 g) avec confiture de fruits rouges et un yaourt nature.</li>
              <li><strong>Déjeuner :</strong> Salade composée (laitue, tomates, concombre) avec poulet grillé (150 g) et vinaigrette légère.</li>
              <li><strong>Collation :</strong> Une poignée d'amandes et une orange.</li>
              <li><strong>Dîner :</strong> Poisson au four (150 g) avec quinoa (100 g cuit) et légumes vapeur (carottes, brocolis).</li>
            </ul>
          </li>
          <li><strong>Mardi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Muesli complet (50 g) avec fruits frais et lait d'amande.</li>
              <li><strong>Déjeuner :</strong> Soupe de légumes maison (300 ml) avec pain complet (50 g) et fromage frais.</li>
              <li><strong>Collation :</strong> Une pomme et quelques noix.</li>
              <li><strong>Dîner :</strong> Dinde rôtie (150 g) avec patates douces (150 g) et haricots verts.</li>
            </ul>
          </li>
          <li><strong>Mercredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain complet (50 g) avec avocat et œuf poché.</li>
              <li><strong>Déjeuner :</strong> Salade de lentilles (100 g cuites) avec légumes crus (carottes râpées, concombre) et vinaigrette légère.</li>
              <li><strong>Collation :</strong> Un yaourt grec nature avec des fruits rouges.</li>
              <li><strong>Dîner :</strong> Pâtes complètes (100 g cuites) avec sauce tomate maison et légumes (courgettes, aubergines).</li>
            </ul>
          </li>
          <li><strong>Jeudi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Porridge d'avoine (50 g) préparé avec de l'eau ou du lait et garni de fruits frais.</li>
              <li><strong>Déjeuner :</strong> Poisson grillé (150 g) avec riz complet (100 g cuit) et légumes grillés (poivrons, courgettes).</li>
              <li><strong>Collation :</strong> Une banane et quelques noisettes.</li>
              <li><strong>Dîner :</strong> Quiche aux légumes (avec pâte complète) et salade verte.</li>
            </ul>
          </li>
          <li><strong>Vendredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Smoothie aux fruits et graines de chia.</li>
              <li><strong>Déjeuner :</strong> Salade de quinoa (100 g cuit) avec pois chiches (portion contrôlée), légumes et vinaigrette à l'huile d'olive.</li>
              <li><strong>Collation :</strong> Une poire et quelques amandes.</li>
              <li><strong>Dîner :</strong> Curry de légumes avec riz complet et pain naan complet.</li>
            </ul>
          </li>
          <li><strong>Samedi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain complet (50 g) avec beurre de cacahuète et banane.</li>
              <li><strong>Déjeuner :</strong> Burger végétarien (pain complet) avec salade et frites de patates douces au four.</li>
              <li><strong>Collation :</strong> Un yaourt nature avec des graines de lin.</li>
              <li><strong>Dîner :</strong> Pizza maison (pâte complète) avec légumes variés et fromage.</li>
            </ul>
          </li>
          <li><strong>Dimanche :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Crêpes complètes (2) avec fruits frais et un peu de sirop d'érable.</li>
              <li><strong>Déjeuner :</strong> Rôti de poulet (150 g) avec pommes de terre rôties et légumes de saison.</li>
              <li><strong>Collation :</strong> Fromage blanc 0% MG avec des fruits et des noix.</li>
              <li><strong>Dîner :</strong> Soupe de légumes consistante et pain complet.</li>
            </ul>
          </li>
        </ul>
      `;
    }

    function generateWeeklyMenuPrepaColoscopie() {
      return `
        <ul>
          <li><strong>Lundi (3 jours avant coloscopie) :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Thé ou café léger, pain blanc (grillé ou non) avec gelée de coing sans morceaux.</li>
              <li><strong>Déjeuner :</strong> Bouillon de poule filtré, riz blanc bien cuit avec filet de poulet grillé sans peau.</li>
              <li><strong>Collation :</strong> Jus de pommes filtré et biscuits secs type boudoirs.</li>
              <li><strong>Dîner :</strong> Soupe de légumes filtrée (carottes, pommes de terre) sans morceaux, poisson blanc vapeur.</li>
            </ul>
          </li>
          <li><strong>Mardi (2 jours avant coloscopie) :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Café ou thé clair, biscottes avec un peu de miel clair.</li>
              <li><strong>Déjeuner :</strong> Bouillon de légumes filtré, pâtes blanches bien cuites avec jambon blanc (sans couenne ni gras).</li>
              <li><strong>Collation :</strong> Boisson claire (eau, thé clair) et gelée de fruits sans morceaux.</li>
              <li><strong>Dîner :</strong> Soupe claire (bouillon de volaille) avec riz blanc très cuit, œuf dur (sans le jaune).</li>
            </ul>
          </li>
          <li><strong>Mercredi (1 jour avant coloscopie) :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Thé clair ou eau, pain blanc (grillé) avec une fine couche de beurre.</li>
              <li><strong>Déjeuner :</strong> Bouillon clair, quenelles de volaille (sans peau) ou poisson blanc maigre vapeur.</li>
              <li><strong>Collation :</strong> Boissons claires à volonté (eau, bouillon clair, jus de fruits filtrés sans pulpe, thé clair, café clair sans lait), sorbet à base d'eau (citron).</li>
              <li><strong>Dîner :</strong> Liquide clair uniquement : bouillon clair, eau, thé clair, jus de pommes filtré.</li>
            </ul>
          </li>
          <li><strong>Jeudi (Jour de la coloscopie) :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Liquide clair uniquement (eau, thé clair, bouillon clair, jus de pommes filtré). Respectez les consignes de jeûne de votre médecin.</li>
              <li><strong>Déjeuner :</strong> Jeûne (seuls les liquides clairs autorisés par votre médecin).</li>
              <li><strong>Collation :</strong> Jeûne.</li>
              <li><strong>Dîner :</strong> Reprise progressive de l'alimentation après la coloscopie (bouillon, compote).</li>
            </ul>
          </li>
          <li><strong>Vendredi (Reprise progressive) :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain blanc avec un peu de beurre et confiture sans morceaux, thé léger.</li>
              <li><strong>Déjeuner :</strong> Purée de pommes de terre, poisson blanc vapeur, compote de pommes.</li>
              <li><strong>Collation :</strong> Yaourt nature sans morceaux.</li>
              <li><strong>Dîner :</strong> Soupe de légumes mixée (carottes, courgettes, pommes de terre) et riz blanc.</li>
            </ul>
          </li>
          <li><strong>Samedi (Reprise progressive) :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Biscottes avec un peu de miel, boisson chaude.</li>
              <li><strong>Déjeuner :</strong> Pâtes blanches, poulet grillé haché, légumes bien cuits (carottes, haricots verts).</li>
              <li><strong>Collation :</strong> Fruit mûr et pelé (pêche).</li>
              <li><strong>Dîner :</strong> Soupe de légumes avec vermicelles, omelette bien cuite.</li>
            </ul>
          </li>
          <li><strong>Dimanche (Retour à une alimentation normale) :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Alimentation habituelle en privilégiant les fibres douces.</li>
              <li><strong>Déjeuner :</strong> Réintroduction progressive des crudités et légumes riches en fibres.</li>
              <li><strong>Collation :</strong> Fruit frais, yaourt.</li>
              <li><strong>Dîner :</strong> Repas normal et équilibré.</li>
            </ul>
          </li>
        </ul>
      `;
    }

    function generateWeeklyMenuDiabete() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain complet (50 g) avec fromage frais allégé et quelques crudités (concombre, tomate).</li>
              <li><strong>Déjeuner :</strong> Salade composée (laitue, haricots verts, œufs durs) avec poulet grillé (150 g) et vinaigrette légère à l'huile d'olive.</li>
              <li><strong>Collation :</strong> Amandes (30 g) et une pomme.</li>
              <li><strong>Dîner :</strong> Poisson vapeur (150 g) avec quinoa (100 g cuit) et légumes verts (brocolis, épinards).</li>
            </ul>
          </li>
          <li><strong>Mardi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Yaourt grec nature (150 g) avec fruits rouges et quelques noix.</li>
              <li><strong>Déjeuner :</strong> Soupe de légumes maison (300 ml) (en limitant les pommes de terre) et pain complet (50 g).</li>
              <li><strong>Collation :</strong> Poire et quelques noisettes.</li>
              <li><strong>Dîner :</strong> Dinde rôtie (150 g) avec lentilles (100 g cuites) et carottes vapeur.</li>
            </ul>
          </li>
          <li><strong>Mercredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Omelette (2 œufs) aux légumes (poivrons, champignons) et pain complet (50 g).</li>
              <li><strong>Déjeuner :</strong> Salade de thon au naturel (120 g) avec légumes variés (salade, tomates, concombre) et vinaigrette légère.</li>
              <li><strong>Collation :</strong> Fromage blanc 0% MG (150 g) avec quelques fruits rouges.</li>
              <li><strong>Dîner :</strong> Hachis parmentier à la patate douce et bœuf maigre.</li>
            </ul>
          </li>
          <li><strong>Jeudi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Porridge d'avoine (50 g) préparé avec de l'eau ou du lait d'amande et garni de graines de chia.</li>
              <li><strong>Déjeuner :</strong> Poisson grillé (150 g) avec riz complet (100 g cuit) et légumes verts (haricots, courgettes).</li>
              <li><strong>Collation :</strong> Noix (30 g) et un fruit à faible IG (pêche, cerise).</li>
              <li><strong>Dîner :</strong> Curry de légumes avec une petite portion de riz complet et pain complet (50 g).</li>
            </ul>
          </li>
          <li><strong>Vendredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain complet (50 g) avec avocat et œuf dur.</li>
              <li><strong>Déjeuner :</strong> Salade de poulet grillé (150 g) avec quinoa (100 g cuit), légumes et vinaigrette légère.</li>
              <li><strong>Collation :</strong> Yaourt nature avec quelques amandes effilées.</li>
              <li><strong>Dîner :</strong> Pizza maison (pâte complète) avec beaucoup de légumes, poulet et fromage allégé.</li>
            </ul>
          </li>
          <li><strong>Samedi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Crêpes de sarrasin (2) avec fromage frais et fines herbes.</li>
              <li><strong>Déjeuner :</strong> Rôti de veau maigre (150 g) avec légumes rôtis (poivrons, courgettes, oignons) et une petite portion de pommes de terre (100 g).</li>
              <li><strong>Collation :</strong> Fromage blanc 0% MG (150 g) saupoudré de cannelle.</li>
              <li><strong>Dîner :</strong> Soupe de légumes consistante (pois cassés, légumes verts) et pain complet (50 g).</li>
            </ul>
          </li>
          <li><strong>Dimanche :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Muesli sans sucres ajoutés (50 g) avec lait végétal et fruits frais.</li>
              <li><strong>Déjeuner :</strong> Lasagnes végétariennes (pâte complète, béchamel légère, légumes variés).</li>
              <li><strong>Collation :</strong> Quelques noix et un fruit frais.</li>
              <li><strong>Dîner :</strong> Salade composée avec œuf poché, légumes verts et pain complet.</li>
            </ul>
          </li>
        </ul>
      `;
    }
  </script>
</div>

  <!-- Module: Colopathie fonctionnelle -->
  <div id="moduleColopathie" class="module">
    <h3>Colopathie fonctionnelle</h3>
    <form id="formColopathie">
      <section class="form-section">
        <h2>Informations Cliniques</h2>
        <label for="typeSymptomes">Type de symptômes :</label>
        <select id="typeSymptomes">
          <option value="diarree">Diarrhée prédominante</option>
          <option value="constipation">Constipation prédominante</option>
          <option value="mixte">Symptômes mixtes</option>
        </select>
        <label for="duree">Durée des symptômes :</label>
        <select id="duree">
          <option value="moins6">Moins de 6 mois</option>
          <option value="6_12">Entre 6 et 12 mois</option>
          <option value="plus1">Plus d'un an</option>
        </select>
        <label>
          <input type="checkbox" id="alerte">
          Présence de signes d'alerte (sang dans les selles, amaigrissement, fièvre, etc.)
        </label>
      </section>
      <!-- (Les autres sections de ce module, comme l'examen clinique, antécédents digestifs et familiaux, sont ajoutées ici exactement comme dans la page originale) -->
      <section class="form-section">
        <h2>Examen clinique</h2>
        <label><input type="checkbox" id="exam_douleur"> Douleur à la palpation abdominale</label>
        <label><input type="checkbox" id="exam_distension"> Distension abdominale</label>
        <label><input type="checkbox" id="exam_fievre"> Fièvre</label>
        <label><input type="checkbox" id="exam_dehydratation"> Signes de déshydratation</label>
        <label for="exam_autres">Autres signes cliniques (précisez) :</label>
        <textarea id="exam_autres" rows="2" placeholder="Décrivez ici"></textarea>
      </section>
      <section class="form-section">
        <h2>Antécédents digestifs</h2>
        <label><input type="checkbox" id="antec_gastrite"> Gastrite</label>
        <label><input type="checkbox" id="antec_ulcere"> Ulcère</label>
        <label><input type="checkbox" id="antec_mici"> MICI</label>
        <label for="antec_autres">Autres antécédents digestifs (précisez) :</label>
        <textarea id="antec_autres" rows="2" placeholder="Décrivez ici"></textarea>
      </section>
      <section class="form-section">
        <h2>Antécédents familiaux</h2>
        <label>
          <input type="checkbox" id="antFam">
          Présence d'antécédents familiaux de cancer digestif
        </label>
        <label for="antFamDetails">Si oui, précisez :</label>
        <textarea id="antFamDetails" rows="2" placeholder="Décrivez ici"></textarea>
      </section>
      <button type="button" onclick="calculateManagementColopathie()">Générer la conduite à tenir</button>
    </form>
    <div id="resultColopathie"></div>
    <script>
      function calculateManagementColopathie() {
        // Exemple simplifié de calcul pour la colopathie fonctionnelle
        var typeSymptomes = document.getElementById("typeSymptomes").value;
        var duree = document.getElementById("duree").value;
        var alerte = document.getElementById("alerte").checked;
        var plan = "";
        if (alerte) {
          plan += "Présence de signes d'alerte : investigation complémentaire urgente (coloscopie, imagerie) nécessaire.";
        } else {
          if (typeSymptomes === "diarree") {
            plan += "Traitement symptomatique pour diarrhée (Loperamide, antispasmodiques) et conseils diététiques (régime pauvre en FODMAP).";
          } else if (typeSymptomes === "constipation") {
            plan += "Traitement pour constipation (polyéthylène glycol, fibres) et conseils sur l'hydratation et l'activité physique.";
          } else if (typeSymptomes === "mixte") {
            plan += "Approche multimodale adaptée aux symptômes mixtes : traitement antispasmodique et régulation du transit.";
          }
        }
        plan += "<br>Ordonnance type : Paracétamol 500 mg 1 comprimé 3-4 fois par jour, antispasmodique (Mébévérine 200 mg, 1 comprimé trois fois par jour).<br>";
        plan += "Conseils : alimentation équilibrée, hydratation, activité physique, suivi régulier.";
        plan += " Explorations complémentaires : endoscopie digestive et/ou imagerie abdominale selon le contexte clinique.";
        document.getElementById("resultColopathie").innerHTML = plan;
      }
    </script>
  </div>
  
  <!-- Module: Pancréatite chronique -->
  <div id="modulePancreatiteChro" class="module">
    <h3>Pancréatite chronique</h3>
    <form id="formPancreatiteChro">
      <section class="form-section">
        <h2>Informations Cliniques</h2>
        <label for="douleur">Intensité de la douleur :</label>
        <select id="douleur">
          <option value="legere">Légère</option>
          <option value="moderee">Modérée</option>
          <option value="severe">Sévère</option>
        </select>
        <label>
          <input type="checkbox" id="stearoree">
          Présence de stéatorrhée
        </label>
        <label>
          <input type="checkbox" id="diabete">
          Présence de diabète ou trouble de la glycémie
        </label>
        <label>
          <input type="checkbox" id="alcoolisme">
          Antécédents d'alcoolisme actif ou récent
        </label>
        <label for="duree">Durée de la maladie :</label>
        <select id="duree">
          <option value="moins1">Moins d'un an</option>
          <option value="1_5">Entre 1 et 5 ans</option>
          <option value="plus5">Plus de 5 ans</option>
        </select>
        <label>
          <input type="checkbox" id="pseudokyste">
          Présence d'un pseudokyste à l'imagerie
        </label>
      </section>
      <button type="button" onclick="calculateManagementPancreatiteChro()">Générer la conduite à tenir</button>
    </form>
    <div id="resultPancreatiteChro"></div>
    <script>
      function calculateManagementPancreatiteChro() {
        var douleur = document.getElementById("douleur").value;
        var stearoree = document.getElementById("stearoree").checked;
        var diabete = document.getElementById("diabete").checked;
        var alcoolisme = document.getElementById("alcoolisme").checked;
        var duree = document.getElementById("duree").value;
        var pseudokyste = document.getElementById("pseudokyste").checked;
        var plan = "Mesures hygiéno-diététiques générales : régime pauvre en graisses, fractionnement des repas, arrêt de l'alcool.<br>";
        if (douleur === "legere") {
          plan += "<strong>Douleur légère :</strong> Antispasmodiques et analgésie légère (Paracétamol).<br>";
        } else if (douleur === "moderee") {
          plan += "<strong>Douleur modérée :</strong> Antispasmodiques et analgésiques de palier 2.<br>";
        } else if (douleur === "severe") {
          plan += "<strong>Douleur sévère :</strong> Analgésie opioïde et évaluation spécialisée en douleur.<br>";
        }
        if (stearoree) {
          plan += "<strong>Insuffisance pancréatique :</strong> Mise en place d'une thérapie par enzymes pancréatiques (ex. Pancréaze 25 000 UI : 1-2 capsules avec les repas, 1 capsule en collation).<br>";
        }
        if (diabete) {
          plan += "<strong>Diabète :</strong> Optimisation du contrôle glycémique.<br>";
        }
        if (alcoolisme) {
          plan += "<strong>Alcoolisme :</strong> Conseiller une abstinence complète et suivi addictologique.<br>";
        }
        if (duree === "plus5") {
          plan += "<strong>Suivi à long terme :</strong> Bilan régulier de la fonction pancréatique et surveillance des complications.<br>";
        }
        if (pseudokyste) {
          plan += "<strong>Pseudokyste :</strong> Évaluation complémentaire par imagerie et prise en charge endoscopique ou chirurgicale si symptomatique.<br>";
        }
        plan += "<br><strong>Conseils complémentaires :</strong> Hydratation, régime équilibré, activité physique, suivi régulier en gastro-entérologie.";
        document.getElementById("resultPancreatiteChro").innerHTML = plan;
      }
    </script>
  </div>
  
  <!-- Module: Pancréatite aiguë -->
  <div id="modulePancreatiteAigu" class="module">
    <h3>Pancréatite aiguë</h3>
    <form id="formPancreatiteAigu">
      <section class="form-section">
        <h2>Critères de sévérité</h2>
        <label><input type="checkbox" id="ta"> Tension artérielle anormale</label>
        <label><input type="checkbox" id="pouls"> Tachycardie</label>
        <label><input type="checkbox" id="temp"> Fièvre</label>
        <label><input type="checkbox" id="hb"> Baisse de l'hémoglobine</label>
        <label><input type="checkbox" id="wbc"> Hyperleucocytose</label>
        <label><input type="checkbox" id="creatinine"> Créatinine élevée</label>
        <label><input type="checkbox" id="lipase"> Lipasémie très élevée</label>
        <label><input type="checkbox" id="sato2"> Saturation en O₂ basse</label>
      </section>
      <button type="button" onclick="calculateManagementPancreatiteAigu()">Générer la conduite à tenir</button>
    </form>
    <div id="resultPancreatiteAigu"></div>
    <script>
      function calculateManagementPancreatiteAigu() {
        var severe = document.getElementById("ta").checked || document.getElementById("creatinine").checked || document.getElementById("sato2").checked;
        var moderate = document.getElementById("pouls").checked || document.getElementById("temp").checked || document.getElementById("hb").checked || document.getElementById("wbc").checked || document.getElementById("lipase").checked;
        var plan = "";
        if (severe) {
          plan += "<strong>Pancréatite aiguë sévère :</strong><br>";
          plan += "Admission en réanimation, hydratation IV agressive, support hémodynamique et monitorage continu.<br>";
        } else if (moderate) {
          plan += "<strong>Pancréatite aiguë modérée :</strong><br>";
          plan += "Hospitalisation en unité de surveillance rapprochée, hydratation IV, contrôle de la douleur, support nutritionnel précoce.<br>";
        } else {
          plan += "<strong>Pancréatite aiguë légère :</strong><br>";
          plan += "Prise en charge conservatrice en ambulatoire ou hospitalisation courte (hydratation, analgésie, NPO initial, reprise progressive de l'alimentation).<br>";
        }
        document.getElementById("resultPancreatiteAigu").innerHTML = plan;
      }
    </script>
  </div>
  
<!-- Module: Tumeurs neuroendocrines du pancréas -->
<div id="moduleNeuroendocrinePancreas" class="module">
  <h3>Tumeurs neuroendocrines du pancréas</h3>
  <form id="formNeuroendocrinePancreas">
    <section class="form-section">
      <h2>Caractéristiques tumorales</h2>
      <div class="input-group">
        <label for="localisation_net">Localisation :</label>
        <select id="localisation_net" required>
          <option value="">--Sélectionner--</option>
          <option value="tete">Tête</option>
          <option value="corps">Corps</option>
          <option value="queue">Queue</option>
        </select>
      </div>
      <div class="input-group">
        <label for="taille_net">Taille de la tumeur (cm) :</label>
        <input type="number" id="taille_net" min="0" step="0.1" placeholder="Ex: 2.5" required>
      </div>
      <div class="input-group">
        <label for="fonctionnelle">Tumeur fonctionnelle ?</label>
        <select id="fonctionnelle" required>
          <option value="">--Sélectionner--</option>
          <option value="oui">Oui</option>
          <option value="non">Non</option>
        </select>
      </div>
      <div class="input-group">
        <label for="grade_net">Grade (Ki-67) :</label>
        <select id="grade_net" required>
          <option value="">--Sélectionner--</option>
          <option value="G1">G1 (Ki-67 &lt; 3%)</option>
          <option value="G2">G2 (Ki-67 3-20%)</option>
          <option value="G3">G3 (Ki-67 &gt; 20%)</option>
        </select>
      </div>
    </section>
    
    <section class="form-section">
      <h2>Stadification (TNM AJCC 8<sup>ème</sup> édition)</h2>
      <div class="input-group">
        <label for="T_net">T :</label>
        <select id="T_net" required>
          <option value="">--Sélectionner--</option>
          <option value="T1">T1</option>
          <option value="T2">T2</option>
          <option value="T3">T3</option>
          <option value="T4">T4</option>
        </select>
      </div>
      <div class="input-group">
        <label for="N_net">N :</label>
        <select id="N_net" required>
          <option value="">--Sélectionner--</option>
          <option value="N0">N0</option>
          <option value="N1">N1</option>
        </select>
      </div>
      <div class="input-group">
        <label for="M_net">M :</label>
        <select id="M_net" required>
          <option value="">--Sélectionner--</option>
          <option value="M0">M0</option>
          <option value="M1">M1</option>
        </select>
      </div>
    </section>
    
    <section class="form-section">
      <h2>Évaluation biologique</h2>
      <div class="input-group">
        <label for="chromogranine">Chromogranine A (ng/mL) :</label>
        <input type="number" id="chromogranine" min="0" step="0.1" placeholder="Ex: 100">
      </div>
    </section>
    
    <button type="button" onclick="calculateNeuroendocrine()">Générer les recommandations</button>
  </form>
  
  <div id="resultNeuroendocrine" class="recommendation-box">
    <!-- Les recommandations générées apparaîtront ici -->
  </div>
  
  <script>
    function calculateNeuroendocrine() {
      const localisation = document.getElementById('localisation_net').value;
      const taille = parseFloat(document.getElementById('taille_net').value);
      const fonctionnelle = document.getElementById('fonctionnelle').value;
      const grade = document.getElementById('grade_net').value;
      const T = document.getElementById('T_net').value;
      const N = document.getElementById('N_net').value;
      const M = document.getElementById('M_net').value;
      const chromogranine = document.getElementById('chromogranine').value;
      
      let recommendation = '<h3>Stratégie thérapeutique</h3>';
      
      // Maladie localisée (M0)
      if (M === 'M0') {
        recommendation += '<p><strong>Maladie localisée :</strong><br>';
        // Pour les tumeurs bien différenciées (G1, G2) resectables en l'absence d'envahissement lymphatique
        if ((grade === 'G1' || grade === 'G2') && N === 'N0') {
          recommendation += '- Résection chirurgicale recommandée :<br>';
          recommendation += '<ul>';
          if (localisation === 'tete') {
            recommendation += '<li><strong>Pancréaticoduodénectomie (Whipple) :</strong> pour les tumeurs de la tête du pancréas</li>';
          } else {
            recommendation += '<li><strong>Pancréatectomie partielle :</strong> adaptée pour les tumeurs du corps ou de la queue</li>';
          }
          recommendation += '</ul>';
          // Pour les NET fonctionnelles, associer un traitement symptomatique
          if (fonctionnelle === 'oui') {
            recommendation += '- En complément, traitement par analogues de la somatostatine (ex: Octréotide LAR 30 mg IM tous les 28 jours) pour contrôler la sécrétion hormonale<br>';
          }
        } else {
          // Pour les tumeurs de haut grade ou localement avancées
          recommendation += '- Pour les tumeurs de haut grade (G3) ou présentant une extension locale, envisager une approche multimodale incluant un traitement néoadjuvant ou systémique<br>';
          if (grade === 'G3') {
            recommendation += '<ul>';
            recommendation += '<li><strong>Chimiothérapie type Cisplatine + Étoposide :</strong> Cisplatine 25 mg/m² IV (jours 1-3) et Étoposide 100 mg/m² IV (jours 1-3), répétés toutes les 3 semaines</li>';
            recommendation += '</ul>';
          }
        }
        recommendation += '</p>';
      }
      // Maladie métastatique (M1)
      else if (M === 'M1') {
        recommendation += '<p><strong>Maladie métastatique :</strong><br>';
        // Pour les NET bien différenciées
        if (grade === 'G1' || grade === 'G2') {
          recommendation += '- Traitement systémique recommandé :<br>';
          recommendation += '<ul>';
          recommendation += '<li><strong>Analogues de la somatostatine :</strong> Octréotide LAR 30 mg IM tous les 28 jours ou Lanréotide 120 mg IM tous les 28 jours</li>';
          recommendation += '<li><strong>Ciblage moléculaire :</strong> Everolimus 10 mg/j ou Sunitinib 37.5 mg/j peuvent être envisagés</li>';
          recommendation += '<li><strong>PRRT :</strong> (Thérapie par radionucléides) en cas de récepteurs somatotropes positifs</li>';
          recommendation += '</ul>';
        } else {
          // Pour les tumeurs mal différenciées (NEC)
          recommendation += '- Pour les NET mal différenciées (G3), privilégier une chimiothérapie à base de platine :<br>';
          recommendation += '<ul>';
          recommendation += '<li><strong>Cisplatine + Étoposide :</strong> Cisplatine 25 mg/m² (jours 1-3) et Étoposide 100 mg/m² (jours 1-3), toutes les 3 semaines</li>';
          recommendation += '</ul>';
        }
        recommendation += '</p>';
      }
      
      // Points clés
      recommendation += '<div class="alert">';
      recommendation += '<h4>Points clés :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Le grading (basé sur le Ki-67) est déterminant pour orienter la stratégie thérapeutique.</li>';
      recommendation += '<li>La résection est la pierre angulaire pour les tumeurs localisées et resectables.</li>';
      recommendation += '<li>Les analogues de la somatostatine sont essentiels pour contrôler les symptômes des tumeurs fonctionnelles.</li>';
      recommendation += '<li>La prise en charge des tumeurs mal différenciées (G3) repose sur une chimiothérapie à base de platine.</li>';
      recommendation += '<li>La discussion multidisciplinaire est indispensable pour adapter le traitement.</li>';
      recommendation += '</ul></div>';
      
      // Essais cliniques
      recommendation += '<div class="clinical-trials">';
      recommendation += '<h4>Essais cliniques pertinents :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>CLARINET Study pour le traitement par Lanréotide</li>';
      recommendation += '<li>RADIANT Trials pour l\'Everolimus</li>';
      recommendation += '</ul></div>';
      
      // Suivi et surveillance
      recommendation += '<div class="follow-up">';
      recommendation += '<h4>Suivi et calendrier de surveillance :</h4>';
      recommendation += '<ul>';
      recommendation += '<li>Consultations cliniques et dosage de la Chromogranine A tous les 3 à 6 mois</li>';
      recommendation += '<li>Imagerie (scanner ou IRM) tous les 6 mois pour évaluer la réponse thérapeutique</li>';
      recommendation += '</ul></div>';
      
      // Références
      recommendation += '<div class="references">';
      recommendation += '<h4>Références :</h4>';
      recommendation += '<ul>';
      recommendation += '<li></li>';
      recommendation += '<li>NCCN Guidelines Pancreatic Neuroendocrine Tumors 2024</li>';
      recommendation += '<li>ESMO Guidelines 2023</li>';
      recommendation += '</ul></div>';
      
      document.getElementById('resultNeuroendocrine').innerHTML = recommendation;
    }
  </script>
</div>

  <!-- Module: Prise en charge d'un kyste pancréatique de découverte fortuite -->
<div id="modulePancreaticCyst" class="module">
  <h3>Prise en charge d'un kyste pancréatique</h3>
  
  <form id="formPancreaticCyst">
    <!-- Section 1 : Informations Patient -->
    <section class="form-section">
      <h3>Informations Patient</h3>
      <label for="pc_age">Âge :</label>
      <input type="number" id="pc_age" placeholder="Entrez l'âge" min="0" required>
      
      <label for="pc_sexe">Sexe :</label>
      <select id="pc_sexe" required>
        <option value="">--Sélectionner--</option>
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
      </select>
      <div class="error-message" data-error-for="pc_sexe" style="display:none; color:red;">
        Veuillez sélectionner un sexe.
      </div>
    </section>
    
    <!-- Section 2 : Caractéristiques du Kyste Pancréatique -->
    <section class="form-section">
      <h3>Caractéristiques du kyste</h3>
      
      <label for="cyst_size">Taille (mm) :</label>
      <input type="number" id="cyst_size" placeholder="Ex. 30" min="0">
      
      <label for="cyst_location">Localisation :</label>
      <select id="cyst_location">
        <option value="">--Localisation--</option>
        <option value="tete">Tête du pancréas</option>
        <option value="corps">Corps du pancréas</option>
        <option value="queue">Queue du pancréas</option>
        <option value="diffus">Lésions multiples diffuses</option>
      </select>
      <br>
      
      <label for="cyst_img">Modalités d'imagerie :</label>
      <select id="cyst_img">
        <option value="">--Sélectionner--</option>
        <option value="TDM">TDM</option>
        <option value="IRM">IRM</option>
        <option value="EE">Échoendoscopie</option>
      </select>
      <br><br>
      
      <!-- Nouveaux champs spécifiques -->
      <label for="ca19_9">CA 19-9 (ng/ml) :</label>
      <input type="number" id="ca19_9" placeholder="Ex. 35" step="any">
      <br>
      
      <label for="cyst_cytology">Cytologie :</label>
      <select id="cyst_cytology">
        <option value="">--Sélectionner--</option>
        <option value="non_realisee">Non réalisée</option>
        <option value="negative">Négative</option>
        <option value="indeterminee">Indéterminée</option>
        <option value="positive">Positive</option>
      </select>
      <br>
      
      <label for="cyst_glucose">Glucose intra-kystique (g/l) :</label>
      <input type="number" id="cyst_glucose" placeholder="Ex. 0.4" step="any">
      <br>
      
      <label for="cyst_mucinous">Nature du kyste :</label>
      <select id="cyst_mucinous">
        <option value="">--Sélectionner--</option>
        <option value="mucineuse">Mucineuse</option>
        <option value="non_mucineuse">Non mucineuse</option>
        <option value="indeterminee">Indéterminée</option>
      </select>
      <br><br>
      
      <!-- Facteurs de risque -->
      <h4>Facteurs de Risque</h4>
      <label><input type="checkbox" id="fr_mainDuct"> Dilatation du canal pancréatique principal > 10 mm</label><br>
      <label><input type="checkbox" id="fr_mainDuct_5_10"> Dilatation du CPP 5-10 mm</label><br>
      <label><input type="checkbox" id="fr_csOver4"> Kyste des canaux secondaires > 40 mm</label><br>
      <label><input type="checkbox" id="fr_noduleOver5"> Nodule mural > 5 mm (prise de contraste)</label><br>
      <label><input type="checkbox" id="fr_noduleUnder5"> Nodule mural < 5 mm (prise de contraste)</label><br>
      <label><input type="checkbox" id="fr_jaundice"> Ictère obstructif lié au kyste</label><br>
      <label><input type="checkbox" id="fr_pancreatitis"> Pancréatite aiguë liée au kyste</label><br>
      <label><input type="checkbox" id="fr_diabDeNovo"> Diabète de novo</label><br>
      <label><input type="checkbox" id="fr_ca19High"> CA 19-9 élevé</label><br>
      <label><input type="checkbox" id="fr_cytologyPos"> Cytologie positive (DHG/Cancer)</label><br>
    </section>

    <!-- Section 3 : Symptomatologie -->
    <section class="form-section">
      <h3>Symptomatologie</h3>
      <label><input type="checkbox" id="pc_asymptomatic"> Asymptomatique (découverte fortuite)</label><br>
      <label><input type="checkbox" id="pc_pain"> Douleurs épigastriques</label><br>
      <label><input type="checkbox" id="pc_weightLoss"> Perte de poids</label><br>
      <label><input type="checkbox" id="pc_acutePancreatitis"> Épisode récent de pancréatite aiguë</label><br>
      <label for="pc_otherSymptoms">Autres symptômes (précisez) :</label><br>
      <textarea id="pc_otherSymptoms" rows="2" placeholder="Décrivez ici"></textarea>
    </section>

    <button type="button" onclick="generateCystPlan()">Générer la conduite à tenir</button>
  </form>

  <div id="resultCyst" class="result"></div>
</div>

<script>
function validateRequiredFields() {
  let valid = true;
  const ageField = document.getElementById("pc_age");
  const sexeField = document.getElementById("pc_sexe");
  const errorSexe = document.querySelector('[data-error-for="pc_sexe"]');

  if (!ageField.value) {
    ageField.classList.add("invalid");
    valid = false;
  } else {
    ageField.classList.remove("invalid");
  }

  if (!sexeField.value) {
    if (errorSexe) errorSexe.style.display = "block";
    sexeField.classList.add("invalid");
    valid = false;
  } else {
    if (errorSexe) errorSexe.style.display = "none";
    sexeField.classList.remove("invalid");
  }
  return valid;
}

function generateCystPlan() {
  if (!validateRequiredFields()) {
    return;
  }

  // Informations Patient
  const age = document.getElementById("pc_age").value;
  const sexe = document.getElementById("pc_sexe").value;

  // Caractéristiques du kyste
  const cystSize = document.getElementById("cyst_size").value || "Non renseigné";
  const cystLoc = document.getElementById("cyst_location").value || "Non renseignée";
  const cystImg = document.getElementById("cyst_img").value || "Non renseignée";
  
  const ca19_9 = document.getElementById("ca19_9").value || "Non renseigné";
  const cytology = document.getElementById("cyst_cytology").value || "Non renseigné";
  const cystGlucose = document.getElementById("cyst_glucose").value || "Non renseigné";
  const cystMucinous = document.getElementById("cyst_mucinous").value || "Non renseigné";

  // Facteurs de risque
  const riskFactors = [];
  if (document.getElementById("fr_mainDuct_5_10").checked) riskFactors.push("Dilatation CPP 5-10 mm");
  if (document.getElementById("fr_csOver4").checked) riskFactors.push("Kyste des CS > 40 mm");
  if (document.getElementById("fr_noduleUnder5").checked) riskFactors.push("Nodule mural < 5 mm");
  if (document.getElementById("fr_pancreatitis").checked) riskFactors.push("Pancréatite aiguë associée");
  if (document.getElementById("fr_diabDeNovo").checked) riskFactors.push("Diabète de novo");
  if (document.getElementById("fr_ca19High").checked) riskFactors.push("CA 19-9 élevé");
  
  const highRisk = [];
  if (document.getElementById("fr_mainDuct").checked) highRisk.push("Dilatation CPP > 10 mm");
  if (document.getElementById("fr_noduleOver5").checked) highRisk.push("Nodule mural > 5 mm");
  if (document.getElementById("fr_jaundice").checked) highRisk.push("Ictère obstructif");
  if (document.getElementById("fr_cytologyPos").checked) highRisk.push("Cytologie positive");

  // Symptômes
  const symptoms = [];
  if (document.getElementById("pc_asymptomatic").checked) symptoms.push("Asymptomatique");
  if (document.getElementById("pc_pain").checked) symptoms.push("Douleurs épigastriques");
  if (document.getElementById("pc_weightLoss").checked) symptoms.push("Perte de poids");
  if (document.getElementById("pc_acutePancreatitis").checked) symptoms.push("Épisode récent de pancréatite aiguë");
  const otherSym = document.getElementById("pc_otherSymptoms").value.trim();
  if (otherSym !== "") symptoms.push(otherSym);

  // Construction du rapport
  let report = "<strong>Résumé du kyste pancréatique</strong><br>";
  report += "Patient de " + age + " ans, " + sexe + ".<br>";
  report += "Taille du kyste : " + cystSize + " mm<br>";
  report += "Localisation : " + cystLoc + "<br>";
  report += "Modalités d'imagerie : " + cystImg + "<br>";
  report += "CA 19-9 : " + ca19_9 + " ng/ml<br>";
  report += "Cytologie : " + cytology + "<br>";
  report += "Glucose intra-kystique : " + cystGlucose + " g/l<br>";
  report += "Nature du kyste : " + cystMucinous + "<br><br>";
  
  report += "<u>Symptômes :</u> " + (symptoms.length ? symptoms.join(", ") : "Aucun") + ".<br>";
  report += "<strong>Facteurs de risque relatifs :</strong> " + (riskFactors.length ? riskFactors.join(", ") : "Aucun") + ".<br>";
  report += "<strong>Facteurs de risque élevés :</strong> " + (highRisk.length ? highRisk.join(", ") : "Aucun") + ".<br><br>";
  
  // Proposition de prise en charge
  let planText = "<strong>Conduite à tenir :</strong><br>";
  if (highRisk.length > 0) {
    planText += "• Risque élevé de dégénérescence : Indication de discussion pour chirurgie d’emblée ou approfondissement par échoendoscopie avec prélèvements.<br>";
  } else if (riskFactors.length > 0) {
    planText += "• Risque relatif de dégénérescence : Indication de surveillance rapprochée (IRM et/ou EE) tous les 6-12 mois, avec prélèvement si doute persistant.<br>";
  } else {
    planText += "• Faible risque : Indication de surveillance annuelle (IRM/TDM) ; échoendoscopie en cas de doute.<br>";
  }

  report += planText;
  document.getElementById("resultCyst").innerHTML = report;
}
  
document.addEventListener('DOMContentLoaded', () => {
  // Chargement de l'état si nécessaire (à étendre pour la persistance si besoin)
});
</script>
  </div>
 <!-- Module: Conduite à tenir - Tumeurs Neuroendocrines  -->
<div id="moduleTNE" class="module">
  <h3>Conduite à tenir - Tumeurs Neuroendocrines</h3>

  <section class="form-section">
    <h2>Caractéristiques tumorales</h2>
    <form id="tneForm">
      <label class="required">
        Grade :
        <select id="tneGrade" required>
          <option value="">--Sélectionner--</option>
          <option value="G1">G1 (Ki67 ≤ 2%)</option>
          <option value="G2">G2 (Ki67 3-20%)</option>
          <option value="G3">G3 (Ki67 > 20%)</option>
        </select>
      </label>

      <label class="required">
        Siège primitif :
        <select id="tneSite" required>
          <option value="">--Choisir--</option>
          <option value="pancreas">Pancréas</option>
          <option value="grele">Grêle</option>
          <option value="rectum">Rectum</option>
          <option value="poumon">Poumon</option>
          <option value="autre">Autre</option>
        </select>
      </label>

      <label class="required">
        Stade :
        <select id="tneStage" required>
          <option value="">--Sélectionner--</option>
          <option value="localise">Localisé</option>
          <option value="regional">Régional</option>
          <option value="metastatique">Métastatique</option>
        </select>
      </label>

      <fieldset>
        <legend>Caractéristiques fonctionnelles :</legend>
        <label>
          <input type="checkbox" name="tneFonctionnel" value="syndrome">
          Syndrome carcinoïde
        </label>
        <label>
          <input type="checkbox" name="tneFonctionnel" value="gastrinome">
          Gastrinome
        </label>
        <label>
          <input type="checkbox" name="tneFonctionnel" value="insulinome">
          Insulinome
        </label>
      </fieldset>

      <label>
        Biomarqueurs :
        <select id="tneBiomarqueurs" multiple>
          <option value="Chromogranine A">Chromogranine A élevée</option>
          <option value="5HIAA">5-HIAA urinaire</option>
          <option value="NSE">NSE élevée</option>
        </select>
      </label>
    </form>
  </section>

  <div class="section">
    <h2>Recommandations de prise en charge</h2>
    <button type="button" onclick="generateTNERecommendation()">Générer la conduite à tenir</button>
    <div id="tneRecommendation" class="result"></div>
  </div>

  <script>
    function generateTNERecommendation() {
      const grade = document.getElementById('tneGrade').value;
      const site = document.getElementById('tneSite').value;
      const stage = document.getElementById('tneStage').value;
      const fonctionnel = Array.from(document.querySelectorAll('#tneForm input[name="tneFonctionnel"]:checked'))
                               .map(cb => cb.value);
      const biomarqueurs = Array.from(document.getElementById('tneBiomarqueurs').selectedOptions)
                                .map(o => o.value);

      if (!grade || !site || !stage) {
        alert("Veuillez remplir les champs obligatoires (*)");
        return;
      }

      let recommendation = "<h3>Stratégie thérapeutique :</h3>";
      let traitement = [];
      let surveillance = [];

      // Pour les tumeurs localisées : la chirurgie curative reste la pierre angulaire.
      if (stage === "localise") {
        traitement.push("Résection chirurgicale complète");
        if (site === "pancreas") {
          traitement.push("Option d'énucléation ou pancréatectomie partielle selon l'extension locale");
        }
        // Pour les NET de haut grade, envisager une chimiothérapie néoadjuvante
        if (grade === "G3") {
          traitement.push("Discussion d'une chimiothérapie néoadjuvante (ex. Platine-Étoposide)");
        }
      } 
      // Pour la maladie régionale ou métastatique : une approche systémique est indiquée
      else if (stage === "regional" || stage === "metastatique") {
        traitement.push("Traitement systémique de première ligne :");
        // Pour les NET de bas grade (G1-G2)
        if (grade === "G1" || grade === "G2") {
          traitement.push("Analogues de la somatostatine (Octréotide ou Lanréotide)");
          traitement.push("Thérapies ciblées (Everolimus/Sunitinib) en cas de progression");
          traitement.push("PRRT (lutathérapie) si récepteurs SSTR positifs");
        }
        // Pour les NET de haut grade (G3)
        if (grade === "G3") {
          traitement.push("Chimiothérapie à base de platine et d'étoposide");
        }
      }

      // Prise en charge spécifique en cas de tumeur fonctionnelle
      if (fonctionnel.includes("insulinome")) {
        traitement.push("Traitement symptomatique par Diazoxide et adaptation des repas");
      }
      
      // Surveillance
      surveillance.push("Scanner thoraco-abdomino-pelvien tous les 6-12 mois");
      surveillance.push("Dosage périodique de la Chromogranine A et des biomarqueurs");
      if (fonctionnel.length > 0) {
        surveillance.push("Suivi clinique rapproché des symptômes fonctionnels");
      }

      recommendation += "<ul>";
      traitement.forEach(t => recommendation += `<li><strong>${t}</strong></li>`);
      surveillance.forEach(s => recommendation += `<li>${s}</li>`);
      recommendation += "</ul>";

      // Facteurs pronostiques et pronostic général mis à jour
      recommendation += "<h3>Pronostic :</h3>";
      const prognoses = {
        "G1": "Survie à 5 ans : 70-95%",
        "G2": "Survie à 5 ans : 40-70%",
        "G3": "Survie à 5 ans : 10-30%"
      };
      let pronosticText = prognoses[grade] || "";
      if (stage === "metastatique") {
        pronosticText += " (avec réduction de la survie d'environ 50% en cas de métastases)";
      }
      recommendation += `<p>${pronosticText}</p>`;

      document.getElementById('tneRecommendation').innerHTML = recommendation;
    }
  </script>

  <div class="section">
    <h3>Arbre décisionnel simplifié</h3>
    <table>
      <tr>
        <th>Grade</th>
        <th>Stade</th>
        <th>Traitement</th>
      </tr>
      <tr>
        <td>G1-G2</td>
        <td>Localisé</td>
        <td>Chirurgie curative</td>
      </tr>
      <tr>
        <td>G1-G2</td>
        <td>Métastatique</td>
        <td>Analogues SSA ± PRRT</td>
      </tr>
      <tr>
        <td>G3</td>
        <td>Tous stades</td>
        <td>Chimiothérapie systémique (Platine-Étoposide)</td>
      </tr>
    </table>
  </div>

  <div class="section">
    <h3>Références</h3>
    <ul>
      <li>Recommandations TNCD SNFGE 2021</li>
      <li>FFCD Guidelines 2020</li>
      <li>Oncolor – Référentiel TNE 2022</li>
      <li>ENETS Consensus Guidelines 2020</li>
      <li>(document consulté)</li>
    </ul>
    <p style="color: #666; font-style: italic;">
      NB : Les choix thérapeutiques doivent être validés en réunion de concertation pluridisciplinaire (RCP).
    </p>
  </div>
</div>

	
  <!-- Module: Cancer de l'anus -->
  <div id="moduleAnus" class="module">
    <h3>Cancer de l'anus</h3>
    <form id="formAnus">
      <section class="form-section">
        <h2>Informations Cliniques</h2>
        <label for="stage_anus">Stade de la maladie :</label>
        <select id="stage_anus">
          <option value="localise">Localisé (T1-T2, N0)</option>
          <option value="avance">Localement avancé (T3-T4 ou N+)</option>
          <option value="metastatique">Métastatique (M1)</option>
        </select>
        <label for="taille_anus">Taille de la tumeur :</label>
        <select id="taille_anus">
          <option value="petite">Petite (&lt; 2 cm)</option>
          <option value="moyenne">Moyenne (2–5 cm)</option>
          <option value="grande">Grande (&gt; 5 cm)</option>
        </select>
        <label><input type="checkbox" id="adenopathie_anus"> Présence d'adénopathies régionales</label>
        <label for="ecog_anus">Performance Status (ECOG):</label>
        <select id="ecog_anus">
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">≥2</option>
        </select>
      </section>
      <button type="button" onclick="calculateManagementAnus()">Générer la conduite à tenir</button>
    </form>
    <div id="resultAnus"></div>
    <script>
      function calculateManagementAnus() {
        var stage = document.getElementById("stage_anus").value;
        var adenopathie = document.getElementById("adenopathie_anus").checked;
        var plan = "";
        if (stage === "metastatique") {
          plan += "<strong>Cancer de l'anus métastatique :</strong><br>";
          plan += "Traitement palliative par chimiothérapie systémique et prise en charge symptomatique.<br>";
        } else if (stage === "avance" || (stage === "localise" && adenopathie)) {
          plan += "<strong>Cancer de l'anus localement avancé :</strong><br>";
          plan += "Chimioradiothérapie (protocole Nigro) avec discussion multidisciplinaire pour traitement intensifié.<br>";
        } else {
          plan += "<strong>Cancer de l'anus localisé :</strong><br>";
          plan += "Chimioradiothérapie (protocole Nigro) avec suivi post-traitement régulier.<br>";
        }
        document.getElementById("resultAnus").innerHTML = plan;
      }
    </script>
  </div>
  
  <!-- Module: Œsophage de Barrett -->
  <div id="moduleBarrett" class="module">
    <h3>Œsophage de Barrett</h3>
    <form id="formBarrett">
      <section class="form-section">
        <h2>Informations Endoscopiques</h2>
        <label for="dysplasie">Type de dysplasie :</label>
        <select id="dysplasie">
          <option value="non">Non dysplasique</option>
          <option value="bas">Dysplasie de bas grade</option>
          <option value="haut">Dysplasie de haut grade</option>
          <option value="intra">Carcinome intramucosaire</option>
        </select>
        <label for="longueur">Longueur du segment de Barrett :</label>
        <select id="longueur">
          <option value="courte">Courte (< 3 cm)</option>
          <option value="longue">Longue (≥ 3 cm)</option>
        </select>
      </section>
      <section class="form-section">
        <h2>Facteurs de Risque</h2>
        <label><input type="checkbox" id="familial"> Antécédents familiaux de cancer œsophagien</label>
        <label><input type="checkbox" id="fumeur"> Tabagisme</label>
        <label><input type="checkbox" id="obesite"> Obésité</label>
      </section>
      <button type="button" onclick="calculateManagementBarrett()">Générer la conduite à tenir</button>
    </form>
    <div id="resultBarrett"></div>
    <script>
      function calculateManagementBarrett() {
        var dysplasie = document.getElementById("dysplasie").value;
        var longueur = document.getElementById("longueur").value;
        var plan = "";
        if (dysplasie === "non") {
          plan += "Barrett non dysplasique : surveillance endoscopique tous les 3 à 5 ans. ";
          plan += (longueur === "longue") ? "Surveillance rapprochée (tous les 3 ans) recommandée." : "Suivi tous les 5 ans suffisant.";
          plan += "<br>Traitement par IPP recommandé.";
        } else if (dysplasie === "bas") {
          plan += "Barrett avec dysplasie de bas grade : endoscopie de surveillance tous les 6 à 12 mois, avec possible ablation endoscopique en cas de persistance.";
        } else if (dysplasie === "haut") {
          plan += "Barrett avec dysplasie de haut grade : éradication endoscopique urgente (résection/ablation) et suivi rapproché.";
        } else if (dysplasie === "intra") {
          plan += "Carcinome intramucosaire : résection endoscopique (EMR/ESD) indiquée, avec prise en charge multidisciplinaire.";
        } else {
          plan += "Informations insuffisantes.";
        }
        document.getElementById("resultBarrett").innerHTML = plan;
      }
    </script>
  </div>
  
<!-- Module: Prise en charge de la Maladie Cœliaque -->
<div id="moduleCoeliaque" class="module">
  <h3>Prise en charge de la Maladie Cœliaque</h3>
  <form id="formCoeliaque">
    <!-- Informations du Patient -->
    <section class="form-section">
      <h2>Informations du Patient</h2>
      <label for="nom_prenom_coe">Nom et Prénom :</label>
      <input type="text" id="nom_prenom_coe" placeholder="Entrez le nom et prénom">
      
      <label for="age_coe">Âge :</label>
      <input type="number" id="age_coe" placeholder="Entrez l'âge" min="0">
      
      <label for="sexe_coe">Sexe :</label>
      <select id="sexe_coe">
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
      </select>
      
      <label for="poids_coe">Poids (kg) :</label>
      <input type="number" id="poids_coe" placeholder="Entrez le poids" min="0">
      
      <label for="taille_coe">Taille (cm) :</label>
      <input type="number" id="taille_coe" placeholder="Entrez la taille" min="0">
    </section>
    
    <!-- Informations spécifiques à la maladie cœliaque -->
    <section class="form-section">
      <h2>Informations sur la Maladie Cœliaque</h2>
      <label>
        <input type="checkbox" id="diagnostic_coe">
        Diagnostic confirmé par sérologie et biopsie
      </label>
      <label for="symptomes_coe">Symptômes principaux :</label>
      <textarea id="symptomes_coe" rows="2" placeholder="Ex : diarrhée, douleurs abdominales, fatigue..."></textarea>
    </section>
    
    <button type="button" onclick="calculateCoeliaque()">Générer la conduite à tenir</button>
  </form>
  
  <div id="resultCoeliaque" class="result"></div>
  
  <script>
    function calculateCoeliaque() {
      // Récupération des données du formulaire
      var nomPrenom = document.getElementById("nom_prenom_coe").value;
      var age = parseFloat(document.getElementById("age_coe").value) || 0;
      var sexe = document.getElementById("sexe_coe").value;
      var poids = parseFloat(document.getElementById("poids_coe").value) || 0;
      var taille = parseFloat(document.getElementById("taille_coe").value) || 0;
      var diagnostic = document.getElementById("diagnostic_coe").checked;
      var symptomes = document.getElementById("symptomes_coe").value.trim();
      
      // Calcul du BMI (taille convertie de cm en m)
      var bmi = (poids / Math.pow(taille / 100, 2)).toFixed(2);
      var bmiCategory = "";
      if(bmi < 18.5) {
        bmiCategory = "Insuffisance pondérale";
      } else if(bmi < 25) {
        bmiCategory = "Poids normal";
      } else if(bmi < 30) {
        bmiCategory = "Surpoids";
      } else {
        bmiCategory = "Obésité";
      }
      
      // Construction du résumé et des recommandations
      var plan = "<strong>Résumé Clinique :</strong><br>";
      plan += "Patient : " + nomPrenom + "<br>";
      plan += "Âge : " + age + " ans, Sexe : " + sexe + ".<br>";
      plan += "BMI : " + bmi + " kg/m² (" + bmiCategory + ").<br>";
      
      plan += "<br><strong>Recommandations pour la Maladie Cœliaque :</strong><br>";
      if (diagnostic) {
        plan += "• Suivre un régime strict sans gluten afin d'éviter toute contamination croisée.<br>";
        plan += "• Éviter les aliments contenant du blé, orge, seigle et avoine non certifiée sans gluten.<br>";
        plan += "• Consulter un diététicien spécialisé pour adapter l'alimentation.<br>";
        plan += "• Surveiller la densité osseuse et rechercher d'éventuelles carences (fer, calcium, vitamine D).<br>";
      } else {
        plan += "• En l'absence de diagnostic confirmé, des investigations complémentaires (sérologie, biopsie) sont recommandées avant de débuter un régime sans gluten strict.<br>";
      }
      if (symptomes !== "") {
        plan += "• Symptômes rapportés : " + symptomes + ".<br>";
      }
      
      plan += "<br><strong>Exemple de Menu Hebdomadaire Sans Gluten :</strong><br>";
      plan += generateWeeklyMenuCoeliaque();
      
      document.getElementById("resultCoeliaque").innerHTML = plan;
    }
    
    // Fonction de génération d'un exemple de menu hebdomadaire sans gluten
    function generateWeeklyMenuCoeliaque() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Smoothie bowl avec fruits frais, lait d'amande et granola sans gluten.</li>
              <li><strong>Déjeuner :</strong> Salade de quinoa aux légumes grillés, pois chiches et vinaigrette au citron.</li>
              <li><strong>Collation :</strong> Pomme accompagnée de beurre de cacahuète sans gluten.</li>
              <li><strong>Dîner :</strong> Filet de poisson vapeur, riz basmati et brocolis vapeur.</li>
            </ul>
          </li>
          <li><strong>Mardi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Flocons de sarrasin cuits avec lait de riz, banane et noix.</li>
              <li><strong>Déjeuner :</strong> Poulet grillé, salade verte avec avocat et tomates, quinoa.</li>
              <li><strong>Collation :</strong> Yaourt nature sans gluten agrémenté de fruits rouges.</li>
              <li><strong>Dîner :</strong> Soupe de légumes maison avec lentilles et pain sans gluten.</li>
            </ul>
          </li>
          <li><strong>Mercredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Omelette aux herbes accompagnée de pain sans gluten grillé.</li>
              <li><strong>Déjeuner :</strong> Salade de riz sauvage, légumes croquants et tofu mariné.</li>
              <li><strong>Collation :</strong> Smoothie aux fruits avec lait d'amande.</li>
              <li><strong>Dîner :</strong> Steak de dinde, purée de patate douce et haricots verts.</li>
            </ul>
          </li>
          <li><strong>Jeudi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Porridge de millet garni de miel et de fruits frais.</li>
              <li><strong>Déjeuner :</strong> Salade de lentilles, betterave et roquette avec vinaigrette légère.</li>
              <li><strong>Collation :</strong> Poire et quelques amandes.</li>
              <li><strong>Dîner :</strong> Filet de saumon, riz complet et épinards sautés.</li>
            </ul>
          </li>
          <li><strong>Vendredi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Crêpes sans gluten à base de farine de riz, garnies de compote de pommes.</li>
              <li><strong>Déjeuner :</strong> Salade de pois chiches, concombre, tomates et feta sans gluten.</li>
              <li><strong>Collation :</strong> Smoothie vert (épinards, pomme, citron, lait d'amande).</li>
              <li><strong>Dîner :</strong> Poulet rôti, légumes grillés et quinoa.</li>
            </ul>
          </li>
          <li><strong>Samedi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Bol de fruits frais avec yaourt sans gluten et graines de chia.</li>
              <li><strong>Déjeuner :</strong> Wrap sans gluten (tortilla de maïs) garni de poulet, légumes et sauce légère.</li>
              <li><strong>Collation :</strong> Barre énergétique sans gluten.</li>
              <li><strong>Dîner :</strong> Risotto aux champignons et épinards.</li>
            </ul>
          </li>
          <li><strong>Dimanche :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Muesli sans gluten avec lait d'amande et fruits secs.</li>
              <li><strong>Déjeuner :</strong> Filet de poisson grillé, purée de carottes et salade de roquette.</li>
              <li><strong>Collation :</strong> Compote de poires sans sucre ajouté.</li>
              <li><strong>Dîner :</strong> Soupe de légumes variés et pain sans gluten.</li>
            </ul>
          </li>
        </ul>
      `;
    }
  </script>
</div>
  
  <!-- Module: Maladie hémorroïdaire -->
  <div id="moduleHemorrhoids" class="module">
    <h3>Maladie hémorroïdaire</h3>
    <form id="formHemorrhoids">
      <section class="form-section">
        <h2>Caractéristiques cliniques</h2>
        <label for="grade_hem">Grade des hémorroïdes :</label>
        <select id="grade_hem">
          <option value="I">Grade I (hémorroïdes visibles, sans prolapsus)</option>
          <option value="II">Grade II (prolapsus spontané réductible)</option>
          <option value="III">Grade III (prolapsus nécessitant une réduction manuelle)</option>
          <option value="IV">Grade IV (irréductible, souvent compliqué)</option>
        </select>
        <label for="severite_hem">Sévérité des symptômes :</label>
        <select id="severite_hem">
          <option value="mild">Légers</option>
          <option value="moderate">Modérés</option>
          <option value="severe">Sévères</option>
        </select>
      </section>
      <section class="form-section">
        <h2>Signes associés</h2>
        <label><input type="checkbox" id="bleeding_hem"> Présence de saignements</label>
        <label><input type="checkbox" id="thrombosed_hem"> Hémorroïdes thrombosées</label>
        <label><input type="checkbox" id="constipation_hem"> Constipation associée</label>
      </section>
      <button type="button" onclick="calculateManagementHem()">Générer la conduite à tenir</button>
    </form>
    <div id="resultHem"></div>
    <script>
      function calculateManagementHem() {
        var grade = document.getElementById("grade_hem").value;
        var severite = document.getElementById("severite_hem").value;
        var bleeding = document.getElementById("bleeding_hem").checked;
        var thrombosed = document.getElementById("thrombosed_hem").checked;
        var constipation = document.getElementById("constipation_hem").checked;
        var plan = "";
        if (thrombosed) {
          plan += "Hémorroïdes thrombosées : excision locale de la thrombose en phase aiguë (<72h) sous anesthésie locale, puis mesures conservatrices.<br><br>";
        }
        if (grade === "I") {
          plan += "Hémorroïdes de Grade I : traitement conservateur (mesures hygiéno-diététiques, crèmes topiques, bains de siège).";
        } else if (grade === "II") {
          plan += "Hémorroïdes de Grade II : en plus des mesures conservatrices, envisagez une ligature par bande élastique si symptômes persistants.";
        } else if (grade === "III") {
          plan += "Hémorroïdes de Grade III : traitement chirurgical (hémorroïdectomie ou procédure staplée) envisagé en cas d'échec du traitement conservateur.";
        } else if (grade === "IV") {
          plan += "Hémorroïdes de Grade IV : chirurgie (hémorroïdectomie) indiquée en raison de l'irréductibilité.";
        }
        if (severite === "severe") {
          plan += "<br><br>Symptômes sévères : prise en charge multimodale avec suivi rapproché.";
        } else if (severite === "moderate") {
          plan += "<br><br>Symptômes modérés : surveillance rapprochée et adaptation du traitement.";
        } else {
          plan += "<br><br>Symptômes légers : prise en charge ambulatoire par mesures conservatrices.";
        }
        if (constipation) {
          plan += "<br><br>Constipation : conseils diététiques pour augmenter l'apport en fibres et hydratation.";
        }
        if (bleeding) {
          plan += "<br><br>Saignements : évaluation de la fréquence et de l'importance, investigation complémentaire si persistants.";
        }
        document.getElementById("resultHem").innerHTML = plan;
      }
    </script>
  </div>
  
  <!-- Module: Hyperferritinémie -->
  <div id="moduleHyperferritin" class="module">
    <h3>Hyperferritinémie</h3>
    <form id="formHyperferritin">
      <section class="form-section">
        <h2>Informations du patient</h2>
        <label for="age_hf">Âge :</label>
        <input type="number" id="age_hf" placeholder="Entrez l'âge" min="0">
        <label for="sexe_hf">Sexe :</label>
        <select id="sexe_hf">
          <option value="Homme">Homme</option>
          <option value="Femme">Femme</option>
        </select>
      </section>
      <section class="form-section">
        <h2>Résultats de laboratoire</h2>
        <label for="ferritine">Niveau de ferritine :</label>
        <select id="ferritine">
          <option value="leger">Léger (&lt;300 µg/L)</option>
          <option value="moderé">Modéré (300–1000 µg/L)</option>
          <option value="severe">Sévère (>1000 µg/L)</option>
        </select>
        <label for="transferrin">Saturation en transferrine :</label>
        <select id="transferrin">
          <option value="normale">Normale (&lt;45%)</option>
          <option value="elevee">Élevée (≥45%)</option>
        </select>
      </section>
      <section class="form-section">
        <h2>Symptômes</h2>
        <label><input type="checkbox" id="symp_fatigue_hf"> Fatigue</label>
        <label><input type="checkbox" id="symp_arthralgies_hf"> Arthralgies</label>
        <label><input type="checkbox" id="symp_douleurAbdo_hf"> Douleur abdominale</label>
        <label><input type="checkbox" id="symp_inflammation_hf"> Signes d'inflammation</label>
        <label for="symp_autres_hf">Autres symptômes (précisez) :</label>
        <textarea id="symp_autres_hf" rows="2" placeholder="Décrivez ici"></textarea>
      </section>
      <section class="form-section">
        <h2>Antécédents et Facteurs de Risque</h2>
        <label><input type="checkbox" id="fact_alcool_hf"> Consommation d'alcool excessive</label>
        <label><input type="checkbox" id="fact_obesite_hf"> Obésité / syndrome métabolique</label>
        <label><input type="checkbox" id="fact_hepatite_hf"> Antécédents de virus hépatite ou exposition hépatotoxique</label>
        <label for="fact_autres_hf">Autres facteurs (précisez) :</label>
        <textarea id="fact_autres_hf" rows="2" placeholder="Décrivez ici"></textarea>
      </section>
      <section class="form-section">
        <h2>Antécédents familiaux</h2>
        <label>
          <input type="checkbox" id="fam_hepato_hf"> Antécédents familiaux de maladies hépatiques ou cancer du foie
        </label>
        <label for="fam_details_hf">Si oui, précisez :</label>
        <textarea id="fam_details_hf" rows="2" placeholder="Décrivez ici"></textarea>
      </section>
      <button type="button" onclick="calculateManagementHyperferritin()">Générer la conduite à tenir</button>
    </form>
    <div id="resultHyperferritin"></div>
    <script>
      function calculateManagementHyperferritin() {
        var transferrin = document.getElementById("transferrin").value;
        var plan = "";
        if (transferrin === "elevee") {
          plan += "Suspicion d'hémochromatose : dépistage génétique (mutation HFE) recommandé, bilan hépatique complet et, en cas de confirmation, mise en place d'une phlébotomie thérapeutique.<br>";
        } else {
          plan += "Hyperferritinémie d'origine inflammatoire ou dysmétabolique : bilan hépatique complet, dosage des marqueurs inflammatoires, et prise en charge de la cause sous-jacente par modifications du mode de vie.<br>";
        }
        plan += "<br><u>Ordonnance type & Conseils :</u><br>";
        plan += "– Paracétamol 500 mg, 1 comprimé 3-4 fois par jour en cas de douleur.<br>";
        plan += "– Conseiller une alimentation équilibrée, l'arrêt de l'alcool et l'activité physique régulière.<br>";
        plan += "– Suivi régulier avec répétition du bilan hépatique et explorations complémentaires (échographie, scanner, etc.) si nécessaire.<br>";
        document.getElementById("resultHyperferritin").innerHTML = plan;
      }
    </script>
  </div>
  
  <!-- Module: Tests hépatiques perturbés -->
  <div id="moduleLiverTests" class="module">
    <h3>Tests hépatiques perturbés</h3>
    <form id="formLiverTests">
      <section class="form-section">
        <h2>Résultats des tests hépatiques</h2>
        <label for="alt_lt">ALT :</label>
        <select id="alt_lt">
          <option value="normal">Normal</option>
          <option value="mild">Légèrement élevé (1-2x)</option>
          <option value="moderate">Modérément élevé (2-5x)</option>
          <option value="high">Très élevé (>5x)</option>
        </select>
        <label for="ast_lt">AST :</label>
        <select id="ast_lt">
          <option value="normal">Normal</option>
          <option value="mild">Légèrement élevé</option>
          <option value="moderate">Modérément élevé</option>
          <option value="high">Très élevé</option>
        </select>
        <label for="alp_lt">Phosphatase alcaline (ALP) :</label>
        <select id="alp_lt">
          <option value="normal">Normal</option>
          <option value="elevated">Élevée</option>
        </select>
        <label for="ggt_lt">GGT :</label>
        <select id="ggt_lt">
          <option value="normal">Normal</option>
          <option value="elevated">Élevée</option>
        </select>
        <label for="bilirubin_lt">Bilirubine totale :</label>
        <select id="bilirubin_lt">
          <option value="normal">Normal</option>
          <option value="elevated">Élevée</option>
        </select>
        <label for="albumin_lt">Albumine :</label>
        <select id="albumin_lt">
          <option value="normal">Normal</option>
          <option value="low">Basse</option>
        </select>
        <label for="pt_lt">Temps de prothrombine :</label>
        <select id="pt_lt">
          <option value="normal">Normal</option>
          <option value="prolonged">Prolongé</option>
        </select>
      </section>
      <button type="button" onclick="calculateManagementLiverTests()">Générer la conduite à tenir</button>
    </form>
    <div id="resultLiverTests"></div>
    <script>
      function calculateManagementLiverTests() {
        var alt = document.getElementById("alt_lt").value;
        var ast = document.getElementById("ast_lt").value;
        var bilirubin = document.getElementById("bilirubin_lt").value;
        var albumin = document.getElementById("albumin_lt").value;
        var pt = document.getElementById("pt_lt").value;
        var plan = "";
        if (alt === "high" || ast === "high" || bilirubin === "elevated" || albumin === "low" || pt === "prolonged") {
          plan += "<strong>Prise en charge urgente :</strong> Évaluation approfondie par un hépatologue, imagerie hépatique (échographie ou scanner) et bilans complémentaires (hépatites, auto-immunité, etc.).<br>";
        } else if (alt === "moderate" || ast === "moderate") {
          plan += "<strong>Prise en charge complémentaire :</strong> Bilan hépatique complet et imagerie (échographie) avec conseils hygiéno-diététiques.<br>";
        } else {
          plan += "<strong>Prise en charge conservatrice :</strong> Modifications du mode de vie et réévaluation dans 3 à 6 mois.<br>";
        }
        document.getElementById("resultLiverTests").innerHTML = plan;
      }
    </script>
  </div>

  <!-- Module: Conduite à tenir - Hépatite B Chronique -->
  <div id="moduleHepatiteB" class="module">
    <h3>Hépatite B Chronique</h3>
    
    <!-- Removed nested <form> to avoid HTML form nesting issues -->
    <!-- Single form for all content -->
    <form id="formHepatiteB">
      <div class="section">
        <h2>Données du patient</h2>
        <!-- The fields that used to be inside <form id="hepatitisForm"> are merged here -->
        <label class="required">
          Statut HBeAg:
          <select id="hbeag" required>
            <option value="">--Sélectionner--</option>
            <option value="positive">HBeAg positif</option>
            <option value="negative">HBeAg négatif</option>
          </select>
        </label>

        <label class="required">
          Charge virale HBV DNA (UI/mL):
          <select id="dna" required>
            <option value="">--Choisir--</option>
            <option value="<2000">&lt;2000</option>
            <option value="2000-20000">2000-20 000</option>
            <option value=">20000">&gt;20 000</option>
          </select>
        </label>

        <label class="required">
          ALT (N &lt; 40 UI/L):
          <select id="alt" required>
            <option value="">--Choisir--</option>
            <option value="normales">Normales</option>
            <option value="1x">≤1x ULN</option>
            <option value="2x">&gt;1-2x ULN</option>
            <option value=">2x">&gt;2x ULN</option>
          </select>
        </label>

        <label>
          Fibrose (FibroScan):
          <select id="fibrose">
            <option value="F0-F1">F0-F1</option>
            <option value="F2">F2</option>
            <option value="F3">F3</option>
            <option value="F4">F4 (Cirrhose)</option>
          </select>
        </label>

        <fieldset>
          <legend>Co-facteurs/Complications:</legend>
          <label><input type="checkbox" value="cirrhose"> Cirrhose</label>
          <label><input type="checkbox" value="hcc"> Antécédent de CHC</label>
          <label><input type="checkbox" value="coinfection"> Co-infection VIH/HDV</label>
          <label><input type="checkbox" value="immunosuppression"> Immunosuppression</label>
        </fieldset>
      </div>
      
      <!-- Recommandations de traitement -->
      <div class="section">
        <h2>Recommandations de traitement</h2>
        <button type="button" onclick="generateTreatment()">Générer les recommandations</button>
        <div id="treatmentResult" class="result"></div>
      </div>
    </form>

    <script>
      function generateTreatment() {
        const hbeag = document.getElementById('hbeag').value;
        const dna = document.getElementById('dna').value;
        const alt = document.getElementById('alt').value;
        const fibrose = document.getElementById('fibrose').value;
        const complications = Array.from(
          document.querySelectorAll('#moduleHepatiteB input[type=checkbox]:checked')
        ).map(cb => cb.value);

        if(!hbeag || !dna || !alt) {
          alert("Veuillez remplir les champs obligatoires (*)");
          return;
        }

        let recommendation = "<h3>Stratégie thérapeutique:</h3>";
        let traitement = [];
        let surveillance = [];

        // Logique selon EASL 2017 et AASLD 2018
        const indicationTraitement = (
          dna === ">20000" &&
          (alt === ">2x" || complications.includes("cirrhose")) ||
          complications.includes("hcc") ||
          complications.includes("immunosuppression")
        );

        if(indicationTraitement) {
          traitement.push("Traitement antiviral recommandé");
          
          if(complications.includes("cirrhose") || fibrose === "F4") {
            traitement.push("Première ligne: Ténofovir ou Entécavir");
            traitement.push("Contrôle virologique tous les 3 mois");
          } else {
            traitement.push("Options: Ténofovir, Entécavir ou Interféron PEG (si HBeAg+)");
          }

          if(complications.includes("coinfection")) {
            traitement.push("Adapter au traitement de la co-infection (VIH/HDV)");
          }
        } else {
          traitement.push("Surveillance recommandée");
          surveillance.push("Contrôle ALT et ADN HBV tous les 6 mois");
          surveillance.push("Évaluation fibrose tous les 1-2 ans");
        }

        // Prévention
        // (Check if 'vaccin' was intended as a separate checkbox? If so, adapt logic as needed)
        traitement.push("Vaccination des contacts non immunisés");

        // Surveillance HCC
        if(fibrose.startsWith("F3") || complications.includes("cirrhose")) {
          surveillance.push("Surveillance HCC par échographie + AFP tous les 6 mois");
        }

        recommendation += "<ul>";
        traitement.forEach(t => recommendation += `<li><strong>${t}</strong></li>`);
        surveillance.forEach(s => recommendation += `<li>${s}</li>`);
        recommendation += "</ul>";

        // Pronostic
        recommendation += "<h3>Pronostic:</h3>";
        recommendation += getPrognosis(fibrose, complications);

        document.getElementById('treatmentResult').innerHTML = recommendation;
      }

      function getPrognosis(fibrose, complications) {
        const fibroseScore = fibrose.split("-")[0];
        let pronostic = "";
        
        if(fibroseScore === "F4" || complications.includes("cirrhose")) {
          pronostic = "Risque élevé de décompensation (5-10%/an)";
        } else if(fibroseScore === "F3") {
          pronostic = "Risque modéré (3-5%/an)";
        } else {
          pronostic = "Risque faible (<1%/an)";
        }

        if(complications.includes("hcc")) {
          pronostic += "<br>Surveillance HCC renforcée nécessaire";
        }

        return pronostic;
      }
    </script>

    <div class="section">
      <h3>Arbre décisionnel simplifié</h3>
      <table>
        <tr>
          <th>Statut</th>
          <th>ADN HBV</th>
          <th>ALT</th>
          <th>Action</th>
        </tr>
        <tr>
          <td>HBeAg+</td>
          <td>&gt;20 000 UI/mL</td>
          <td>&gt;2x ULN</td>
          <td>Traitement antiviral</td>
        </tr>
        <tr>
          <td>HBeAg-</td>
          <td>&gt;2000 UI/mL</td>
          <td>&gt;1x ULN</td>
          <td>Évaluer fibrose</td>
        </tr>
        <tr>
          <td>Cirrhose</td>
          <td>Détectable</td>
          <td>Quelconque</td>
          <td>Traitement urgent</td>
        </tr>
      </table>
    </div>
  </div>
  
  
<!-- Module: Conduite à tenir - Hépatites Virales -->
<div id="moduleHepatites" class="module">
  <h3>Conduite à tenir - Hépatites Virales</h3>
  
  <!-- Navigation par type d'hépatite -->
  <div class="tab-container">
    <button class="tab-link active" onclick="openHepatite(event, 'hepatiteA')">Hépatite A</button>
    <button class="tab-link" onclick="openHepatite(event, 'hepatiteC')">Hépatite C</button>
    <button class="tab-link" onclick="openHepatite(event, 'hepatiteD')">Hépatite D</button>
    <button class="tab-link" onclick="openHepatite(event, 'hepatiteE')">Hépatite E</button>
  </div>

  <!-- Hépatite A -->
  <div id="hepatiteA" class="tab-content active">
    <form>
      <div class="section">
        <h3>Données Cliniques - Hépatite A</h3>
        <label>
          IgM anti-HAV:
          <select id="hav_igm">
            <option value="positive">Positive</option>
            <option value="negative">Negative</option>
          </select>
        </label>
        <br>
        <label>
          Forme clinique:
          <select id="hav_severity">
            <option value="icterique">Ictérique</option>
            <option value="anicterique">Anictérique</option>
            <option value="fulminante">Fulminante</option>
          </select>
        </label>
        <br>
        <fieldset>
          <legend>Facteurs de risque:</legend>
          <label><input type="checkbox" id="hav_risque_voyage" value="voyage"> Voyage récent</label>
          <label><input type="checkbox" id="hav_risque_collectivite" value="collectivite"> Exposition en collectivité</label>
          <label><input type="checkbox" id="hav_risque_immunodepression" value="immunodepression"> Immunodépression</label>
        </fieldset>
        <br>
        <button type="button" onclick="generateHepatiteA()">Générer la conduite</button>
      </div>
    </form>
    <div class="result" id="resultHAV"></div>
  </div>

  <!-- Hépatite B Chronique -->
  <div id="hepatiteB" class="tab-content">
    <form id="formHepatiteB">
      <div class="section">
        <h2>Données du patient</h2>
        <label class="required">
          Statut HBeAg:
          <select id="hbeag" required>
            <option value="">--Sélectionner--</option>
            <option value="positive">HBeAg positif</option>
            <option value="negative">HBeAg négatif</option>
          </select>
        </label>
        <br>
        <label class="required">
          Charge virale HBV DNA (UI/mL):
          <select id="dna" required>
            <option value="">--Choisir--</option>
            <option value="<2000">&lt;2000</option>
            <option value="2000-20000">2000-20 000</option>
            <option value=">20000">&gt;20 000</option>
          </select>
        </label>
        <br>
        <label class="required">
          ALT (N &lt; 40 UI/L):
          <select id="alt" required>
            <option value="">--Choisir--</option>
            <option value="normales">Normales</option>
            <option value="1x">≤1x ULN</option>
            <option value="2x">&gt;1-2x ULN</option>
            <option value=">2x">&gt;2x ULN</option>
          </select>
        </label>
        <br>
        <label>
          Fibrose (FibroScan):
          <select id="fibrose">
            <option value="F0-F1">F0‑F1</option>
            <option value="F2">F2</option>
            <option value="F3">F3</option>
            <option value="F4">F4 (Cirrhose)</option>
          </select>
        </label>
        <br>
        <fieldset>
          <legend>Co‑facteurs/Complications:</legend>
          <label><input type="checkbox" id="comp_cirrhose" value="cirrhose"> Cirrhose</label>
          <label><input type="checkbox" id="comp_hcc" value="hcc"> Antécédent de CHC</label>
          <label><input type="checkbox" id="comp_coinfection" value="coinfection"> Co‑infection VIH/HDV</label>
          <label><input type="checkbox" id="comp_immunosuppression" value="immunosuppression"> Immunosuppression</label>
        </fieldset>
      </div>
      
      <!-- Recommandations de traitement -->
      <div class="section">
        <h2>Recommandations de traitement</h2>
         <button type="button" class="recommendation-btn" onclick="generateTreatment()">Générer les recommandations</button>
        <div id="treatmentResult" class="result"></div>
      </div>
      
      <div class="section">
        <h3>Arbre décisionnel simplifié</h3>
        <table>
          <tr>
            <th>Statut</th>
            <th>ADN HBV</th>
            <th>ALT</th>
            <th>Action</th>
          </tr>
          <tr>
            <td>HBeAg+</td>
            <td>&gt;20 000 UI/mL</td>
            <td>&gt;2x ULN</td>
            <td>Traitement antiviral</td>
          </tr>
          <tr>
            <td>HBeAg-</td>
            <td>&gt;2000 UI/mL</td>
            <td>&gt;1x ULN</td>
            <td>Évaluer fibrose</td>
          </tr>
          <tr>
            <td>Cirrhose</td>
            <td>Détectable</td>
            <td>Quelconque</td>
            <td>Traitement urgent</td>
          </tr>
        </table>
      </div>
    </form>

    <script>
      function generateTreatment() {
        const hbeag = document.getElementById('hbeag').value;
        const dna = document.getElementById('dna').value;
        const alt = document.getElementById('alt').value;
        const fibrose = document.getElementById('fibrose').value;
        const complications = Array.from(
          document.querySelectorAll('#formHepatiteB input[type=checkbox]:checked')
        ).map(cb => cb.value);

        if (!hbeag || !dna || !alt) {
          alert("Veuillez remplir les champs obligatoires (*)");
          return;
        }

        let recommendation = "<h3>Stratégie thérapeutique pour l'Hépatite B Chronique :</h3>";
        let traitement = [];
        let surveillance = [];

        // Logique d'indication selon les guidelines EASL/AASLD
        const indicationTraitement = (
          (dna === ">20000" && (alt === ">2x" || complications.includes("cirrhose"))) ||
          complications.includes("hcc") ||
          complications.includes("immunosuppression")
        );

        if (indicationTraitement) {
          traitement.push("Traitement antiviral recommandé");
          if (complications.includes("cirrhose") || fibrose === "F4") {
            traitement.push("Première ligne: Ténofovir ou Entécavir");
            traitement.push("Contrôle virologique tous les 3 mois");
          } else {
            traitement.push("Options: Ténofovir, Entécavir ou Interféron PEG (si HBeAg+)");
          }
          if (complications.includes("coinfection")) {
            traitement.push("Adapter au traitement de la co‑infection (VIH/HDV)");
          }
        } else {
          traitement.push("Surveillance recommandée");
          surveillance.push("Contrôle ALT et ADN HBV tous les 6 mois");
          surveillance.push("Évaluation fibrose tous les 1‑2 ans");
        }

        traitement.push("Vaccination des contacts non immunisés");

        if (fibrose.startsWith("F3") || complications.includes("cirrhose")) {
          surveillance.push("Surveillance HCC par échographie + AFP tous les 6 mois");
        }

        recommendation += "<ul>";
        traitement.forEach(t => recommendation += `<li><strong>${t}</strong></li>`);
        surveillance.forEach(s => recommendation += `<li>${s}</li>`);
        recommendation += "</ul>";

        recommendation += "<h3>Pronostic:</h3>";
        recommendation += getPrognosis(fibrose, complications);

        document.getElementById('treatmentResult').innerHTML = recommendation;
      }

      function getPrognosis(fibrose, complications) {
        const fibroseScore = fibrose.split("-")[0];
        let pronostic = "";
        
        if (fibroseScore === "F4" || complications.includes("cirrhose")) {
          pronostic = "Risque élevé de décompensation (5-10%/an)";
        } else if (fibroseScore === "F3") {
          pronostic = "Risque modéré (3-5%/an)";
        } else {
          pronostic = "Risque faible (<1%/an)";
        }
        if (complications.includes("hcc")) {
          pronostic += "<br>Surveillance HCC renforcée nécessaire";
        }
        return pronostic;
      }
    </script>
  </div>

  <!-- Hépatite C -->
  <div id="hepatiteC" class="tab-content">
    <form>
      <div class="section">
        <h3>Évaluation HCV</h3>
        <label>
          Génotype:
          <select id="hcv_genotype">
            <option value="">--Sélectionner--</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
          </select>
        </label>
        <br>
        <label>
          Charge virale (UI/mL):
          <input type="number" id="hcv_rna">
        </label>
        <br>
        <label>
          Fibrose:
          <select id="hcv_fibrosis">
            <option value="F0-F1">F0‑F1</option>
            <option value="F2">F2</option>
            <option value="F3">F3</option>
            <option value="F4">F4</option>
          </select>
        </label>
        <br>
        <button type="button" onclick="generateHepatiteC()">Générer le traitement</button>
      </div>
    </form>
    <div class="result" id="resultHCV"></div>
  </div>

  <!-- Hépatite D (mise à jour) -->
  <div id="hepatiteD" class="tab-content">
    <form>
      <div class="section">
        <h3>Évaluation HDV</h3>
        <label>
          ARN HDV détectable:
          <select id="hdv_rna">
            <option value="positive">Positive</option>
            <option value="negative">Negative</option>
          </select>
        </label>
        <br>
        <label>
          Génotype:
          <select id="hdv_genotype">
            <option value="1">1</option>
            <option value="2-8">2-8</option>
          </select>
        </label>
        <br>
        <fieldset>
          <legend>Facteurs pronostiques:</legend>
          <label><input type="checkbox" value="cirrhose" id="hdv_cirrhose"> Cirrhose</label>
          <label><input type="checkbox" value="hcc" id="hdv_hcc"> CHC</label>
          <label><input type="checkbox" value="hiv" id="hdv_hiv"> Co‑infection VIH</label>
        </fieldset>
        <br>
        <button type="button" class="recommendation-btn" onclick="generateHepatiteD()">Générer la conduite</button>
      </div>
    </form>
    <div class="result" id="resultHD"></div>
  </div>

  <!-- Hépatite E (mise à jour) -->
  <div id="hepatiteE" class="tab-content">
    <form>
      <div class="section">
        <h3>Évaluation HEV</h3>
        <label>
          IgM anti-HEV:
          <select id="hev_igm">
            <option value="positive">Positive</option>
            <option value="negative">Negative</option>
          </select>
        </label>
        <br>
        <label>
          Forme clinique:
          <select id="hev_forme">
            <option value="aigue">Aiguë</option>
            <option value="chronique">Chronique</option>
            <option value="grave">Forme grave</option>
          </select>
        </label>
        <br>
        <fieldset>
          <legend>Facteurs de risque:</legend>
          <label><input type="checkbox" value="immunodepression" id="hev_immunodepression"> Immunodépression</label>
          <label><input type="checkbox" value="grossesse" id="hev_grossesse"> Grossesse</label>
          <label><input type="checkbox" value="maladiechronique" id="hev_maladiechronique"> Maladie hépatique chronique</label>
        </fieldset>
        <br>
        <button type="button" class="recommendation-btn" onclick="generateHepatiteE()">Générer la conduite</button>
      </div>
    </form>
    <div class="result" id="resultHE"></div>
  </div>
</div>

<script>
// Fonction d'ouverture des onglets
function openHepatite(evt, hepatiteName) {
  const tabContents = document.getElementsByClassName("tab-content");
  for (let i = 0; i < tabContents.length; i++) {
    tabContents[i].classList.remove("active");
  }
  const tabLinks = document.getElementsByClassName("tab-link");
  for (let i = 0; i < tabLinks.length; i++) {
    tabLinks[i].classList.remove("active");
  }
  document.getElementById(hepatiteName).classList.add("active");
  evt.currentTarget.classList.add("active");
}

// Hépatite A
function generateHepatiteA() {
  const havIgm = document.getElementById('hav_igm').value;
  const severity = document.getElementById('hav_severity').value;
  let riskFactors = [];
  if (document.getElementById('hav_risque_voyage').checked) riskFactors.push("Voyage récent");
  if (document.getElementById('hav_risque_collectivite').checked) riskFactors.push("Exposition en collectivité");
  if (document.getElementById('hav_risque_immunodepression').checked) riskFactors.push("Immunodépression");
  
  let recommendation = "<h3>Conduite à tenir pour l'Hépatite A :</h3><ul>";
  recommendation += "<li>Mesures hygiéno‑diététiques et repos</li>";
  if (severity === 'fulminante') {
    recommendation += "<li>Hospitalisation en urgence et prise en charge intensive</li>";
    recommendation += "<li>Évaluation pour transplantation si indiquée</li>";
  } else if (severity === 'icterique') {
    recommendation += "<li>Surveillance rapprochée avec traitement symptomatique</li>";
  } else {
    recommendation += "<li>Suivi ambulatoire et conseils de prévention</li>";
  }
  recommendation += "<li>Vaccination des contacts</li>";
  recommendation += "</ul>";
  
  document.getElementById('resultHAV').innerHTML = recommendation;
}

// Hépatite B Chronique
function generateTreatment() {
  const hbeag = document.getElementById('hbeag').value;
  const dna = document.getElementById('dna').value;
  const alt = document.getElementById('alt').value;
  const fibrose = document.getElementById('fibrose').value;
  const complications = Array.from(
    document.querySelectorAll('#formHepatiteB input[type=checkbox]:checked')
  ).map(cb => cb.value);

  if (!hbeag || !dna || !alt) {
    alert("Veuillez remplir les champs obligatoires (*)");
    return;
  }

  let recommendation = "<h3>Stratégie thérapeutique pour l'Hépatite B Chronique :</h3>";
  let traitement = [];
  let surveillance = [];

  // Logique d'indication selon les guidelines EASL/AASLD
  const indicationTraitement = (
    (dna === ">20000" && (alt === ">2x" || complications.includes("cirrhose"))) ||
    complications.includes("hcc") ||
    complications.includes("immunosuppression")
  );

  if (indicationTraitement) {
    traitement.push("Traitement antiviral recommandé");
    if (complications.includes("cirrhose") || fibrose === "F4") {
      traitement.push("Première ligne: Ténofovir ou Entécavir");
      traitement.push("Contrôle virologique tous les 3 mois");
    } else {
      traitement.push("Options: Ténofovir, Entécavir ou Interféron PEG (si HBeAg+)");
    }
    if (complications.includes("coinfection")) {
      traitement.push("Adapter au traitement de la co‑infection (VIH/HDV)");
    }
  } else {
    traitement.push("Surveillance recommandée");
    surveillance.push("Contrôle ALT et ADN HBV tous les 6 mois");
    surveillance.push("Évaluation fibrose tous les 1‑2 ans");
  }

  traitement.push("Vaccination des contacts non immunisés");

  if (fibrose.startsWith("F3") || complications.includes("cirrhose")) {
    surveillance.push("Surveillance HCC par échographie + AFP tous les 6 mois");
  }

  recommendation += "<ul>";
  traitement.forEach(t => recommendation += `<li><strong>${t}</strong></li>`);
  surveillance.forEach(s => recommendation += `<li>${s}</li>`);
  recommendation += "</ul>";

  recommendation += "<h3>Pronostic:</h3>";
  recommendation += getPrognosis(fibrose, complications);

  document.getElementById('treatmentResult').innerHTML = recommendation;
}

function getPrognosis(fibrose, complications) {
  const fibroseScore = fibrose.split("-")[0];
  let pronostic = "";
  
  if (fibroseScore === "F4" || complications.includes("cirrhose")) {
    pronostic = "Risque élevé de décompensation (5-10%/an)";
  } else if (fibroseScore === "F3") {
    pronostic = "Risque modéré (3-5%/an)";
  } else {
    pronostic = "Risque faible (<1%/an)";
  }
  if (complications.includes("hcc")) {
    pronostic += "<br>Surveillance HCC renforcée nécessaire";
  }
  return pronostic;
}

// Hépatite C
function generateHepatiteC() {
  const genotype = document.getElementById('hcv_genotype').value;
  const fibrosis = document.getElementById('hcv_fibrosis').value;
  let treatment = "";
  
  switch (genotype) {
    case '1':
      treatment = "Elbasvir/grazoprevir 12 semaines";
      break;
    case '2':
      treatment = "SOF/VEL 12 semaines";
      break;
    case '3':
      treatment = (fibrosis === 'F4') ? "SOF/VEL/VOX 12 semaines" : "SOF/VEL 12 semaines";
      break;
    case '4':
      treatment = "Interféron PEG + Ribavirine 48 semaines";
      break;
    default:
      treatment = "Traitement standard selon les guidelines";
  }
  
  const result = `
    <h3>Proposition thérapeutique pour l'Hépatite C (EASL 2023):</h3>
    <p><strong>Schéma thérapeutique :</strong> ${treatment}</p>
    <p>Surveillance de la charge virale à S4, S12 et S24.</p>
  `;
  
  document.getElementById('resultHCV').innerHTML = result;
}

// Hépatite D (mise à jour)
function generateHepatiteD() {
  const hdvRNA = document.getElementById('hdv_rna').value;
  const genotype = document.getElementById('hdv_genotype').value;
  const complications = Array.from(document.querySelectorAll('#hdv_risque input:checked')).map(cb => cb.value);
  
  let recommendation = "<h3>Conduite à tenir pour l'Hépatite D (HDV):</h3><ul>";
  
  if (hdvRNA === 'positive') {
    recommendation += "<li>Traitement par Interféron PEG α pendant au moins 48 semaines</li>";
    recommendation += "<li>Utilisation de Bulevirtide (Myrcludex B) si disponible et indiquée</li>";
    if (genotype === '1') {
      recommendation += "<li>Surveillance virologique trimestrielle</li>";
    }
    if (complications.includes('cirrhose')) {
      recommendation += "<li>Surveillance échographique semestrielle</li>";
    }
  } else {
    recommendation += "<li>Surveillance régulière</li>";
  }
  
  recommendation += "</ul>";
  document.getElementById('resultHD').innerHTML = recommendation;
}

// Hépatite E (mise à jour)
function generateHepatiteE() {
  const hevIgm = document.getElementById('hev_igm').value;
  const forme = document.getElementById('hev_forme').value;
  let riskFactors = [];
  if (document.getElementById('hev_immunodepression').checked) riskFactors.push("Immunodépression");
  if (document.getElementById('hev_grossesse').checked) riskFactors.push("Grossesse");
  if (document.getElementById('hev_maladiechronique').checked) riskFactors.push("Maladie hépatique chronique");
  
  let recommendation = "<h3>Conduite à tenir pour l'Hépatite E (HEV):</h3><ul>";
  if (forme === 'aigue') {
    recommendation += "<li>Traitement symptomatique</li>";
    recommendation += "<li>Éviction des facteurs de risque alimentaires</li>";
  } else if (forme === 'chronique' || riskFactors.includes("Immunodépression")) {
    recommendation += "<li>Réduction de l'immunosuppression si possible</li>";
    recommendation += "<li>Traitement par Ribavirine 600-800 mg/j 8 mg/kg/jour pendant 3 mois</li>";
  }
  if (riskFactors.includes("Grossesse")) {
    recommendation += "<li>Surveillance intensive en milieu spécialisé</li>";
  }
  recommendation += "</ul>";
  document.getElementById('resultHE').innerHTML = recommendation;
}
</script>

<style>
.tab-container {
  display: flex;
  margin-bottom: 20px;
}
.tab-link {
  padding: 10px;
  cursor: pointer;
  border: 1px solid #ccc;
  margin-right: 5px;
  background-color: #f2f2f2;
}
.tab-link.active {
  background-color: #00539C;
  color: #fff;
}
.tab-content {
  display: none;
  padding: 20px;
  border: 1px solid #ccc;
}
.tab-content.active {
  display: block;
}
.recommendation-btn {
  background-color: #4CAF50;
  color: white;
  padding: 12px 24px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  margin: 10px 0;
}
.recommendation-btn:hover {
  background-color: #45a049;
}
/* Couleurs spécifiques par hépatite */
#hepatiteA .recommendation-btn { background-color: #FF6B6B; }
#hepatiteB .recommendation-btn { background-color: #4ECDC4; }
#hepatiteC .recommendation-btn { background-color: #45B7D1; }
#hepatiteD .recommendation-btn { background-color: #96CEB4; }
#hepatiteE .recommendation-btn { background-color: #FFEEAD; color: #333; }
</style>


  <!-- Module: Calcul IMC -->
  <div id="moduleIMC" class="module">
    <h3>IMC</h3>
    
    <div id="imc" class="score-section">
      <h3>Indice de Masse Corporelle (IMC)</h3>
      <div class="input-group">
        <label>Poids (kg): <input type="number" id="weight" step="0.1"></label>
        <label>Taille (m): <input type="number" id="height" step="0.01"></label>
      </div>
      <button onclick="calculateBMI()">Calculer</button>
      <div id="bmi-result" class="result"></div>
    </div>

    <script>

      function calculateBMI() {
        const weight = parseFloat(document.getElementById('weight').value);
        const height = parseFloat(document.getElementById('height').value);
        
        if (!weight || !height) {
          alert("Veuillez entrer des valeurs valides pour le poids et la taille.");
          return;
        }
        
        const bmi = weight / (height * height);
        let category = '';
        if (bmi < 18.5) category = 'Insuffisance pondérale';
        else if (bmi < 25) category = 'Poids normal';
        else if (bmi < 30) category = 'Surpoids';
        else category = 'Obésité';
        
        document.getElementById('bmi-result').innerHTML = `
          <strong>IMC:</strong> ${bmi.toFixed(1)} (${category})
        `;
      }      
    </script>   
  </div>
  
  
  <!-- -- Module Child-Pugh -->
  <div id="moduleChild" class="module">
  <h3>Score de Child-Pugh</h3>
  <div class="input-group">
    <label>Bilirubine (mg/dL): <input type="number" id="bilirubin" step="0.1"></label>
    <label>Albumine (g/dL): <input type="number" id="albumin" step="0.1"></label>
    <label>INR: <input type="number" id="inr" step="0.1"></label>
    <label>Ascite: 
      <select id="ascites">
        <option value="1">Absente</option>
        <option value="2">Légère</option>
        <option value="3">Importante</option>
      </select>
    </label>
    <label>Encéphalopathie: 
      <select id="encephalopathy">
        <option value="1">Absente</option>
        <option value="2">Grade I-II</option>
        <option value="3">Grade III-IV</option>
      </select>
    </label>
  </div>
  <!-- Utilisation d'un attribut data-action pour attacher l'événement -->
  <button type="button" data-action="calculateChildPugh">Calculer</button>
  <div id="child-result" class="result"></div>
</div>

<script>
  (function() {
    // Isolation du module dans "moduleChild"
    const moduleContainer = document.getElementById('moduleChild');

    function calculateChildPugh() {
      const bilirubin = parseFloat(moduleContainer.querySelector('#bilirubin').value);
      const albumin = parseFloat(moduleContainer.querySelector('#albumin').value);
      const inr = parseFloat(moduleContainer.querySelector('#inr').value);
      const ascites = parseInt(moduleContainer.querySelector('#ascites').value);
      const encephalopathy = parseInt(moduleContainer.querySelector('#encephalopathy').value);

      if (isNaN(bilirubin) || isNaN(albumin) || isNaN(inr)) {
        alert("Veuillez saisir toutes les valeurs numériques (bilirubine, albumine, INR).");
        return;
      }

      let points = 0;
      // Bilirubine
      if (bilirubin < 2) points += 1;
      else if (bilirubin <= 3) points += 2;
      else points += 3;

      // Albumine
      if (albumin > 3.5) points += 1;
      else if (albumin >= 2.8) points += 2;
      else points += 3;

      // INR
      if (inr < 1.7) points += 1;
      else if (inr <= 2.3) points += 2;
      else points += 3;

      // Ascite et Encéphalopathie
      points += ascites;          // 1, 2 ou 3
      points += encephalopathy;   // 1, 2 ou 3

      let classification;
      if (points <= 6) classification = 'A (bonne fonction hépatique)';
      else if (points <= 9) classification = 'B (insuffisance hépatique modérée)';
      else classification = 'C (insuffisance hépatique sévère)';

      moduleContainer.querySelector('#child-result').textContent =
        `Score: ${points} — Classe ${classification}`;
    }

    // Attacher l'événement au bouton spécifique de ce module
    moduleContainer.querySelector('[data-action="calculateChildPugh"]')
                   .addEventListener('click', function(e) {
      e.preventDefault();
      calculateChildPugh();
    });
  })();
</script>

  <!-- Module: Calcul ROME -->
  <div id="moduleRome" class="module">
    <h2>Rome III</h2>
	
    <div id="rome" class="score-section">
      <h3>Critères de Rome III</h3>
      <div class="input-group">
        <label><input type="checkbox" id="rome1"> Douleur abdominale ≥3j/mois</label>
        <label><input type="checkbox" id="rome2"> Amélioration par la défécation</label>
        <label><input type="checkbox" id="rome3"> Changement de fréquence</label>
        <label><input type="checkbox" id="rome4"> Changement de consistance</label>
      </div>
      <button onclick="checkRomeIII()">Vérifier</button>
      <div id="rome-result" class="result"></div>
    </div>
    <script>
	
      function checkRomeIII() {
        // Count how many boxes are checked
        const criteriaMet = [
          document.getElementById('rome1').checked,
          document.getElementById('rome2').checked,
          document.getElementById('rome3').checked,
          document.getElementById('rome4').checked
        ].filter(Boolean).length;

        // 3 or more → SII probable
        const result = criteriaMet >= 3
          ? "Critères de Rome III satisfaits → SII probable"
          : "Critères de Rome III non satisfaits";

        document.getElementById('rome-result').textContent = result;
      }
    </script>
  </div>
  <!-- SIRS -->
  <div id="modulesirs" class="module">
  
    <h3>Critères SIRS</h3>
    <label for="sirsTemp">Température (°C) :</label>
    <input type="number" id="sirsTemp" step="0.1">
    <label for="sirsFC">Fréquence cardiaque (bpm) :</label>
    <input type="number" id="sirsFC">
    <label for="sirsFR">Fréquence respiratoire (par minute) :</label>
    <input type="number" id="sirsFR">
    <label for="sirsWBC">Leucocytes (×10⁹/L) :</label>
    <input type="number" id="sirsWBC" step="0.1">
    <br>
    <button onclick="calculSIRS()">Évaluer SIRS</button>
    <div class="result" id="resultSIRS"></div>
 
    <script>
    // SIRS
    function calculSIRS() {
      const temp = parseFloat(document.getElementById('sirsTemp').value);
      const fc = parseFloat(document.getElementById('sirsFC').value);
      const fr = parseFloat(document.getElementById('sirsFR').value);
      const wbc = parseFloat(document.getElementById('sirsWBC').value);
      let criteria = 0;
      if (!isNaN(temp) && (temp > 38 || temp < 36)) criteria++;
      if (!isNaN(fc) && fc > 90) criteria++;
      if (!isNaN(fr) && fr > 20) criteria++;
      if (!isNaN(wbc) && (wbc > 12 || wbc < 4)) criteria++;
      const resultat = criteria + " critère(s) positif(s). " + (criteria >= 2 ? "SIRS positif." : "SIRS négatif.");
      document.getElementById('resultSIRS').innerText = resultat;
    }	
    </script>
  </div>	
<!-- CDAI -->
  <div id="moduleCDAI" class="module">
  
    <h3>CDAI</h3>
	<h2>Crohn’s Disease Activity Index (CDAI) – Formule simplifiée</h2>
    <label for="cdaiSelles">Nombre moyen de selles liquides/jour :</label>
    <input type="number" id="cdaiSelles" step="0.1">
    <label for="cdaiDouleur">Score moyen de douleur abdominale (0-3) :</label>
    <input type="number" id="cdaiDouleur" step="0.1">
    <label for="cdaiBienEtre">Score moyen de bien-être général (0-4) :</label>
    <input type="number" id="cdaiBienEtre" step="0.1">
    <label for="cdaiComplications">Nombre de complications extra-intestinales :</label>
    <input type="number" id="cdaiComplications">
    <label>
      <input type="checkbox" id="cdaiAnti"> Utilisation d’antidiarrhéiques (ajoute 30 points si oui)
    </label>
    <label for="cdaiHema">Hématocrite (%) :</label>
    <input type="number" id="cdaiHema" step="0.1">
    <label for="cdaiPoids">Pourcentage de perte de poids :</label>
    <input type="number" id="cdaiPoids" step="0.1">
    <br>
    <button onclick="calculCDAI()">Calculer le CDAI</button>
    <div class="result" id="resultCDAI"></div>
    <p><em>Formule utilisée : CDAI = 2×S + 5×(douleur) + 7×(bien-être) + 20×(complications) + 30×(anti-diarrhéiques) + 10×(47 - hématocrite) + (% perte de poids)</em></p>


    <script>
// CDAI
    function calculCDAI() {
      const selles = parseFloat(document.getElementById('cdaiSelles').value) || 0;
      const douleur = parseFloat(document.getElementById('cdaiDouleur').value) || 0;
      const bienEtre = parseFloat(document.getElementById('cdaiBienEtre').value) || 0;
      const complications = parseFloat(document.getElementById('cdaiComplications').value) || 0;
      const anti = document.getElementById('cdaiAnti').checked ? 1 : 0;
      const hct = parseFloat(document.getElementById('cdaiHema').value);
      const pertePoids = parseFloat(document.getElementById('cdaiPoids').value) || 0;

      if (isNaN(hct)) {
        document.getElementById('resultCDAI').innerText = "Veuillez saisir l'hématocrite.";
        return;
      }
      // Formule simplifiée
      const score = 2 * selles + 5 * douleur + 7 * bienEtre + 20 * complications + 30 * anti + 10 * (47 - hct) + pertePoids;
      document.getElementById('resultCDAI').innerText = "CDAI = " + score.toFixed(2);
    }	
    </script>
  </div>
  <!-- BCLC -->
  <div id="moduleBCLC" class="module">

    <h3>BCLC (Barcelona Clinic Liver Cancer)</h3>
    <label for="bclcECOG">Performance (ECOG 0-4) :</label>
    <select id="bclcECOG">
      <option value="0">0</option>
      <option value="1">1</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
    </select>
    <label for="bclcNodules">Nombre de nodules :</label>
    <input type="number" id="bclcNodules" min="1" value="1">
    <label>
      <input type="checkbox" id="bclcInvasion"> Invasion vasculaire présente
    </label>
    <br>
    <button onclick="calculBCLC()">Déterminer le stade BCLC</button>
    <div class="result" id="resultBCLC"></div>
    <p><em>Algorithme simplifié :<br>
      - Si ECOG > 2 → stade D<br>
      - Sinon, si invasion vasculaire présente → stade C<br>
      - Sinon, si nombre de nodules > 1 → stade B<br>
      - Sinon → stade A</em>
    </p>

    <script>
    // BCLC
    function calculBCLC() {
      const ECOG = parseInt(document.getElementById('bclcECOG').value);
      const nodules = parseInt(document.getElementById('bclcNodules').value);
      const invasion = document.getElementById('bclcInvasion').checked;
      let stade = "";
      if (ECOG > 2) {
        stade = "D";
      } else if (invasion) {
        stade = "C";
      } else if (nodules > 1) {
        stade = "B";
      } else {
        stade = "A";
      }
      document.getElementById('resultBCLC').innerText = "Stade BCLC déterminé : " + stade;
    }

    </script>
  </div>	
<!-- CTSI Modifié Modifié (Pancréatite aiguë-->
  <div id="moduleCTSI" class="module">

    <h3>CTSI Modifié (Pancréatite aiguë)</h3>
    <label for="ctsiInflammation">Score d'inflammation :</label>
    <select id="ctsiInflammation">
      <option value="0">Pancréas normal (0 points)</option>
      <option value="2">Anomalies pancréatiques sans collection (2 points)</option>
      <option value="4">Collection pancréatique ou nécrose de la graisse (4 points)</option>
    </select>
    <label for="ctsiNecrose">Score de nécrose :</label>
    <select id="ctsiNecrose">
      <option value="0">Aucune nécrose (0 points)</option>
      <option value="2">Nécrose < 30% (2 points)</option>
      <option value="4">Nécrose > 30% (4 points)</option>
    </select>
    <label>
      <input type="checkbox" id="ctsiExtra"> Complications extrapancréatiques (ajoute 2 points)
    </label>
    <br>
    <button onclick="calculCTSIModifie()">Calculer le CTSI modifié</button>
    <div class="result" id="resultCTSI"></div>
    <p><em>Score total maximum = 10 points</em></p>

    <script>
   // CTSI Modifié
    function calculCTSIModifie() {
      const inflammation = parseInt(document.getElementById('ctsiInflammation').value);
      const necrose = parseInt(document.getElementById('ctsiNecrose').value);
      const extra = document.getElementById('ctsiExtra').checked ? 2 : 0;
      const score = inflammation + necrose + extra;
      document.getElementById('resultCTSI').innerText = "CTSI modifié = " + score + " / 10";
    }
    </script>
  </div>
<!-- FIB4 -->
   <div id="moduleFIB" class="module">  
    <h2>FIB-4</h2>
    <label for="fib4Age">Âge (années) :</label>
    <input type="number" id="fib4Age">
    <label for="fib4AST">AST (U/L) :</label>
    <input type="number" id="fib4AST">
    <label for="fib4ALT">ALT (U/L) :</label>
    <input type="number" id="fib4ALT">
    <label for="fib4Platelets">Plaquettes (×10⁹/L) :</label>
    <input type="number" id="fib4Platelets" step="0.1">
    <br>
    <button onclick="calculFIB4()">Calculer le FIB-4</button>
    <div class="result" id="resultFIB4"></div>

    <script>
// FIB-4
    function calculFIB4() {
      const age = parseFloat(document.getElementById('fib4Age').value);
      const AST = parseFloat(document.getElementById('fib4AST').value);
      const ALT = parseFloat(document.getElementById('fib4ALT').value);
      const platelets = parseFloat(document.getElementById('fib4Platelets').value);
      if (isNaN(age) || isNaN(AST) || isNaN(ALT) || isNaN(platelets) || ALT <= 0 || platelets <= 0) {
        document.getElementById('resultFIB4').innerText = "Veuillez saisir des valeurs valides.";
        return;
      }
      const score = (age * AST) / (platelets * Math.sqrt(ALT));
      document.getElementById('resultFIB4').innerText = "FIB-4 = " + score.toFixed(2);
    }
    </script>
  </div>
  <!-- Forrest -->
   <div id="moduleForest" class="module"> 
 
    <h3>Classification de Forrest (Hémorragie d'ulcère gastroduodénal)</h3>
    <label for="forrestSelect">Sélectionnez la classification :</label>
    <select id="forrestSelect">
      <option value="Ia">Ia - Hémorragie artérielle active</option>
      <option value="Ib">Ib - Hémorragie non artérielle active</option>
      <option value="IIa">IIa - Vaisseau visible</option>
      <option value="IIb">IIb - Caillot adhérent</option>
      <option value="IIc">IIc - Marquage pigmentaire</option>
      <option value="III">III - Fond d’ulcère propre</option>
    </select>
    <br>
    <button onclick="afficheForrest()">Afficher la classification sélectionnée</button>
    <div class="result" id="resultForrest"></div>
 
    <script>
// Forrest
    function afficheForrest() {
      const classification = document.getElementById('forrestSelect').value;
      document.getElementById('resultForrest').innerText = "Classification de Forrest sélectionnée : " + classification;
    }

    </script>
  </div>
<!-- Bristol -->
   <div id="moduleBristol" class="module"> 
    <h2>Échelle de Bristol</h2>
    <label for="bristolSelect">Sélectionnez le type de selles :</label>
    <select id="bristolSelect">
      <option value="1">Type 1 : Selles en forme de noix dures</option>
      <option value="2">Type 2 : Saucisse grumeleuse</option>
      <option value="3">Type 3 : Saucisse avec fissures en surface</option>
      <option value="4">Type 4 : Saucisse lisse et molle</option>
      <option value="5">Type 5 : Morceaux mous aux bords définis</option>
      <option value="6">Type 6 : Morceaux mous, pâteux</option>
      <option value="7">Type 7 : Liquide, sans morceaux solides</option>
    </select>
    <br>
    <button onclick="calculBristol()">Afficher l'interprétation</button>
    <div class="result" id="resultBristol"></div>

    <script>
// Bristol
    function calculBristol() {
      const type = document.getElementById('bristolSelect').value;
      let interpretation = "";
      switch(parseInt(type)) {
        case 1:
        case 2:
          interpretation = "Constipation";
          break;
        case 3:
        case 4:
          interpretation = "Selles de consistance normale";
          break;
        case 5:
          interpretation = "Selles légèrement molles";
          break;
        case 6:
        case 7:
          interpretation = "Diarrhée";
          break;
        default:
          interpretation = "Non défini";
      }
      document.getElementById('resultBristol').innerText = "Interprétation : " + interpretation;
    }
    </script>
  </div>
<!-- Module - Conduite à tenir MICI - Outil décisionnel  --->
<div id="moduleMICI" class="module">
  <form id="formMICI">
    <h3>Conduite à tenir MICI - Outil décisionnel</h3>

    <div class="section">
      <h2>Données cliniques</h2>
      <div id="clinicalData">
        <label class="required">
          Type de MICI:
          <select id="diseaseType" required>
            <option value="">--Sélectionner--</option>
            <option value="crohn">Maladie de Crohn</option>
            <option value="rch">Rectocolite Hémorragique</option>
          </select>
        </label>

        <label class="required">
          Score endoscopique:
          <select id="endoscopicScore" required>
            <option value="">--Choisir le score--</option>
            <optgroup label="RCH (Mayo)">
              <option value="0">Mayo 0: Rémission</option>
              <option value="1">Mayo 1: Légère</option>
              <option value="2">Mayo 2: Modérée</option>
              <option value="3">Mayo 3: Sévère</option>
            </optgroup>
            <optgroup label="Crohn (SES-CD)">
              <option value="0-2">0-2: Rémission</option>
              <option value="3-6">3-6: Légère</option>
              <option value="7-15">7-15: Modérée</option>
              <option value=">15">>15: Sévère</option>
            </optgroup>
          </select>
        </label>

        <label>
          Histologie:
          <select id="histology">
            <option value="0">Pas d'activité</option>
            <option value="1">Activité légère</option>
            <option value="2">Activité modérée</option>
            <option value="3">Activité sévère</option>
          </select>
        </label>

        <fieldset>
          <legend>Évolution:</legend>
          <label><input type="checkbox" value="rechute"> Rechutes fréquentes (>2/an)</label>
          <label><input type="checkbox" value="cortico"> Dépendance aux corticoïdes</label>
          <label><input type="checkbox" value="complication"> Complications (sténose/fistule)</label>
        </fieldset>
      </div>
    </div>

    <div class="section">
      <h2>Conduite à tenir recommandée</h2>
      <!-- Utilisation d'un attribut data-action au lieu d'un onclick inline -->
      <button type="button" data-action="generateRecommendation">Générer la recommandation</button>
      <div id="recommendation" class="result"></div>
    </div>
  </form>

  <div class="section">
    <h3>Références</h3>
    <ul>
      <li>ECCO Guidelines 2023</li>
      <li>Recommandations SNFGE 2022</li>
    </ul>
  </div>
</div>

<script>
  (function(){
    // Isolation du module : on limite la portée du code à "moduleMICI"
    const moduleContainer = document.getElementById('moduleMICI');

    function getSeverityLevel(score) {
      if(score === "0" || score === "0-2") return 'rémission';
      if(score === "1" || score === "3-6") return 'légère';
      if(score === "2" || score === "7-15") return 'modérée';
      return 'sévère';
    }

    function getPrognosis(diseaseType, score) {
      const mayoPrognosis = {
        "0": "Risque de rechute <10%",
        "1": "Risque de rechute 20-30%",
        "2": "Risque de rechute 40-50%",
        "3": "Risque de rechute >60%"
      };

      const sescdPrognosis = {
        "0-2": "Risque de complication 10%",
        "3-6": "Risque de complication 25%",
        "7-15": "Risque de complication 45%",
        ">15": "Risque de complication 70%"
      };

      return diseaseType === 'rch' 
              ? mayoPrognosis[score.split(":")[0].trim()] 
              : sescdPrognosis[score];
    }

    function generateRecommendation() {
      // Sélection des éléments uniquement dans le module en cours
      const diseaseType = moduleContainer.querySelector('#diseaseType').value;
      const endoscopicScore = moduleContainer.querySelector('#endoscopicScore').value;
      const histology = moduleContainer.querySelector('#histology').value;
      const evolution = Array.from(moduleContainer.querySelectorAll('input[type=checkbox]:checked')).map(cb => cb.value);

      if(!diseaseType || !endoscopicScore) {
          alert("Veuillez remplir les champs obligatoires (*)");
          return;
      }

      let recommendation = "<h3>Stratégie thérapeutique recommandée:</h3>";
      
      // Logique de décision basée sur les scores
      const severity = getSeverityLevel(endoscopicScore);
      const isSevere = severity === 'sévère';
      const hasComplications = evolution.includes('complication');
      const isSteroidDependent = evolution.includes('cortico');

      // Définition des traitements
      let treatments = [];
      if(severity === 'rémission') {
          treatments.push("Maintenance: 5-ASA ou immunomodulateurs");
      } else {
          treatments.push("Induction: Corticoïdes topiques/systémiques");
          
          if(isSevere || parseInt(histology) >= 2 || isSteroidDependent) {
              treatments.push("Thérapie de rattrapage: Anti-TNF (Infliximab/Adalimumab)");
              if(diseaseType === 'crohn') {
                treatments.push("Azathioprine en combothérapie");
              }
          }
          if(hasComplications) {
              treatments.push("Antibiothérapie si infection<br>Chirurgie si nécessaire");
          }
      }

      recommendation += "<ul>";
      treatments.forEach(t => recommendation += `<li>${t}</li>`);
      recommendation += "</ul>";

      // Ajout du pronostic endoscopique
      recommendation += "<h3>Pronostic endoscopique:</h3>";
      recommendation += getPrognosis(diseaseType, endoscopicScore);

      moduleContainer.querySelector('#recommendation').innerHTML = recommendation;
    }

    // Attachement de l'événement sur le bouton spécifique à ce module
    moduleContainer.querySelector('[data-action="generateRecommendation"]')
                   .addEventListener('click', function(e) {
      e.preventDefault();
      generateRecommendation();
    });
  })();
</script>

  <!-- Module: Régime Alimentaire Personnalisé par Pathologie -->
<div id="moduleRegime" class="module">
  <h3></h3>Régime Alimentaire Personnalisé par Pathologie</h3>
  <form id="formRegime">
    <!-- Informations du Patient -->
    <section class="form-section">
      <h2>Informations du Patient</h2>
      <label for="nom_prenom_reg">Nom et Prénom :</label>
      <input type="text" id="nom_prenom_reg" placeholder="Entrez le nom et prénom">
      
      <label for="age_reg">Âge :</label>
      <input type="number" id="age_reg" placeholder="Entrez l'âge" min="0">
      
      <label for="sexe_reg">Sexe :</label>
      <select id="sexe_reg">
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
      </select>
      
      <label for="poids_reg">Poids (kg) :</label>
      <input type="number" id="poids_reg" placeholder="Entrez le poids" min="0">
      
      <label for="taille_reg">Taille (cm) :</label>
      <input type="number" id="taille_reg" placeholder="Entrez la taille" min="0">
      
      <label for="activite_reg">Niveau d'activité physique :</label>
      <select id="activite_reg">
        <option value="sedentaire">Sédentaire</option>
        <option value="leger">Légèrement actif</option>
        <option value="modere">Modérément actif</option>
        <option value="intense">Très actif</option>
      </select>
    </section>
    
    <!-- Sélection de la Pathologie -->
    <section class="form-section">
      <h2>Pathologie Ciblée</h2>
      <label for="pathologie_reg">Sélectionnez la pathologie :</label>
      <select id="pathologie_reg">
        <option value="">-- Sélectionnez --</option>
        <option value="MICI">MICI (Maladie Inflammatoire Chronique de l'Intestin)</option>
        <option value="RGO">RGO (Reflux Gastro-Œsophagien)</option>
        <option value="Coeliaque">Maladie Cœliaque</option>
        <option value="ColonIrritable">Syndrome du Côlon Irritable</option>
        <option value="Pancreatite">Pancréatite Chronique</option>
        <option value="Sigmoidite">Sigmoidite Diverticulaire</option>
        <!-- Nouveaux ajouts pour les cancers du tube digestif -->
        <option value="EsophageCancer">Cancer de l'Œsophage</option>
        <option value="EstomacCancer">Cancer de l'Estomac</option>
        <option value="ColonCancer">Cancer du Côlon</option>
        <option value="PancreasCancer">Cancer du Pancréas</option>
        <!-- Nouveaux ajouts pour le diabète différencié -->
        <option value="DiabeteType1">Diabète Type 1</option>
        <option value="DiabeteType2">Diabète Type 2</option>
      </select>
    </section>
    
    <button type="button" onclick="calculateRegime()">Générer le régime alimentaire</button>
  </form>
  
  <div id="resultRegime" class="result"></div>
  
  <script>
    function calculateRegime() {
      // Récupération des informations du patient
      var nomPrenom = document.getElementById("nom_prenom_reg").value;
      var age = parseFloat(document.getElementById("age_reg").value) || 0;
      var sexe = document.getElementById("sexe_reg").value;
      var poids = parseFloat(document.getElementById("poids_reg").value) || 0;
      var taille = parseFloat(document.getElementById("taille_reg").value) || 0;
      var activite = document.getElementById("activite_reg").value;
      var pathologie = document.getElementById("pathologie_reg").value;
      
      // Calcul du BMI (taille en cm convertie en m)
      var bmi = (poids / Math.pow(taille / 100, 2)).toFixed(2);
      var bmiCategory = "";
      if (bmi < 18.5) {
        bmiCategory = "Insuffisance pondérale";
      } else if (bmi < 25) {
        bmiCategory = "Poids normal";
      } else if (bmi < 30) {
        bmiCategory = "Surpoids";
      } else {
        bmiCategory = "Obésité";
      }
      
      // Calcul des besoins énergétiques selon la formule de Harris-Benedict
      var besoinsCaloriques = 0;
      if (sexe === "Homme") {
        besoinsCaloriques = 66 + (13.7 * poids) + (5 * taille) - (6.8 * age);
      } else {
        besoinsCaloriques = 655 + (9.6 * poids) + (1.8 * taille) - (4.7 * age);
      }
      // Ajustement selon l'activité physique
      switch (activite) {
        case "sedentaire":
          besoinsCaloriques *= 1.2;
          break;
        case "leger":
          besoinsCaloriques *= 1.375;
          break;
        case "modere":
          besoinsCaloriques *= 1.55;
          break;
        case "intense":
          besoinsCaloriques *= 1.725;
          break;
      }
      besoinsCaloriques = Math.round(besoinsCaloriques);
      
      // Construction du résumé du patient
      var plan = "<strong>Résumé du Patient :</strong><br>";
      plan += "Nom et Prénom : " + nomPrenom + "<br>";
      plan += "Âge : " + age + " ans, Sexe : " + sexe + "<br>";
      plan += "BMI : " + bmi + " kg/m² (" + bmiCategory + ")<br>";
      plan += "Besoins caloriques estimés : " + besoinsCaloriques + " kcal/jour<br><br>";
      
      // Recommandations générales
      plan += "<strong>Recommandations Générales :</strong><br>";
      plan += "• Adopter une alimentation équilibrée et adaptée aux besoins énergétiques.<br>";
      plan += "• Privilégier des repas fractionnés et réguliers.<br>";
      plan += "• Favoriser des aliments riches en nutriments tout en limitant les sucres simples.<br><br>";
      
      // Recommandations spécifiques en fonction de la pathologie sélectionnée
      if (pathologie === "") {
        plan += "<em>Veuillez sélectionner une pathologie pour afficher des recommandations spécifiques et un menu adapté.</em>";
      } else {
        switch (pathologie) {
          case "MICI":
            plan += "<strong>Recommandations pour la MICI :</strong><br>";
            plan += "• En phase de poussée : privilégier un régime pauvre en fibres et facile à digérer.<br>";
            plan += "• En phase de rémission : réintroduire progressivement les fibres.<br>";
            break;
          case "RGO":
            plan += "<strong>Recommandations pour le RGO :</strong><br>";
            plan += "• Opter pour de petits repas fréquents et éviter les aliments acides ou gras.<br>";
            break;
          case "Coeliaque":
            plan += "<strong>Recommandations pour la Maladie Cœliaque :</strong><br>";
            plan += "• Suivre un régime strict sans gluten (éviter blé, orge, seigle, et avoine non certifiée).<br>";
            break;
          case "ColonIrritable":
            plan += "<strong>Recommandations pour le Syndrome du Côlon Irritable :</strong><br>";
            plan += "• Suivre un régime pauvre en FODMAPs afin de réduire les symptômes.<br>";
            break;
          case "Pancreatite":
            plan += "<strong>Recommandations pour la Pancréatite Chronique :</strong><br>";
            plan += "• Adopter un régime pauvre en graisses et fractionner les repas.<br>";
            break;
          case "Sigmoidite":
            plan += "<strong>Recommandations pour la Sigmoidite Diverticulaire :</strong><br>";
            plan += "• En phase de rémission : privilégier un régime riche en fibres.<br>";
            plan += "• En phase aiguë : opter pour un régime pauvre en fibres et bien s'hydrater.<br>";
            break;
          case "EsophageCancer":
            plan += "<strong>Recommandations pour le Cancer de l'Œsophage :</strong><br>";
            plan += "• Pour les patients présentant une dysphagie, privilégier des aliments faciles à avaler (par exemple, aliments mixés ou liquéfiés).<br>";
            plan += "• En cas de prothèse ou de traitements (chimiothérapie/radiothérapie), adapter l'alimentation pour minimiser les douleurs et maintenir un bon apport énergétique.<br>";
            break;
          case "EstomacCancer":
            plan += "<strong>Recommandations pour le Cancer de l'Estomac :</strong><br>";
            plan += "• Privilégier des aliments légers et faciles à digérer.<br>";
            plan += "• Fractionner les repas et tenir compte des effets secondaires des traitements.<br>";
            break;
          case "ColonCancer":
            plan += "<strong>Recommandations pour le Cancer du Côlon :</strong><br>";
            plan += "• Adapter l'alimentation aux suites de la chirurgie et/ou de la chimiothérapie en favorisant des protéines de qualité et des aliments faciles à digérer.<br>";
            break;
          case "PancreasCancer":
            plan += "<strong>Recommandations pour le Cancer du Pancréas :</strong><br>";
            plan += "• Assurer un apport protéique suffisant et adapter l'alimentation aux troubles digestifs et aux traitements.<br>";
            break;
          case "DiabeteType1":
            plan += "<strong>Recommandations pour le Diabète Type 1 :</strong><br>";
            plan += "• Adapter les apports glucidiques en fonction des doses d'insuline.<br>";
            plan += "• Privilégier les glucides complexes et fractionner les repas.<br>";
            break;
          case "DiabeteType2":
            plan += "<strong>Recommandations pour le Diabète Type 2 :</strong><br>";
            plan += "• Privilégier des aliments à faible indice glycémique et riches en fibres.<br>";
            plan += "• Favoriser les protéines maigres et encourager une activité physique régulière.<br>";
            break;
          default:
            plan += "<em>Aucune recommandation spécifique n'est disponible pour cette pathologie.</em><br>";
        }
        // Ajout de l'exemple de menu hebdomadaire adapté à la pathologie
        plan += "<br><strong>Exemple de Menu Hebdomadaire :</strong><br>";
        plan += getMenuForPathologie(pathologie);
      }
      
      document.getElementById("resultRegime").innerHTML = plan;
    }
    
    // Fonction qui retourne un exemple de menu selon la pathologie sélectionnée
    function getMenuForPathologie(pathologie) {
      var menu = "";
      switch (pathologie) {
        case "MICI":
          menu = generateWeeklyMenuMICI();
          break;
        case "RGO":
          menu = generateWeeklyMenuRGO();
          break;
        case "Coeliaque":
          menu = generateWeeklyMenuCoeliaque();
          break;
        case "ColonIrritable":
          menu = generateWeeklyMenuColonIrritable();
          break;
        case "Pancreatite":
          menu = generateWeeklyMenuPancreatite();
          break;
        case "Sigmoidite":
          menu = generateWeeklyMenuSigmoidite();
          break;
        case "EsophageCancer":
          menu = generateWeeklyMenuEsophageCancer();
          break;
        case "EstomacCancer":
          menu = generateWeeklyMenuEstomacCancer();
          break;
        case "ColonCancer":
          menu = generateWeeklyMenuColonCancer();
          break;
        case "PancreasCancer":
          menu = generateWeeklyMenuPancreasCancer();
          break;
        case "DiabeteType1":
          menu = generateWeeklyMenuDiabeteType1();
          break;
        case "DiabeteType2":
          menu = generateWeeklyMenuDiabeteType2();
          break;
        default:
          menu = "<em>Aucun menu disponible.</em>";
      }
      return menu;
    }
    
    // Fonctions de génération de menus hebdomadaires (exemples simplifiés)
    function generateWeeklyMenuMICI() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Flocons d'avoine, compote de pommes, yaourt nature.</li>
              <li><strong>Déjeuner :</strong> Purée de carottes, poulet vapeur, riz blanc.</li>
              <li><strong>Collation :</strong> Banane et amandes.</li>
              <li><strong>Dîner :</strong> Soupe de courgettes, poisson vapeur, pommes de terre bouillies.</li>
            </ul>
          </li>
          <li><strong>Mardi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Omelette aux épinards et pain complet.</li>
              <li><strong>Déjeuner :</strong> Velouté de potiron, dinde rôtie, pâtes blanches.</li>
              <li><strong>Collation :</strong> Yaourt nature et fruits frais.</li>
              <li><strong>Dîner :</strong> Purée de patate douce, cabillaud au four, carottes cuites.</li>
            </ul>
          </li>
        </ul>
      `;
    }
    
    function generateWeeklyMenuRGO() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Flocons d'avoine, banane, yaourt nature.</li>
              <li><strong>Déjeuner :</strong> Poulet grillé, riz complet, haricots verts vapeur.</li>
              <li><strong>Collation :</strong> Compote de pommes, amandes.</li>
              <li><strong>Dîner :</strong> Saumon vapeur, quinoa, courgettes cuites.</li>
            </ul>
          </li>
        </ul>
      `;
    }
    
    function generateWeeklyMenuCoeliaque() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Smoothie bowl aux fruits et granola sans gluten.</li>
              <li><strong>Déjeuner :</strong> Salade de quinoa aux légumes grillés et pois chiches.</li>
              <li><strong>Collation :</strong> Pomme et beurre de cacahuète sans gluten.</li>
              <li><strong>Dîner :</strong> Filet de poisson vapeur, riz basmati, brocolis vapeur.</li>
            </ul>
          </li>
        </ul>
      `;
    }
    
    function generateWeeklyMenuColonIrritable() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Flocons d'avoine avec lait d'amande et myrtilles.</li>
              <li><strong>Déjeuner :</strong> Salade de poulet grillé avec roquette, carottes et concombre, assaisonnée d'huile d'olive.</li>
              <li><strong>Collation :</strong> Orange.</li>
              <li><strong>Dîner :</strong> Saumon vapeur, riz blanc, haricots verts vapeur.</li>
            </ul>
          </li>
        </ul>
      `;
    }
    
    function generateWeeklyMenuPancreatite() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Riz au lait écrémé avec compote de pommes sans sucre ajouté.</li>
              <li><strong>Déjeuner :</strong> Blanc de poulet vapeur, purée de carottes, riz blanc.</li>
              <li><strong>Collation :</strong> Banane et biscuits secs.</li>
              <li><strong>Dîner :</strong> Soupe de légumes claire avec pain blanc.</li>
            </ul>
          </li>
        </ul>
      `;
    }
    
    function generateWeeklyMenuEsophageCancer() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Smoothie léger (banane, lait d'amande, compote) et toast de pain sans gluten, facile à avaler.</li>
              <li><strong>Déjeuner :</strong> Velouté de légumes, purée de pommes de terre et filet de poisson vapeur, adapté aux difficultés de déglutition.</li>
              <li><strong>Collation :</strong> Yaourt nature et compote.</li>
              <li><strong>Dîner :</strong> Soupe mixée, poulet effiloché et riz bien cuit.</li>
            </ul>
          </li>
        </ul>
      `;
    }
    
    function generateWeeklyMenuEstomacCancer() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Porridge léger aux flocons de riz avec compote et une tisane.</li>
              <li><strong>Déjeuner :</strong> Purée de légumes, blanc de dinde vapeur, riz blanc bien cuit.</li>
              <li><strong>Collation :</strong> Yaourt nature et compote de poires.</li>
              <li><strong>Dîner :</strong> Soupe mixée et poisson maigre cuit à la vapeur.</li>
            </ul>
          </li>
        </ul>
      `;
    }
    
    function generateWeeklyMenuColonCancer() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Toast sans gluten avec avocat écrasé et compote.</li>
              <li><strong>Déjeuner :</strong> Salade de quinoa, légumes cuits et poulet grillé, avec un bouillon léger.</li>
              <li><strong>Collation :</strong> Smoothie aux fruits et lait d'amande.</li>
              <li><strong>Dîner :</strong> Soupe de légumes mixée et poisson vapeur.</li>
            </ul>
          </li>
        </ul>
      `;
    }
    
    function generateWeeklyMenuPancreasCancer() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Smoothie protéiné léger (lait d'amande, banane, protéine végétale) et toast sans gluten.</li>
              <li><strong>Déjeuner :</strong> Purée de légumes, blanc de poulet ou dinde, riz complet bien cuit.</li>
              <li><strong>Collation :</strong> Yaourt nature avec compote.</li>
              <li><strong>Dîner :</strong> Soupe mixée et poisson vapeur.</li>
            </ul>
          </li>
        </ul>
      `;
    }
    
    function generateWeeklyMenuDiabeteType1() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Pain complet avec fromage frais allégé et crudités, accompagné d'un fruit.</li>
              <li><strong>Déjeuner :</strong> Salade composée avec œufs durs, légumes variés et poulet grillé, en portions contrôlées.</li>
              <li><strong>Collation :</strong> Amandes et pomme.</li>
              <li><strong>Dîner :</strong> Poisson vapeur, quinoa, légumes verts.</li>
            </ul>
          </li>
        </ul>
      `;
    }
    
    function generateWeeklyMenuDiabeteType2() {
      return `
        <ul>
          <li><strong>Lundi :</strong>
            <ul>
              <li><strong>Petit-déjeuner :</strong> Porridge aux flocons d'avoine avec lait d'amande et baies, agrémenté de cannelle.</li>
              <li><strong>Déjeuner :</strong> Salade de pois chiches, légumes crus, quinoa et vinaigrette légère.</li>
              <li><strong>Collation :</strong> Yaourt nature et une poire.</li>
              <li><strong>Dîner :</strong> Filet de dinde, riz complet et légumes vapeur.</li>
            </ul>
          </li>
        </ul>
      `;
    }
  </script>
</div>
<!-- Module: Prise en charge de la fissure anale -->
<div id="moduleFissureAnale" class="module">
  <h3>Prise en charge de la fissure anale</h3>
  
  <form id="formFissureAnale">
    <!-- Section 1 : Informations du patient -->
    <section class="form-section">
      <h3>Informations du patient</h3>
      <label for="fa_age">Âge :</label>
      <input type="number" id="fa_age" placeholder="Entrez l'âge" min="0" required>
      
      <label for="fa_sexe">Sexe :</label>
      <select id="fa_sexe" required>
        <option value="">--Sélectionner--</option>
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
      </select>
      <div class="error-message" data-error-for="fa_sexe" style="display:none; color:red;">
        Veuillez sélectionner un sexe.
      </div>
    </section>
    
    <!-- Section 2 : Description de la fissure anale -->
    <section class="form-section">
      <h3>Description de la fissure anale</h3>
      <label for="fa_localisation">Localisation :</label>
      <select id="fa_localisation">
        <option value="">--Sélectionner--</option>
        <option value="Postérieure">Postérieure (la plus fréquente)</option>
        <option value="Antérieure">Antérieure</option>
        <option value="Latérale">Latérale</option>
      </select>
      <br><br>
      
      <label for="fa_type">Type de fissure :</label>
      <select id="fa_type">
        <option value="">--Sélectionner--</option>
        <option value="Simple">Fissure simple</option>
        <option value="Compliquée_satellites">Compliquée (avec éléments satellites)</option>
        <option value="Compliquée_fistule">Compliquée (avec trajet fistuleux)</option>
      </select>
      <br><br>
      
      <label for="fa_description">Description / Observation :</label><br>
      <textarea id="fa_description" rows="3" placeholder="Décrivez la fissure (forme, aspect, douleur, saignement, hypertonie, etc.)"></textarea>
      <br><br>
      
      <label><input type="checkbox" id="fa_douleurIntense"> Douleur intense (sensation de brûlure, « coup de couteau »)</label><br>
      <label><input type="checkbox" id="fa_saignement"> Saignement associé</label><br>
    </section>
    
    <!-- Section 3 : Antécédents et explorations -->
    <section class="form-section">
      <h3>Antécédents et explorations</h3>
      <label for="fa_prevExam">Examens déjà réalisés (ex. endoscopie) :</label><br>
      <textarea id="fa_prevExam" rows="2" placeholder="Indiquez les examens déjà effectués et leurs résultats"></textarea>
      <br><br>
      <label for="fa_antch">Antécédents pertinents :</label><br>
      <textarea id="fa_antch" rows="2" placeholder="Décrivez brièvement les antécédents (chirurgicaux, inflammatoires, etc.)"></textarea>
    </section>
    
    <!-- Section 4 : Traitements déjà tentés -->
    <section class="form-section">
      <h3>Traitements déjà tentés</h3>
      <label><input type="checkbox" id="fa_treatmentMed"> Traitement médical (analgésiques, AINS, antispasmodiques, laxatifs)</label><br>
      <label><input type="checkbox" id="fa_topiques"> Traitement topique (dérivés nitrés, inhibiteurs calciques)</label><br>
      <label><input type="checkbox" id="fa_botox"> Injections de toxine botulique</label><br>
    </section>
    
    <button type="button" onclick="generateFissurePlan()">Générer la conduite à tenir</button>
  </form>
  
  <div id="resultFissure" class="result"></div>
</div>

<script>
function validateRequiredFieldsFissure() {
  let valid = true;
  const ageField = document.getElementById("fa_age");
  const sexeField = document.getElementById("fa_sexe");
  const errorSexe = document.querySelector('[data-error-for="fa_sexe"]');

  if (!ageField.value) {
    ageField.classList.add("invalid");
    valid = false;
  } else {
    ageField.classList.remove("invalid");
  }

  if (!sexeField.value) {
    if (errorSexe) errorSexe.style.display = "block";
    sexeField.classList.add("invalid");
    valid = false;
  } else {
    if (errorSexe) errorSexe.style.display = "none";
    sexeField.classList.remove("invalid");
  }
  return valid;
}

function generateFissurePlan() {
  if (!validateRequiredFieldsFissure()) {
    return;
  }
  
  // Récupération des informations du patient
  const age = document.getElementById("fa_age").value;
  const sexe = document.getElementById("fa_sexe").value;
  
  // Récupération des données de la fissure
  const localisation = document.getElementById("fa_localisation").value || "Non renseignée";
  const typeFissure = document.getElementById("fa_type").value || "Non renseigné";
  const description = document.getElementById("fa_description").value.trim() || "Aucune description complémentaire";
  const douleurIntense = document.getElementById("fa_douleurIntense").checked;
  const saignement = document.getElementById("fa_saignement").checked;
  
  // Récupération des antécédents et explorations
  const prevExam = document.getElementById("fa_prevExam").value.trim() || "Non renseigné";
  const antch = document.getElementById("fa_antch").value.trim() || "Non renseigné";
  
  // Récupération des traitements déjà tentés
  const treatmentMed = document.getElementById("fa_treatmentMed").checked;
  const topiques = document.getElementById("fa_topiques").checked;
  const botox = document.getElementById("fa_botox").checked;
  
  // Construction du résumé
  let summary = "<strong>Résumé de la fissure anale</strong><br>";
  summary += "Patient de " + age + " ans, " + sexe + ".<br>";
  summary += "Localisation : " + localisation + ".<br>";
  summary += "Type de fissure : " + typeFissure + ".<br>";
  summary += "Description : " + description + ".<br>";
  summary += "Douleur : " + (douleurIntense ? "Intense" : "Modérée") + (saignement ? " avec saignement" : "") + ".<br>";
  summary += "Examens déjà réalisés : " + prevExam + ".<br>";
  summary += "Antécédents pertinents : " + antch + ".<br><br>";
  
  // Proposition de prise en charge
  let planText = "<strong>Proposition de prise en charge :</strong><br>";
  if (typeFissure === "Simple") {
    planText += "• Traitement médical de première intention : soulagement antalgique et mesures favorisant la cicatrisation.<br>";
  } else if (typeFissure.indexOf("Compliquée") !== -1) {
    planText += "• Prise en charge chirurgicale recommandée : évaluation pour sphinctérotomie latérale interne ou fissurectomie associée à une anoplastie.<br>";
  }
  if (douleurIntense) {
    planText += "• Traitement antalgique initial pour faciliter l'examen clinique ultérieur.<br>";
  }
  if (saignement) {
    planText += "• Surveillance renforcée du saignement, avec bilan approfondi si persistant.<br>";
  }
  
  // Ajout d'une section "Ordonnance type et conseils" en fonction du type de fissure
  let ordonnanceText = "<strong>Ordonnance type et conseils :</strong><br>";
  if (typeFissure === "Simple") {
    ordonnanceText += "• Paracétamol 500 mg, 1 comprimé 3-4 fois par jour.<br>";
    ordonnanceText += "• Mébévérine 135 mg, 1 comprimé trois fois par jour.<br>";
    ordonnanceText += "• Topique : Application d'un dérivé nitré (si toléré) 2 fois par jour.<br>";
    ordonnanceText += "Conseils : Adopter un régime favorisant des selles molles (riches en fibres et en eau), éviter les aliments irritants, prendre des bains de siège chauds et maintenir une bonne hygiène locale.<br>";
  } else if (typeFissure.indexOf("Compliquée") !== -1) {
    ordonnanceText += "• En attente d'une prise en charge chirurgicale, traitement antalgique : Paracétamol 500 mg, 1 comprimé 3-4 fois par jour.<br>";
    ordonnanceText += "• Mébévérine 135 mg, 1 comprimé trois fois par jour.<br>";
    ordonnanceText += "Conseils : Consulter un spécialiste en chirurgie proctologique pour évaluer la nécessité d'une sphinctérotomie latérale interne ou d'une fissurectomie/anoplastie ; adapter l'alimentation pour faciliter la cicatrisation et suivre les recommandations post-opératoires.<br>";
  } else {
    ordonnanceText += "• Aucun traitement spécifique n'est recommandé pour le moment.<br>";
  }
  
  // Assemblage final du rapport
  const finalReport = summary + planText + ordonnanceText;
  document.getElementById("resultFissure").innerHTML = finalReport;
}

document.addEventListener('DOMContentLoaded', () => {
  // Code de chargement ou d'initialisation éventuel
});
</script>
</div>
<!-- Module: Gestion du reflux gastro-œsophagien (RGO) -->
<div id="moduleRGO" class="module">
  <h2>Gestion du reflux gastro-œsophagien (RGO)</h2>
  <form id="formRGO">
    <!-- Informations du patient -->
    <section class="form-section">
      <h3>Informations du patient</h3>
      <label for="rgo_age">Âge :</label>
      <input type="number" id="rgo_age" placeholder="Entrez l'âge" min="0" required>
      
      <label for="rgo_sexe">Sexe :</label>
      <select id="rgo_sexe" required>
        <option value="">--Sélectionner--</option>
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
      </select>
    </section>
    
    <!-- Symptômes et explorations -->
    <section class="form-section">
      <h3>Symptomatologie et explorations</h3>
      <label><input type="checkbox" id="rgo_heartburn"> Pyrosis (brûlures)</label><br>
      <label><input type="checkbox" id="rgo_regurgitation"> Régurgitations acides</label><br>
      <label for="rgo_frequency">Fréquence (fois/semaine) :</label>
      <input type="number" id="rgo_frequency" placeholder="Ex. 4"><br>
      <label for="rgo_otherSymptoms">Autres symptômes :</label><br>
      <textarea id="rgo_otherSymptoms" rows="2" placeholder="Décrivez ici"></textarea><br>
      <label for="rgo_prevExam">Explorations déjà réalisées :</label><br>
      <textarea id="rgo_prevExam" rows="2" placeholder="Résultats d'endoscopie, pH-métrie, etc."></textarea>
    </section>
    
    <!-- Traitements déjà tentés -->
    <section class="form-section">
      <h3>Traitements déjà tentés</h3>
      <label><input type="checkbox" id="rgo_lifestyle"> Modifications du mode de vie (alimentation, élévation du lit)</label><br>
      <label><input type="checkbox" id="rgo_ppi"> Inhibiteurs de la pompe à protons (IPP)</label><br>
      <label><input type="checkbox" id="rgo_h2"> Antagonistes H2</label>
    </section>
    
    <button type="button" onclick="generateRGOPlan()">Générer la conduite à tenir</button>
  </form>
  
  <div id="resultRGO" class="result"></div>
</div>

<script>
function generateRGOPlan() {
  // Récupération des informations
  const age = document.getElementById("rgo_age").value;
  const sexe = document.getElementById("rgo_sexe").value;
  const heartburn = document.getElementById("rgo_heartburn").checked;
  const regurgitation = document.getElementById("rgo_regurgitation").checked;
  const frequency = document.getElementById("rgo_frequency").value || "Non renseigné";
  const otherSymptoms = document.getElementById("rgo_otherSymptoms").value.trim();
  const prevExam = document.getElementById("rgo_prevExam").value.trim() || "Non renseigné";
  
  let treatments = [];
  if(document.getElementById("rgo_lifestyle").checked) treatments.push("Modifications du mode de vie");
  if(document.getElementById("rgo_ppi").checked) treatments.push("IPP");
  if(document.getElementById("rgo_h2").checked) treatments.push("Antagonistes H2");
  
  let summary = "<strong>Résumé du RGO</strong><br>";
  summary += "Patient de " + age + " ans, " + sexe + ".<br>";
  summary += "Symptomatologie : " + (heartburn ? "pyrosis" : "") + (regurgitation ? (heartburn ? ", " : "") + "régurgitations acides" : "") + ".<br>";
  summary += "Fréquence des symptômes : " + frequency + " fois par semaine.<br>";
  if(otherSymptoms) summary += "Autres symptômes : " + otherSymptoms + ".<br>";
  summary += "Explorations réalisées : " + prevExam + ".<br>";
  summary += "Traitements déjà tentés : " + (treatments.length ? treatments.join(", ") : "Aucun") + ".<br><br>";
  
  let planText = "<strong>Proposition de prise en charge :</strong><br>";
  if(heartburn || regurgitation) {
    planText += "• Indication de bilan endoscopique et pH-métrie pour évaluer la sévérité du RGO.<br>";
    planText += "• Indication de traitement par IPP, associé à des modifications du mode de vie.<br>";
    
    // Ordonnance type et conseils
    planText += "<strong>Ordonnance type et conseils :</strong><br>";
    planText += "   - IPP (ex. Oméprazole 20 mg) : 1 comprimé par jour, à prendre 30 minutes avant le repas.<br>";
    planText += "   - Conseils : adopter une alimentation pauvre en graisses, éviter les aliments déclencheurs (agrumes, café, alcool), et élever la tête du lit pendant la nuit.<br>";
  } else {
    planText += "• Indication de surveillance clinique et évaluation régulière.<br>";
    planText += "<strong>Ordonnance type et conseils :</strong><br>";
    planText += "   - Conseils : modification du mode de vie, régulation de l'alimentation et suivi symptomatique.<br>";
  }
  
  document.getElementById("resultRGO").innerHTML = summary + planText;
}
</script>
</div>


<!-- Module: Colite aiguë grave : Diagnostic et Prise en charge  -->
<div id="moduleColiteAigueGrave" class="module">
  <h3>Colite aiguë grave : Diagnostic et Prise en charge (FMC Gastro 2024)</h3>
  <form id="formColiteAigueGrave">
    
    <!-- Section 1 : Critères de gravité (Truelove & Witts modifiés) -->
    <section class="form-section">
      <h3>Critères de gravité (Truelove & Witts modifiés)</h3>
      <label for="cag_selles">Nombre de selles sanglantes/jour :</label>
      <input type="number" id="cag_selles" min="0" required>
      
      <label for="cag_fc">Fréquence cardiaque (bpm) :</label>
      <input type="number" id="cag_fc" required>
      
      <label for="cag_temp">Température (°C) :</label>
      <input type="number" id="cag_temp" step="0.1" required>
      
      <label for="cag_hb">Hémoglobine (g/dL) :</label>
      <input type="number" id="cag_hb" step="0.1" required>
      
      <label for="cag_crp">CRP (mg/L) :</label>
      <input type="number" id="cag_crp" required>
    </section>

    <!-- Section 2 : Facteurs de risque associés -->
    <section class="form-section">
      <h3>Facteurs de risque associés</h3>
      <label>
        <input type="checkbox" id="cag_age_risk">
        Âge > 50 ans
      </label>
      <label>
        <input type="checkbox" id="cag_toxicite">
        Signes de toxicité systémique
      </label>
      <label>
        <input type="checkbox" id="cag_dilatation">
        Dilatation colique à l'imagerie
      </label>
    </section>

    <!-- Section 3 : Bilan complémentaire -->
    <section class="form-section">
      <h3>Bilan complémentaire</h3>
      <label for="cag_ct">Radiologie (CT abdominal) :</label>
      <select id="cag_ct">
        <option value="normal">Normal</option>
        <option value="epaisissement">Épaississement pariétal</option>
        <option value="dilatation">Dilatation colique</option>
      </select>
      
      <label for="cag_endoscopie">Endoscopie :</label>
      <select id="cag_endoscopie">
        <option value="non_realisee">Non réalisée</option>
        <option value="ulcerations">Ulcerations profondes</option>
        <option value="mucosa_denudee">Mucosa dénudée</option>
      </select>
    </section>

    <!-- Section 4 : Traitements initiés -->
    <section class="form-section">
      <h3>Traitements initiés</h3>
      <label>
        <input type="checkbox" id="cag_steroides">
        Corticoïdes IV (Hydrocortisone 400 mg/j ou Methylprednisolone 1 mg/kg/j)
      </label>
      <label>
        <input type="checkbox" id="cag_biotherapie">
        Biothérapie de rattrapage (Anti-TNFα / Vedolizumab)
      </label>
      <label>
        <input type="checkbox" id="cag_antibio">
        Antibiothérapie (si suspicion d'infection)
      </label>
    </section>

    <!-- Section 5 : Commentaires globaux -->
    <section class="form-section">
      <h3>Commentaires globaux</h3>
      <textarea id="cag_global_comments" rows="3" placeholder="Vos remarques générales sur la colite aiguë grave..."></textarea>
    </section>
    
    <button type="button" onclick="generateColiteAiguePlan()">Générer la conduite à tenir</button>
  </form>
  
  <div id="resultColiteAigue" class="result"></div>
</div>

<script>
function generateColiteAiguePlan() {
  // Récupération des critères de gravité
  const selles = parseInt(document.getElementById('cag_selles').value) || 0;
  const fc = parseInt(document.getElementById('cag_fc').value) || 0;
  const temp = parseFloat(document.getElementById('cag_temp').value) || 0;
  const hb = parseFloat(document.getElementById('cag_hb').value) || 0;
  const crp = parseInt(document.getElementById('cag_crp').value) || 0;
  
  // Récupération des facteurs de risque
  const ageRisk = document.getElementById('cag_age_risk').checked;
  const toxicite = document.getElementById('cag_toxicite').checked;
  const dilatation = document.getElementById('cag_dilatation').checked;
  
  // Récupération du bilan complémentaire
  const ctResult = document.getElementById('cag_ct').value;
  const endoscopyResult = document.getElementById('cag_endoscopie').value;
  
  // Récupération des traitements initiés
  const steroids = document.getElementById('cag_steroides').checked;
  const biotherapie = document.getElementById('cag_biotherapie').checked;
  const antibio = document.getElementById('cag_antibio').checked;
  
  // Récupération des commentaires globaux
  const globalComments = document.getElementById('cag_global_comments').value.trim() || "Aucun commentaire supplémentaire.";
  
  // Détermination de la sévérité (critères simplifiés)
  let severity = "Modérée";
  if (selles >= 6 || fc > 90 || temp > 37.8 || hb < 10.5 || crp > 30) {
    severity = "Grave";
  }
  
  // Construction du rapport
  let report = `<h4>Conduite à tenir </h4>`;
  report += `<p><strong>Critères de gravité :</strong><br>
              Selles sanglantes/jour : ${selles}<br>
              Fréquence cardiaque : ${fc} bpm<br>
              Température : ${temp} °C<br>
              Hémoglobine : ${hb} g/dL<br>
              CRP : ${crp} mg/L</p>`;
  
  report += `<p><strong>Facteurs de risque associés :</strong><br>`;
  if (ageRisk) report += "Âge > 50 ans<br>";
  if (toxicite) report += "Signes de toxicité systémique<br>";
  if (dilatation) report += "Dilatation colique à l'imagerie<br>";
  report += `</p>`;
  
  report += `<p><strong>Bilan complémentaire :</strong><br>
             Radiologie (CT abdominal) : ${ctResult}<br>
             Endoscopie : ${endoscopyResult}</p>`;
  
  // Proposition de prise en charge
  let planText = `<h4>Proposition de prise en charge :</h4>`;
  if (severity === "Grave") {
    planText += `<p><strong>Prise en charge hospitalière obligatoire</strong></p>
                  <ul>
                    <li>Administration immédiate de corticoïdes IV à dose forte (ex. Hydrocortisone 400 mg/j ou équivalent).</li>
                    <li>Monitorage strict avec bilans biologiques (2 fois/jour) et contrôle radiologique (Rx abdominale quotidienne).</li>
                    <li>Évaluation de la réponse à J3 :
                        <ul>
                          <li>Si amélioration : relais en voie per os dès J3.</li>
                          <li>Si absence d'amélioration : envisager la mise en place d'une biothérapie (ex. Anti-TNFα) ou l'administration de ciclosporine.</li>
                        </ul>
                    </li>
                    <li>Mesures de support : correction hydroélectrolytique, nutrition parentérale si nécessaire, thromboprophylaxie.</li>
                  </ul>`;
    
    if (dilatation) {
      planText += `<p class="warning"><strong>Attention :</strong> Dilatation colique détectée (> seuil critique).<br>
                     - Mettre en place une sonde de décompression rectale.<br>
                     - Positionnement latéral de sécurité recommandé.<br>
                     - En cas de perforation, intervention chirurgicale en urgence.</p>`;
    }
  } else {
    planText += `<p><strong>Prise en charge ambulatoire possible</strong> si le patient est stable et compliant.</p>
                 <ul>
                   <li>Administration de corticoïdes per os (ex. Prednisone 1 mg/kg/j).</li>
                   <li>Surveillance rapprochée avec contact quotidien.</li>
                   <li>Régime sans résidu strict.</li>
                   <li>Arrêt des anti-inflammatoires et antidiarrhéiques.</li>
                 </ul>`;
  }
  
  // Examens complémentaires à réaliser
  let examText = `<h4>Examens complémentaires à réaliser :</h4>
                  <ul>
                    <li>Bilan infectieux complet (ECBU, hémocultures, PCR pour C. difficile).</li>
                    <li>Dosage quotidien de la CRP.</li>
                    <li>Surveillance radiologique (CT ou IRM) en cas d'aggravation clinique.</li>
                  </ul>`;
  
  // Ordonnance type et conseils
  let ordonnance = `<h4>Ordonnance type et Conseils :</h4>
                    <ul>
                      <li>Corticoïdes IV (ex. Hydrocortisone 400 mg/j ou Methylprednisolone 1 mg/kg/j) avec ajustement selon la réponse.</li>
                      <li>Antibiothérapie à initier en cas de suspicion d'infection secondaire.</li>
                      <li>Soins de support : hydratation, nutrition (voie IV ou entérale) adaptée.</li>
                      <li>Surveillance clinique rapprochée (contrôle quotidien des paramètres vitaux et bilans biologiques).</li>
                    </ul>`;
  
  // Assemblage final du rapport
  const finalReport = report + planText + examText + ordonnance +
                      `<br><strong>Commentaires Globaux :</strong><br>${globalComments}`;
  
  document.getElementById('resultColiteAigue').innerHTML = finalReport;
}
</script>

<style>
  /* Styles pour le module */
  .module {
    font-family: Arial, sans-serif;
    max-width: 800px;
    margin: 20px auto;
    padding: 20px;
    background: #fdfdfd;
    border: 1px solid #ddd;
    border-radius: 8px;
  }
  .form-section {
    margin-bottom: 20px;
    padding: 15px;
    background: #fff;
    border: 1px solid #eee;
    border-radius: 5px;
  }
  label {
    display: block;
    margin-bottom: 8px;
  }
  input[type="number"],
  select,
  textarea {
    width: 100%;
    padding: 8px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 3px;
    box-sizing: border-box;
  }
  button {
    padding: 10px 20px;
    background-color: #00539C;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  button:hover {
    background-color: #003f7f;
  }
  .result {
    margin-top: 20px;
    padding: 15px;
    background: #eef;
    border-radius: 5px;
  }
  .warning {
    color: #721c24;
    background-color: #f8d7da;
    padding: 10px;
    border-radius: 3px;
  }
</style>


<!-- Module: Gestion de la colite ulcéreuse -->
<div id="moduleColiteUlcerueuse" class="module">
  <h3>Gestion de la colite ulcéreuse</h3>
  <form id="formColite">
    <!-- Informations du patient -->
    <section class="form-section">
      <h3>Informations du patient</h3>
      <label for="cu_age">Âge :</label>
      <input type="number" id="cu_age" placeholder="Entrez l'âge" min="0" required>
      
      <label for="cu_sexe">Sexe :</label>
      <select id="cu_sexe" required>
        <option value="">--Sélectionner--</option>
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
      </select>
    </section>
    
    <!-- Symptômes et activité de la maladie -->
    <section class="form-section">
      <h3>Symptomatologie et activité</h3>
      <label for="cu_frequency">Fréquence des selles (par jour) :</label>
      <input type="number" id="cu_frequency" placeholder="Ex. 8" min="0"><br>
      <label for="cu_bleeding">Présence de saignement rectal :</label>
      <select id="cu_bleeding">
        <option value="">--Sélectionner--</option>
        <option value="none">Aucun</option>
        <option value="mild">Léger</option>
        <option value="moderate">Modéré</option>
        <option value="severe">Sévère</option>
      </select>
      <br>
      <label for="cu_pain">Douleur abdominale :</label>
      <input type="text" id="cu_pain" placeholder="Décrivez la douleur">
    </section>
    
    <!-- Examens et traitements déjà réalisés -->
    <section class="form-section">
      <h3>Examens et traitements</h3>
      <label for="cu_endoscopy">Résultats d'endoscopie :</label><br>
      <textarea id="cu_endoscopy" rows="2" placeholder="Résultats, stade endoscopique (ex. Mayo)"></textarea>
      <br>
      <label for="cu_treatment">Traitements déjà effectués :</label><br>
      <textarea id="cu_treatment" rows="2" placeholder="Ex. 5-ASA, corticostéroïdes, immunomodulateurs"></textarea>
    </section>
    
    <button type="button" onclick="generateColitePlan()">Générer la conduite à tenir</button>
  </form>
  
  <div id="resultColite" class="result"></div>
</div>
</div>
    
  </div>
<script>
function generateColitePlan() {
  const age = document.getElementById("cu_age").value;
  const sexe = document.getElementById("cu_sexe").value;
  const frequency = document.getElementById("cu_frequency").value || "Non renseigné";
  const bleeding = document.getElementById("cu_bleeding").value || "Non renseigné";
  const pain = document.getElementById("cu_pain").value.trim() || "Non renseigné";
  const endoscopy = document.getElementById("cu_endoscopy").value.trim() || "Non renseigné";
  const treatment = document.getElementById("cu_treatment").value.trim() || "Non renseigné";
  
  let summary = "<strong>Résumé de la colite ulcéreuse</strong><br>";
  summary += "Patient de " + age + " ans, " + sexe + ".<br>";
  summary += "Fréquence des selles : " + frequency + " par jour<br>";
  summary += "Saignement rectal : " + bleeding + "<br>";
  summary += "Douleur abdominale : " + pain + "<br>";
  summary += "Résultats endoscopiques : " + endoscopy + "<br>";
  summary += "Traitements déjà effectués : " + treatment + "<br><br>";
  
  let planText = "<strong>Proposition de prise en charge :</strong><br>";
  // Exemple d'algorithme simple
  if(bleeding === "Sévère" || bleeding === "Modéré") {
    planText += "• Indication d'une intensification thérapeutique et de surveillance rapprochée (endoscopie dans les 3-6 mois).<br>";
  } else {
    planText += "• Indication d'une surveillance régulière (endoscopie annuelle).<br>";
  }
  
  let ordonnance = "<strong>Ordonnance type et conseils :</strong><br>";
  ordonnance += "• 5-ASA (ex. Mesalazine 2,4 g/j) en maintenance.<br>";
  ordonnance += "• Conseils : adapter l'alimentation, favoriser des repas fractionnés, maintenir une bonne hydratation et suivre un programme de surveillance endoscopique régulier.<br>";
  
  document.getElementById("resultColite").innerHTML = summary + planText + ordonnance;
}
</script>
  </div>

  <script>
    function acceptDisclaimer() {
      const checkbox = document.getElementById('acceptConditions');
      if (checkbox.checked) {
        // On peut enregistrer l'acceptation dans un cookie pour ne pas réafficher à chaque visite
        document.cookie = "acceptedDisclaimer=true; path=/; max-age=" + 60*60*24*30; // 30 jours
        document.getElementById('splash').style.display = 'none';
        document.getElementById('mainContent').style.display = 'block';
      } else {
        alert("Veuillez cocher la case pour accepter les conditions d'utilisation.");
      }
    }

    // Vérifier au chargement si l'utilisateur a déjà accepté
    window.onload = function() {
      if (document.cookie.indexOf("acceptedDisclaimer=true") !== -1) {
        document.getElementById('splash').style.display = 'none';
        document.getElementById('mainContent').style.display = 'block';
      }
    }
  </script>
  
  <!-- Module: Gestion de la colite microscopique -->
<div id="moduleColiteMicroscopique" class="module">
  <h3>Gestion de la colite microscopique</h3>
  <form id="formColiteMicroscopique">
    <!-- Informations du patient -->
    <section class="form-section">
      <h3>Informations du patient</h3>
      <label for="cm_age">Âge :</label>
      <input type="number" id="cm_age" placeholder="Entrez l'âge" min="0" required>
      
      <label for="cm_sexe">Sexe :</label>
      <select id="cm_sexe" required>
        <option value="">--Sélectionner--</option>
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
      </select>
    </section>
    
    <!-- Symptômes et activité -->
    <section class="form-section">
      <h3>Symptomatologie et activité</h3>
      <label for="cm_frequency">Nombre de selles liquides (par jour) :</label>
      <input type="number" id="cm_frequency" placeholder="Ex. 6" min="0">
      <br>
      <label for="cm_urgency">Présence d'urgence diarrhéique :</label>
      <select id="cm_urgency">
        <option value="">--Sélectionner--</option>
        <option value="none">Aucune</option>
        <option value="mild">Légère</option>
        <option value="moderate">Modérée</option>
        <option value="severe">Sévère</option>
      </select>
      <br>
      <label for="cm_pain">Douleur abdominale :</label>
      <input type="text" id="cm_pain" placeholder="Décrivez la douleur">
    </section>
    
    <!-- Examens et traitements déjà réalisés -->
    <section class="form-section">
      <h3>Examens et traitements</h3>
      <label for="cm_histology">Résultats histologiques :</label><br>
      <textarea id="cm_histology" rows="2" placeholder="Résultats histologiques, sous-type (ex. collagène ou lymphocytaire)"></textarea>
      <br>
      <label for="cm_treatment">Traitements déjà effectués :</label><br>
      <textarea id="cm_treatment" rows="2" placeholder="Ex. budésonide, modifications alimentaires, loperamide"></textarea>
    </section>
    
    <button type="button" onclick="generateMicroscopicColitisPlan()">Générer la conduite à tenir</button>
  </form>
  
  <div id="resultColiteMicroscopique" class="result"></div>
</div>

<script>
function generateMicroscopicColitisPlan() {
  const age = document.getElementById("cm_age").value;
  const sexe = document.getElementById("cm_sexe").value;
  const frequency = document.getElementById("cm_frequency").value || "Non renseigné";
  const urgency = document.getElementById("cm_urgency").value || "Non renseigné";
  const pain = document.getElementById("cm_pain").value.trim() || "Non renseigné";
  const histology = document.getElementById("cm_histology").value.trim() || "Non renseigné";
  const treatment = document.getElementById("cm_treatment").value.trim() || "Non renseigné";
  
  let summary = "<strong>Résumé de la colite microscopique</strong><br>";
  summary += "Patient de " + age + " ans, " + sexe + ".<br>";
  summary += "Nombre de selles liquides : " + frequency + " par jour<br>";
  summary += "Urgence diarrhéique : " + urgency + "<br>";
  summary += "Douleur abdominale : " + pain + "<br>";
  summary += "Résultats histologiques : " + histology + "<br>";
  summary += "Traitements déjà effectués : " + treatment + "<br><br>";
  
  let planText = "<strong>Proposition de prise en charge :</strong><br>";
  // Algorithme simple basé sur la fréquence et l'urgence des symptômes
  if(parseInt(frequency) >= 4 || urgency === "moderate" || urgency === "severe") {
    planText += "• Prescription de budésonide (ex. 9 mg/jour pendant 8 semaines, avec réduction progressive) pour prise en charge active.<br>";
    planText += "• Évaluation des facteurs déclenchants (ex. usage AINS, les IPP, et la fluoxétine).<br>";
  } else {
    planText += "• Gestion conservatrice avec modifications alimentaires et, si nécessaire, loperamide.<br>";
  }
  
  let ordonnance = "<strong>Ordonnance type et conseils :</strong><br>";
  ordonnance += "• Budésonide pour les cas modérés à sévères.<br>";
  ordonnance += "• Conseils : éviter les médicaments déclencheurs, adopter une alimentation équilibrée, et assurer un suivi régulier.<br>";
  
  document.getElementById("resultColiteMicroscopique").innerHTML = summary + planText + ordonnance;
}
</script>


<!-- Module: Gestion de la pullulation microbienne intestinale (SIBO) -->
<div id="moduleSIBO" class="module">
  <h3>Gestion de la pullulation microbienne intestinale (SIBO)</h3>
  <form id="formSIBO">
    <!-- Informations du patient -->
    <section class="form-section">
      <h3>Informations du patient</h3>
      <label for="sibo_age">Âge :</label>
      <input type="number" id="sibo_age" placeholder="Entrez l'âge" min="0" required>
      
      <label for="sibo_sexe">Sexe :</label>
      <select id="sibo_sexe" required>
        <option value="">--Sélectionner--</option>
        <option value="Homme">Homme</option>
        <option value="Femme">Femme</option>
      </select>
    </section>
    
    <!-- Symptômes et activité de la maladie -->
    <section class="form-section">
      <h3>Symptomatologie et activité</h3>
      <label for="sibo_bloating">Ballonnements :</label>
      <select id="sibo_bloating">
        <option value="">--Sélectionner--</option>
        <option value="Léger">Ballonnements léger</option>
        <option value="Modéré">Ballonnements modéré</option>
        <option value="Sévère">Ballonnements sévère</option>
      </select><br>
      <label for="sibo_frequency">Fréquence des selles (par jour) :</label>
      <input type="number" id="sibo_frequency" placeholder="Ex. 3" min="0"><br>
      <label for="sibo_pain">Douleur abdominale :</label>
      <input type="text" id="sibo_pain" placeholder="Décrivez la douleur">
    </section>
    
    <!-- Examens et traitements déjà réalisés -->
    <section class="form-section">
      <h3>Examens et traitements</h3>
      <label for="sibo_test">Résultats du test respiratoire à l'hydrogène :</label><br>
      <select id="sibo_test">
        <option value="">--Sélectionner--</option>
        <option value="Négatif">Négatif</option>
        <option value="Positif">Positif</option>
      </select><br>
      <label for="sibo_treatment">Traitements déjà effectués :</label><br>
      <select id="sibo_treatment">
        <option value="">--Sélectionner--</option>
        <option value="Antibiotiques">Antibiotiques</option>
        <option value="Prokinétiques">Prokinétiques</option>
      </select>
    </section>
    
    <button type="button" onclick="generateSIBOPlan()">Générer la conduite à tenir</button>
  </form>
  
  <div id="resultSIBO" class="result"></div>
</div>

<script>
function generateSIBOPlan() {
  const age = document.getElementById("sibo_age").value;
  const sexe = document.getElementById("sibo_sexe").value;
  const bloating = document.getElementById("sibo_bloating").value || "Non renseigné";
  const frequency = document.getElementById("sibo_frequency").value || "Non renseigné";
  const pain = document.getElementById("sibo_pain").value.trim() || "Non renseigné";
  const testResult = document.getElementById("sibo_test").value || "Non renseigné";
  const treatment = document.getElementById("sibo_treatment").value || "Non renseigné";
  
  let summary = "<strong>Résumé de la pullulation microbienne intestinale (SIBO)</strong><br>";
  summary += "Patient de " + age + " ans, " + sexe + ".<br>";
  summary += "Ballonnements : " + bloating + "<br>";
  summary += "Fréquence des selles : " + frequency + " par jour<br>";
  summary += "Douleur abdominale : " + pain + "<br>";
  summary += "Résultats du test respiratoire : " + testResult + "<br>";
  summary += "Traitements déjà effectués : " + treatment + "<br><br>";
  
  let planText = "<strong>Proposition de prise en charge :</strong><br>";
  // Algorithme simplifié basé sur les résultats du test respiratoire
  if(testResult.toLowerCase().includes("positif")) {
    planText += "• Indication d'une antibiothérapie ciblée (ex. Rifaximine 550 mg TID pendant 10-14 jours).<br>";
  } else {
    planText += "• Surveillance clinique et conseils diététiques (régime pauvre en FODMAP, etc.).<br>";
  }
  
  let ordonnance = "<strong>Ordonnance type et conseils :</strong><br>";
  ordonnance += "• En cas de test positif, antibiothérapie avec Rifaximine (ex. 550 mg TID) est recommandée.<br>";
  ordonnance += "• Conseils : adapter l'alimentation, favoriser un régime pauvre en FODMAP, et planifier une réévaluation clinique.<br>";
  
  document.getElementById("resultSIBO").innerHTML = summary + planText + ordonnance;
}
</script>

  
<!-- Module: Stratégies de Drainage pour Sténoses Biliaires Proximales Non Opérables -->
<div id="moduleDrainageBiliaire" class="module">
  <h2>Stratégies de Drainage pour Sténoses Biliaires Proximales Non Opérables</h2>
  <form id="formDrainage">
    <!-- Section Évaluation Tumorale et Hépatique -->
    <section class="form-section">
      <h2>Caractéristiques de la Sténose</h2>
      <div class="input-group">
        <label for="bismuth_class">Classification Bismuth‑Corlette :</label>
        <select id="bismuth_class" required>
          <option value="">--Sélectionner--</option>
          <option value="I">Type I : Tumeur en dessous de la confluence des canaux hépatiques droit et gauche</option>
          <option value="II">Type II : Tumeur atteignant la confluence biliaire sans extension intra-hépatique</option>
          <option value="IIIa">Type IIIa : Extension dans le canal hépatique droit</option>
          <option value="IIIb">Type IIIb : Extension dans le canal hépatique gauche</option>
          <option value="IV">Type IV : Extension bilatérale ou multifocale</option>
        </select>
      </div>
      
      <div class="input-group">
        <label for="foie_fonctionnel">% de Foie fonctionnel non envahi :</label>
        <input type="number" id="foie_fonctionnel" min="0" max="100" step="5" required>
      </div>
      
      <div class="checkbox-group">
        <label><input type="checkbox" id="metastases_hepatiques"> Métastases hépatiques</label>
        <label><input type="checkbox" id="atrophie_segment"> Atrophie segmentaire</label>
        <label><input type="checkbox" id="thrombose_porte"> Thrombose portale</label>
      </div>
    </section>

    <!-- Section État Général -->
    <section class="form-section">
      <h2>Paramètres Cliniques</h2>
      <div class="input-group">
        <label for="bilirubine">Bilirubine totale (μmol/L) :</label>
        <input type="number" id="bilirubine" min="0" required>
      </div>
      
      <div class="input-group">
        <label for="ecog">ECOG PS :</label>
        <select id="ecog" required>
          <option value="">--Sélectionner--</option>
          <option value="0">0</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3">3</option>
        </select>
      </div>
      
      <div class="input-group">
        <label for="child_pugh">Child‑Pugh :</label>
        <select id="child_pugh" required>
          <option value="">--Sélectionner--</option>
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
        </select>
      </div>
    </section>

    <button type="button" onclick="calculateDrainage()">Générer la Stratégie</button>
  </form>

  <div id="resultDrainage" class="recommendation-box"></div>

  <script>
    function calculateDrainage() {
      // Récupération des valeurs du formulaire
      const bismuth = document.getElementById('bismuth_class').value;
      const foieFonct = parseFloat(document.getElementById('foie_fonctionnel').value) || 0;
      const bilirubin = parseFloat(document.getElementById('bilirubine').value) || 0;
      const ecog = parseInt(document.getElementById('ecog').value) || 0;
      const childPugh = document.getElementById('child_pugh').value;
      const metastases = document.getElementById('metastases_hepatiques').checked;

      let recommendation = "<h3>Stratégie de Drainage</h3>";

      // Objectif principal tiré du texte : Drainer plus de 80 % du foie fonctionnel pour optimiser la survie
      if (ecog <= 2 && childPugh !== 'C' && foieFonct >= 50) {
        if (foieFonct >= 80) {
          recommendation += '<p class="alert-success">Objectif : Drainage ≥80 % du foie fonctionnel.<br>Cette stratégie permet une meilleure survie et facilite l’accès aux traitements oncologiques (seuil optimal de 80 %, voire jusqu’à 100 % selon certaines études).</p>';
          var techniques = [
            "Drainage percutané-endoscopique (technique de rendez‑vous)",
            "Hépatico‑gastrostomie guidée par échoendoscopie (EEH)",
            "Utilisation de prothèses métalliques auto‑expansives"
          ];
        } else {
          recommendation += `<p class="alert-warning">Objectif : Drainage minimal acceptable de 50 % du foie fonctionnel (actuellement ${foieFonct} %).<br>Cette approche, bien que moins optimale, peut être envisagée en l'absence de possibilité de drainage complet.</p>`;
          var techniques = [
            "Drainage endoscopique unilatéral avec prothèse plastique",
            "Drainage percutané en complément"
          ];
        }
        // Adaptation selon la classification Bismuth
        if (bismuth === 'IIIb' || bismuth === 'IV') {
          techniques.unshift("Approche percutanée initiale (pour surmonter les difficultés techniques)");
          techniques.push("Drainage endoscopique avec anastomose bilio‑digestive (EEH)");
        }
      } else {
        recommendation += '<p class="alert-danger">Prise en charge palliative symptomatique recommandée.<br>Conditions défavorables : ECOG >2, Child‑Pugh C ou foie fonctionnel <50 %.</p>';
        var techniques = [
          "Drainage minimal en cas de prurit réfractaire",
          "Traitement médical (colestyramine, rifampicine)",
          "Soins de support multidisciplinaires"
        ];
      }

      // Génération du bloc de techniques recommandées
      recommendation += '<h4>Techniques à privilégier :</h4><ul>';
      techniques.forEach(tech => recommendation += `<li>${tech}</li>`);
      recommendation += '</ul>';

      // Surveillance et suivi
      recommendation += '<div class="alert"><h4>Risques et Surveillance :</h4><ul>';
      recommendation += "<li>Morbidité attendue d'environ 40 % et mortalité d'environ 10 %</li>";
      recommendation += "<li>Surveillance par imagerie hépatique (IRM) à J7 puis mensuelle</li>";
      recommendation += "<li>Contrôle biologique régulier (bilirubine et CRP, deux fois par semaine)</li>";
      recommendation += '</ul></div>';

      // Options oncologiques complémentaires si bilirubine <50 μmol/L et absence de métastases
      if (bilirubin < 50 && !metastases) {
        recommendation += '<div class="therapy-options"><h4>Options Oncologiques Possibles :</h4>';
        recommendation += '<ul>';
        recommendation += '<li>Immunothérapie (ex. Durvalumab associée à Gemcitabine)</li>';
        recommendation += '<li>Chimiothérapie (ex. FOLFIRINOX)</li>';
        recommendation += '<li>Participation à des essais cliniques ciblant FGFR2</li>';
        recommendation += '</ul></div>';
      }

      document.getElementById('resultDrainage').innerHTML = recommendation;
    }
  </script>

  <style>
    .alert-success { color: #155724; background-color: #d4edda; padding: 10px; margin-bottom: 10px; }
    .alert-warning { color: #856404; background-color: #fff3cd; padding: 10px; margin-bottom: 10px; }
    .alert-danger { color: #721c24; background-color: #f8d7da; padding: 10px; margin-bottom: 10px; }
    .therapy-options { border-left: 4px solid #004085; padding-left: 1rem; margin-top: 10px; }
    .form-section { border: 1px solid #ddd; padding: 15px; margin: 10px 0; }
    .input-group { margin-bottom: 10px; }
    .checkbox-group label { display: block; }
    .recommendation-box { background: #f8f9fa; padding: 20px; margin-top: 20px; }
  </style>
</div>


 <!-- Conduite à tenir devant une gastrite à Helicobacter pylori< -->
<div id="moduleHPylori" class="module">
  <h3>Tratement de l'infection à Helicobacter pylori</h3>
  <form id="formHPylori">
    
    <!-- Section Diagnostic -->
    <section class="form-section">
      <h2>Critères Diagnostiques</h2>
      <div class="input-group">
        <label>Méthode diagnostique :</label>
        <select id="methode_diagnostic" required>
          <option value="">--Sélectionner--</option>
          <option value="test_rapide">Test rapide sur biopsie (uréase)</option>
          <option value="anatomopatho">Examen anatomopathologique</option>
          <option value="selles">Antigène fécal</option>
          <option value="respi">Test respiratoire à l'urée marquée</option>
        </select>
      </div>
      
      <div class="checkbox-group">
        <h3>Contexte clinique :</h3>
        <label><input type="checkbox" id="ulcere"> ULCÈRE gastroduodénal</label>
        <label><input type="checkbox" id="dyspepsie"> DYSPEPSIE</label>
        <label><input type="checkbox" id="antecedent"> Antécédent familial de cancer gastrique</label>
      </div>
    </section>

    <!-- Section Traitement -->
    <section class="form-section">
      <h2>Paramètres Thérapeutiques</h2>
      <div class="input-group">
        <label>Résistance connue :</label>
        <div class="radio-group">
          <label><input type="radio" name="resistance" value="clarithro"> Clarithromycine</label>
          <label><input type="radio" name="resistance" value="metronidazole"> Métronidazole</label>
          <label><input type="radio" name="resistance" value="none"> Aucune</label>
        </div>
      </div>
      
      <div class="input-group">
        <label>Contre-indications :</label>
        <div class="checkbox-group">
          <label><input type="checkbox" id="allergie_penicillin"> Allergie bêta-lactamines</label>
          <label><input type="checkbox" id="insuffisance_renale"> Clairance <30 ml/min</label>
        </div>
      </div>
      
      <div class="input-group">
        <label>Échec(s) thérapeutique(s) :</label>
        <input type="number" id="echecs" min="0" max="3" value="0">
      </div>
    </section>

    <!-- Section Surveillance -->
    <section class="form-section">
      <h2>Surveillance Post-Éradication</h2>
      <div class="input-group">
        <label>Stade OLGA/OLGIM :</label>
        <select id="olga_stage" required>
          <option value="">--Sélectionner--</option>
          <option value="0">0-I</option>
          <option value="II">II</option>
          <option value="III">III</option>
          <option value="IV">IV</option>
        </select>
      </div>
      
      <div class="checkbox-group">
        <label><input type="checkbox" id="dysplasie"> Dysplasie détectée</label>
        <label><input type="checkbox" id="antecedent_fam"> Antécédent familial 1er degré</label>
      </div>
    </section>

    <button type="button" onclick="generateRecommendation()">Générer la stratégie</button>
  </form>

  <div id="resultHPylori" class="recommendation-box"></div>

<script>
  function generateRecommendation() {
    // Récupération des valeurs
    const methode = document.getElementById('methode_diagnostic').value;
    const resistance = document.querySelector('input[name="resistance"]:checked')?.value;
    const echecs = parseInt(document.getElementById('echecs').value);
    const insuffRenale = document.getElementById('insuffisance_renale').checked;
    const allergiePenicillin = document.getElementById('allergie_penicillin').checked;
    const olgaStage = document.getElementById('olga_stage').value;
    const hasDysplasie = document.getElementById('dysplasie').checked;

    let recommendation = '<h3>Stratégie thérapeutique 2024</h3>';
    
    // Arbre décisionnel thérapeutique
    recommendation += '<div class="treatment-plan">';
    
    if(echecs === 0) {
      recommendation += '<div class="first-line">';
      recommendation += '<h4>Première intention :</h4>';
      
      if(!insuffRenale) {
        recommendation += '<strong>Quadrithérapie bismuthée (Pylera®) 10 jours</strong><br>';
        recommendation += '➤ 3 gélules/jour (4 prises quotidiennes)<br>';
        recommendation += '• Alternative idéale en cas d\'allergie aux bêta-lactamines<br>';
      } else {
        recommendation += '<div class="alert-warning">Contre-indication Pylera® :<br>Alternative nécessaire (clairance <30 ml/min)</div>';
      }
      
      recommendation += '<div class="alternative">';
      recommendation += '<h5>Alternative si Pylera® indisponible ou contre indication:</h5>';
      
      // Nouvelle condition : en cas d'allergie et de résistance à la clarithromycine
      if (resistance === 'clarithro' && allergiePenicillin) {
        recommendation += 'Traitement orienté par l’évaluation de la sensibilité aux antibiotiques.';
      } else if (resistance === 'clarithro') {
        recommendation += 'Quadrithérapie alternative 14 jours (sans clarithromycine) :<br>';
        recommendation += '➤ Pantoprazole 40mg x2/j + ';
        recommendation += 'Amoxicilline 1g x3/j + ';
        recommendation += 'Métronidazole 500mg x2/j + ';
        recommendation += 'Tétracycline 500mg x4/j';
      } else if(allergiePenicillin) {
        recommendation += 'Quadrithérapie adaptée 14 jours :<br>';
        recommendation += '➤ Pantoprazole 40mg x2/j + ';
        recommendation += 'Lévofloxacine 500mg x1/j + ';
        recommendation += 'Clarithromycine 500mg x2/j + ';
        recommendation += 'Métronidazole 500mg x2/j';
      } else {
        recommendation += 'Quadrithérapie concomitante 14 jours :<br>';
        recommendation += '➤ Pantoprazole 40mg x2/j + ';
        recommendation += 'Amoxicilline 1g x3/j + ';
        recommendation += 'Clarithromycine 500mg x2/j + ';
        recommendation += 'Métronidazole 500mg x2/j';
      }
      
      recommendation += '</div></div>';
    } else {
      recommendation += '<div class="rescue-therapy">';
      recommendation += '<h4>Traitement de rattrapage :</h4>';
      recommendation += '➤ Quadrithérapie haute dose avec Rifabutine 300mg/j<br>';
      recommendation += '➤ Avis obligatoire RCP GEFH<br>';
      recommendation += '➤ Options expérimentales :<br>';
      recommendation += '- Dual therapy rabéprazole/amoxicilline haute dose<br>';
      recommendation += '- Nouveaux inhibiteurs de la pompe à protons (TAK-438)';
      recommendation += '</div>';
    }

    // Surveillance
    recommendation += '<div class="follow-up">';
    recommendation += '<h4>Surveillance :</h4>';
    recommendation += '<ul>';
    if(olgaStage === 'III' || olgaStage === 'IV') {
      recommendation += '<li>Endoscopie haute définition avec chromoendoscopie annuelle</li>';
      recommendation += `<li>Biopsies cartographiques (protocol Seattle modifié) : ${hasDysplasie ? '12 biopsies' : '8 biopsies'}</li>`;
    } else {
      recommendation += '<li>Contrôle par test respiratoire 8 semaines post-traitement</li>';
    }
    recommendation += '</ul></div>';

    document.getElementById('resultHPylori').innerHTML = recommendation;
  }
</script>

  <style>
    .module {
      font-family: 'Segoe UI', sans-serif;
      max-width: 900px;
      margin: 2rem auto;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
    }
    .form-section {
      background: white;
      padding: 1.5rem;
      margin: 1rem 0;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .input-group {
      margin: 1rem 0;
    }
    .first-line {
      background: #e8f5e9;
      padding: 1.5rem;
      border-radius: 8px;
      border-left: 4px solid #2e7d32;
      margin: 1rem 0;
    }
    .alternative {
      background: #fff3cd;
      padding: 1rem;
      margin: 1rem 0;
      border-radius: 6px;
    }
    .rescue-therapy {
      background: #f8d7da;
      padding: 1.5rem;
      border-radius: 8px;
      border-left: 4px solid #dc3545;
    }
    .follow-up {
      margin-top: 2rem;
      padding: 1.5rem;
      background: #e3f2fd;
      border-radius: 8px;
    }
    button {
      background: #2e7d32;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s;
    }
    button:hover {
      background: #1b5e20;
    }
    .recommendation-box {
      background: white;
      padding: 2rem;
      margin-top: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    .alert-warning {
      color: #856404;
      background-color: #fff3cd;
      padding: 1rem;
      border-radius: 6px;
      margin: 1rem 0;
    }
  </style>
</div>
<!-- Module: Lettre de Transmission des Résultats Histologiques -->
<div id="letterModule" class="module">
  <h3>Lettre pour médecin traitant - Résultats histologiques</h3>

  <!-- Informations patient -->
  <div class="section">
    <label>Nom du Gastro : <input type="text" id="GastroName"></label>
	<label>Nom du médecin traitant : <input type="text" id="medecinTName"></label>
	<label>Nom Prenom age du patient : <input type="text" id="patientName"></label>
    <label>Date de la coloscopie : <input type="date" id="procedureDate"></label>
  </div>

  <!-- Résultats histologiques -->
  <div class="section">
    <h2>Résultats histologiques</h2>
    <textarea id="histoResults" rows="4" placeholder="Description des polypes..."></textarea>
  </div>

  <!-- Paramètres de recommandation -->
  <div class="section">
    <h2>Critères de surveillance</h2>
    
    <div class="subsection">
      <label>Qualité de la coloscopie :
        <select id="letterQualite">
          <option value="adequate">Boston >7</option>
          <option value="inadequate">Boston <7</option>
        </select>
      </label>
    </div>

    <div class="subsection">
      <h3>Facteurs de risque élevé</h3>
      <div class="high-risk-factors">
        <label><input type="checkbox" class="high-risk"> ≥5 adénomes</label>
        <label><input type="checkbox" class="high-risk"> Adénome ≥10 mm</label>
        <label><input type="checkbox" class="high-risk"> Dysplasie haut grade</label>
        <label><input type="checkbox" class="high-risk"> Polype festonné ≥10 mm</label>
      </div>
    </div>

    <div class="subsection">
      <h3>Facteurs de risque faible</h3>
      <div class="low-risk-factors">
        <label><input type="checkbox" class="low-risk"> <5 adénomes <10 mm</label>
        <label><input type="checkbox" class="low-risk"> Polype festonné <10 mm</label>
      </div>
    </div>

    <div class="subsection">
      <h3>Cas particuliers</h3>
      <div class="special-cases">
        <label><input type="checkbox" id="letterFragmente"> Exérèse fragmentée (≥20 mm)</label>
        <label><input type="checkbox" id="letterCancer"> Antécédent de CCR traité</label>
        <label><input type="checkbox" id="letterAge"> Patient âgé</label>
        <label><input type="checkbox" id="letterFamille"> Antécédents familiaux</label>
      </div>
    </div>
  </div>

  <!-- Bouton de génération -->
  <button onclick="generateLetter()">Générer la lettre</button>

  <!-- Lettre générée -->
  <div id="generatedLetter" class="letter-output"></div>
</div>

<script>
function generateLetter() {
  // Récupération des données
  const Gastro = document.getElementById('GastroName').value;
  const patient = document.getElementById('patientName').value;
  const médecinT = document.getElementById('medecinTName').value;
  const procedureDate = document.getElementById('procedureDate').value;
  const histoResults = document.getElementById('histoResults').value;
  
  // Calcul des recommandations
  let interval = "";
  let notes = [];

  if(document.getElementById('letterQualite').value === 'inadequate') {
    interval = "six mois";
    notes.push("Coloscopie initiale inadéquate - coloscopie a refaire dés que possible");
  } else if(document.getElementById('letterFragmente').checked) {
    interval = "3-6 mois";
    notes.push("Surveillance rapprochée pour exérèse fragmentée");
  } else if(document.getElementById('letterCancer').checked) {
    interval = "1 an";
    notes.push("Surveillance post-cancer : puis à 3 ans et 5 ans");
  } else {
    const highRisk = document.querySelectorAll('.high-risk:checked').length > 0;
    const lowRisk = document.querySelectorAll('.low-risk:checked').length > 0;

    if(highRisk) {
      interval = "3 ans";
      notes.push("Surveillance rapprochée (puis 5 ans si contrôle normal)");
    } else if(lowRisk) {
      interval = "5 ans";
      notes.push("Possibilité d'espacer ultérieurement (7-10 ans) ou utiliser un test FIT bisannuel");
    }
  }

  if(document.getElementById('letterAge').checked) {
    notes.push("Arrêt possible de la surveillance selon espérance de vie");
  }
  if(document.getElementById('letterFamille').checked) {
    notes.push("Antécédents familiaux à prendre en compte");
  }

  // Construction de la lettre
  const letterContent = `
    <div class="letter">
      <p>À l'attention du Dr ${médecinT}</p>
      <p>Cher Confrère,</p>
      <p>Nous venons de recevoir les résultats des prélèvements histologique réalisés chez votre patient: ${patient}<br>
      Date de la coloscopie : ${new Date(procedureDate).toLocaleDateString()}</p>
      
      <p>Résultats histologiques : ${histoResults.replace(/\n/g, '<br>')}</p>
	  
      <p>Dans ce contexte, il convient de lui proposer une coloscopie de surveillance dans: <strong>${interval || "Aucune surveillance spécifique nécessaire"}</strong></p>
      <p>Notes : ${notes.join(' • ')}</p>
      
      <p>Cordialement,<br>
      Dr ${Gastro}<br>
      </p>
    </div>
  `;

  document.getElementById('generatedLetter').innerHTML = letterContent;
}
</script>

<style>
.module { font-family: Arial, sans-serif; max-width: 800px; margin: 20px auto; }
.section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
.subsection { margin: 15px 0; }
.high-risk-factors, .low-risk-factors { column-count: 2; margin: 10px 0; }
.high-risk-factors { border: 2px solid #ffcccc; padding: 10px; }
.low-risk-factors { border: 2px solid #ccffcc; padding: 10px; }
.letter-output { margin-top: 20px; padding: 20px; background: #f8f8f8; border-radius: 5px; }
.letter { line-height: 1.6; }
button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
button:hover { background: #0056b3; }
</style>
</div>

<!-- Module: Prise en charge de l'Hépatite alcoolique aiguë -->
<!-- Module: Prise en charge de l'Hépatite alcoolique aiguë -->
<div id="moduleAlcoolique" class="module">
  <h3>Prise en charge de l'Hépatite alcoolique aiguë</h3>
  <form id="formAlcoolique">
    
    <!-- Section 1 : Informations du patient -->
    <section class="form-section">
      <h3>Informations du patient</h3>
      <label for="aa_age">Âge :</label>
      <input type="number" id="aa_age" placeholder="Entrez l'âge" min="0" required>
      
      <label for="aa_sexe">Sexe :</label>
      <select id="aa_sexe" required>
         <option value="">--Sélectionner--</option>
         <option value="Homme">Homme</option>
         <option value="Femme">Femme</option>
      </select>
      
      <label for="aa_alcool">Consommation d'alcool (en g/j) :</label>
      <input type="number" id="aa_alcool" placeholder="Ex. 80" required>
    </section>
    
    <!-- Section 2 : Paramètres biologiques -->
    <section class="form-section">
      <h3>Paramètres biologiques</h3>
      <label for="aa_bilirubine">Bilirubine totale (mg/dL) :</label>
      <input type="number" id="aa_bilirubine" step="0.1" placeholder="Ex. 10" required>
      
      <label for="aa_pt_patient">Temps de prothrombine du patient (sec) :</label>
      <input type="number" id="aa_pt_patient" step="0.1" placeholder="Ex. 18" required>
      
      <label for="aa_pt_control">Temps de prothrombine normal (sec) :</label>
      <input type="number" id="aa_pt_control" step="0.1" placeholder="Ex. 12" required>
      
      <label for="aa_albumine">Albumine (g/dL) :</label>
      <input type="number" id="aa_albumine" step="0.1" placeholder="Ex. 2.5" required>
      
      <label for="aa_ast">AST (U/L) :</label>
      <input type="number" id="aa_ast" placeholder="Ex. 150" required>
      
      <label for="aa_alt">ALT (U/L) :</label>
      <input type="number" id="aa_alt" placeholder="Ex. 80" required>
    </section>
    
    <!-- Section 3 : Évaluation clinique -->
    <section class="form-section">
      <h3>Évaluation clinique</h3>
      <label>
        <input type="checkbox" id="aa_encéphalopathie">
        Présence d'encéphalopathie
      </label>
      <label>
        <input type="checkbox" id="aa_fievre">
        Fièvre (>38°C)
      </label>
      <label>
        <input type="checkbox" id="aa_saignement">
        Saignements (digestifs ou cutanés)
      </label>
    </section>
    
    <!-- Section 4 : Commentaires globaux -->
    <section class="form-section">
      <h3>Commentaires globaux</h3>
      <textarea id="aa_comments" rows="3" placeholder="Entrez vos remarques supplémentaires..."></textarea>
    </section>
    
    <button type="button" onclick="generateAlcooliquePlan()">Générer la conduite à tenir</button>
  </form>
  
  <div id="resultAlcoolique" class="result"></div>
</div>

<script>
function generateAlcooliquePlan() {
  // Récupération des informations du patient
  const age = document.getElementById('aa_age').value;
  const sexe = document.getElementById('aa_sexe').value;
  const alcool = document.getElementById('aa_alcool').value;

  // Récupération des paramètres biologiques
  const bilirubine = parseFloat(document.getElementById('aa_bilirubine').value) || 0;
  const ptPatient = parseFloat(document.getElementById('aa_pt_patient').value) || 0;
  const ptControl = parseFloat(document.getElementById('aa_pt_control').value) || 0;
  const albumine = parseFloat(document.getElementById('aa_albumine').value) || 0;
  const ast = parseFloat(document.getElementById('aa_ast').value) || 0;
  const alt = parseFloat(document.getElementById('aa_alt').value) || 0;

  // Récupération des critères cliniques
  const enceph = document.getElementById('aa_encéphalopathie').checked;
  const fievre = document.getElementById('aa_fievre').checked;
  const saignement = document.getElementById('aa_saignement').checked;

  // Calcul du score de Maddrey discriminant function (DF)
  // DF = 4.6 * (PT_patient - PT_control) + bilirubine (mg/dL)
  const df = 4.6 * (ptPatient - ptControl) + bilirubine;
  
  // Construction du résumé
  let summary = `<h4>Résumé de l'Hépatite Alcoolique Aiguë</h4>`;
  summary += `<p>Patient : ${age} ans, ${sexe}, consommation d'alcool : ${alcool} g/j</p>`;
  summary += `<p>Paramètres biologiques : Bilirubine = ${bilirubine} mg/dL, PT du patient = ${ptPatient} sec, PT de référence = ${ptControl} sec, Albumine = ${albumine} g/dL, AST = ${ast} U/L, ALT = ${alt} U/L</p>`;
  summary += `<p>Score de Maddrey (DF) = ${df.toFixed(1)}</p>`;
  summary += `<p>Critères cliniques : ${enceph ? "Encéphalopathie présente, " : ""}${fievre ? "Fièvre, " : ""}${saignement ? "Saignements, " : ""}</p>`;
  
  // Proposition de prise en charge
  let planText = `<h4>Proposition de prise en charge :</h4>`;
  
  if (df >= 32) {
    planText += `<p><strong>Hépatite sévère détectée (DF ≥ 32)</strong></p>`;
    planText += `<ul>
                    <li>Prise en charge hospitalière obligatoire.</li>
                    <li>Administration de corticoïdes IV (ex. Methylprednisolone 1 mg/kg/j ou Hydrocortisone 400 mg/j) pendant 28 jours.</li>
                    <li>Contrôle biologique quotidien (bilirubine, PT, CRP) et suivi clinique rapproché.</li>
                    <li>Relais en voie orale dès amélioration constatée (évaluation à J3-J7).</li>
                    <li>Mesures de support : correction hydroélectrolytique, nutrition adaptée et thromboprophylaxie.</li>
                 </ul>`;
    if (enceph || fievre || saignement) {
      planText += `<p class="warning"><strong>Attention :</strong> Signes de défaillance multi-organique détectés. Surveillance en unité de soins intensifs recommandée.</p>`;
    }
  } else {
    planText += `<p><strong>Hépatite modérée (DF < 32)</strong> – prise en charge ambulatoire possible si le patient est stable.</p>`;
    planText += `<ul>
                    <li>Traitement par corticoïdes par voie orale (ex. Prednisone 40 mg/j).</li>
                    <li>Suivi rapproché en consultation (toutes les 48-72 heures).</li>
                    <li>Conseils stricts de sevrage alcoolique et prise en charge nutritionnelle.</li>
                 </ul>`;
  }
  
  // Examens complémentaires à réaliser
  let examText = `<h4>Examens complémentaires à réaliser :</h4>
                  <ul>
                    <li>Bilan hépatique complet (ALT, AST, bilirubine, albumine, PT).</li>
                    <li>Bilan infectieux (hémocultures, ECBU, PCR virale si suspicion d'infection).</li>
                    <li>Imagerie hépatique (échographie ou scanner) en cas de doute sur l'évolution.</li>
                  </ul>`;
  
  // Ordonnance type et conseils
  let ordonnance = `<h4>Ordonnance type et Conseils :</h4>
                    <ul>
                      <li>Corticoïdes : ${df >= 32 ? "Administration IV avec relais per os après amélioration" : "Traitement par voie orale (Prednisone)"}.</li>
                      <li>Mise en place d'une prise en charge nutritionnelle et de support pour le sevrage alcoolique.</li>
                      <li>Mesures de support : hydratation, correction électrolytique, prophylaxie thromboprophylactique.</li>
                    </ul>`;
  
  // Assemblage final du rapport
  const finalReport = summary + planText + examText + ordonnance +
                      `<br><strong>Commentaires Globaux :</strong><br>${document.getElementById('aa_comments').value.trim() || "Aucun commentaire supplémentaire."}`;
  
  document.getElementById('resultAlcoolique').innerHTML = finalReport;
}
</script>

<style>
  /* Styles pour le module */
  #moduleAlcoolique {
    font-family: Arial, sans-serif;
    max-width: 800px;
    margin: 20px auto;
    padding: 20px;
    background: #fdfdfd;
    border: 1px solid #ddd;
    border-radius: 8px;
  }
  .form-section {
    margin-bottom: 20px;
    padding: 15px;
    background: #fff;
    border: 1px solid #eee;
    border-radius: 5px;
  }
  label {
    display: block;
    margin-bottom: 8px;
  }
  input[type="number"],
  select,
  textarea {
    width: 100%;
    padding: 8px;
    margin-bottom: 10px;
    border: 1px solid #ccc;
    border-radius: 3px;
    box-sizing: border-box;
  }
  button {
    padding: 10px 20px;
    background-color: #00539C;
    color: #fff;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }
  button:hover {
    background-color: #003f7f;
  }
  .result {
    margin-top: 20px;
    padding: 15px;
    background: #eef;
    border-radius: 5px;
  }
  .warning {
    color: #721c24;
    background-color: #f8d7da;
    padding: 10px;
    border-radius: 3px;
  }
</style>

<footer>
      <p style="font-size: 0.9em; text-align: center;">développé par Dr KADA Abdelkrim. Ce document est fourni à titre informatif. 2025 contact@kadawebhge.fr</p>
    <p style="font-size: 0.9em; text-align: center;"> </p>

   
</footer>
</body>
</html>
